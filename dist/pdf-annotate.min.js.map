{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///../pamoja-platform/build/js/pdf-annotate.min.js","webpack:///webpack/bootstrap d7f69c445fdecb5e2645","webpack:///./index.js","webpack:///./src/PDFJSAnnotate.js","webpack:///./src/adapter/StoreAdapter.js","webpack:///./src/utils/abstractFunction.js","webpack:///./src/UI/event.js","webpack:///./~/events/events.js","webpack:///./src/UI/utils.js","webpack:///./~/create-stylesheet/index.js","webpack:///./src/adapter/LocalStoreAdapter.js","webpack:///./src/utils/uuid.js","webpack:///./src/render/index.js","webpack:///./src/render/appendChild.js","webpack:///./~/object-assign/index.js","webpack:///./src/render/renderLine.js","webpack:///./src/utils/setAttributes.js","webpack:///./src/utils/normalizeColor.js","webpack:///./src/render/renderPath.js","webpack:///./src/render/renderPoint.js","webpack:///./src/render/renderRect.js","webpack:///./src/render/renderText.js","webpack:///./src/a11y/renderScreenReaderHints.js","webpack:///./src/a11y/insertScreenReaderHint.js","webpack:///./src/a11y/createScreenReaderOnly.js","webpack:///./src/a11y/insertElementWithinChildren.js","webpack:///./src/a11y/insertElementWithinElement.js","webpack:///./src/a11y/renderScreenReaderComments.js","webpack:///./src/a11y/insertScreenReaderComment.js","webpack:///./src/a11y/initEventHandlers.js","webpack:///./src/UI/index.js","webpack:///./src/UI/edit.js","webpack:///./src/UI/pen.js","webpack:///./src/UI/point.js","webpack:///./src/UI/rect.js","webpack:///./src/UI/text.js","webpack:///./src/UI/page.js","webpack:///./shared/initColorPicker.js","webpack:///./shared/pdf_viewer.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_PDFJSAnnotate","_PDFJSAnnotate2","_StoreAdapter","_StoreAdapter2","_LocalStoreAdapter","_LocalStoreAdapter2","_render","_render2","_UI","_UI2","_initColorPicker","_initColorPicker2","initColorPicker","StoreAdapter","LocalStoreAdapter","__storeAdapter","getStoreAdapter","setStoreAdapter","adapter","UI","render","getAnnotations","documentId","pageNumber","_getStoreAdapter","apply","arguments","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","_abstractFunction","_abstractFunction2","_event","_this","definition","undefined","keys","forEach","annotationId","annotation","content","commentId","get","__getAnnotations","set","fn","then","annotations","a","__addAnnotation","fireEvent","__editAnnotation","__deleteAnnotation","success","__addComment","comment","__deleteComment","abstractFunction","name","Error","emitter","emit","addEventListener","on","removeEventListener","removeListener","_events","_events2","_utils","clickNode","document","e","findSVGAtPoint","clientX","clientY","findAnnotationAtPoint","EventEmitter","_maxListeners","isFunction","arg","isNumber","isObject","isUndefined","defaultMaxListeners","setMaxListeners","n","isNaN","type","er","handler","len","args","listeners","error","err","context","Array","slice","addListener","listener","newListener","push","warned","console","trace","once","g","fired","list","position","splice","removeAllListeners","ret","listenerCount","evlistener","findSVGContainer","node","parentNode","nodeName","toUpperCase","getAttribute","x","y","elements","querySelectorAll","l","el","rect","getBoundingClientRect","pointIntersectsRect","svg","getOffsetAnnotationRect","top","bottom","left","right","getAnnotationRect","_getOffset","getOffset","offsetLeft","offsetTop","h","w","LINE_OFFSET","toLowerCase","minX","maxX","minY","maxY","replace","split","s","map","parseInt","height","width","_getOffset2","result","includes","scaleUp","_getMetadata","getMetadata","viewport","scale","scaleDown","_getMetadata2","getScroll","scrollTop","scrollLeft","disableUserSelect","userSelectStyleSheet","head","appendChild","enableUserSelect","removeChild","JSON","parse","BORDER_COLOR","_createStylesheet","_createStylesheet2","body","-webkit-user-select","-moz-user-select","-ms-user-select","user-select","setAttribute","processRuleSet","selector","block","processDeclarationBlock","prop","processDeclaration","join","hyphenate","match","blocks","style","createElement","text","createTextNode","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","localStorage","getItem","updateAnnotations","setItem","stringify","findAnnotation","index","uuid","_uuid","_uuid2","_StoreAdapter3","getPrototypeOf","Promise","resolve","reject","filter","page","getAnnotation","addAnnotation","editAnnotation","deleteAnnotation","getComments","addComment","class","deleteComment","replacement","r","Math","random","v","toString","PATTERN","REGEXP","data","innerHTML","removeAttribute","isArray","_appendChild2","_appendChild","_renderScreenReaderHints","getTranslation","rotation","transform","isFirefox","path","querySelector","_objectAssign2","child","_renderRect2","_renderLine2","_renderPoint2","_renderText2","_renderPath2","_objectAssign","_renderLine","_renderPath","_renderPoint","_renderRect","_renderText","test","navigator","userAgent","toObject","val","shouldUseNative","assign","test1","String","getOwnPropertyNames","test2","fromCharCode","order2","test3","letter","getOwnPropertySymbols","hasOwnProperty","propIsEnumerable","propertyIsEnumerable","source","from","symbols","to","renderLine","group","createElementNS","_setAttributes2","stroke","_normalizeColor2","color","strokeWidth","rectangles","line","x1","y1","x2","y2","_setAttributes","_normalizeColor","setAttributes","attributes","keyCase","UPPER_REGEX","BLACKLIST","indexOf","normalizeColor","REGEX_HASHLESS_HEX","renderPath","d","lines","p1","p2","fill","renderPoint","outerSVG","innerSVG","SIZE","viewBox","D","renderRect","fillOpacity","createRect","renderText","size","fontSize","renderScreenReaderHints","SORT_TYPES","sortBy","sort","_insertScreenReaderHint2","sortByPoint","b","sortByRectPoint","sortByLinePoint","lineA","lineB","_insertScreenReaderHint","_initEventHandlers","_initEventHandlers2","highlight","strikeout","drawing","textbox","point","area","insertScreenReaderHint","num","rects","first","last","_insertElementWithinElement2","_createScreenReaderOnly2","_insertElementWithinChildren2","COMMENT_TYPES","_renderScreenReaderComments2","_createScreenReaderOnly","_insertElementWithinChildren","_insertElementWithinElement","_renderScreenReaderComments","createScreenReaderOnly","overflow","_toConsumableArray","arr","arr2","insertElementWithinChildren","nodes","insertBefore","textLayer","textRect","insertElementWithinElement","OFFSET_ADJUST","max","textLayerElementFromPoint","temp","cloneNode","tail","unshift","pop","outerHTML","concat","renderScreenReaderComments","comments","promise","getElementById","_insertScreenReaderComment2","_insertScreenReaderComment","insertScreenReaderComment","item","initEventHandlers","reorderAnnotationsByType","removeAnnotation","insertComment","removeComment","_renderScreenReaderHints2","removeElementById","elementId","_edit","_pen","_point","_rect","_text","_page","disableEdit","enableEdit","setCanEdit","disablePen","enablePen","setPen","disablePoint","enablePoint","disableRect","enableRect","disableText","enableText","setText","createPage","renderPage","createEditOverlay","overlay","overlayId","targetId","destroyEditOverlay","anchor","styleLeft","OVERLAY_BORDER_SIZE","styleTop","boxSizing","border","borderRadius","_canEdit","background","padding","textAlign","textDecoration","handleDocumentClick","handleDocumentKeyup","handleDocumentMousedown","borderColor","boxShadow","isDragging","display","handleDocumentMousemove","handleDocumentMouseup","keyCode","dragOffsetX","dragOffsetY","dragStartX","dragStartY","cursor","offsetHeight","offsetWidth","getDelta","propX","propY","calcDelta","deltaX","deltaY","_getDelta","t","modelY","viewY","modelX","viewX","_annotation$lines$","_slicedToArray","originX","originY","_calcDelta","_annotation$lines$i","setTimeout","handleAnnotationClick","_enabled","sliceIterator","_arr","_n","_d","_e","_s","_i","Symbol","iterator","next","done","_penSize","_penColor","savePoint","penSize","penColor","input","handleInputBlur","handleInputKeyup","focus","closeInput","trim","getSelectionRects","selection","window","getSelection","range","getRangeAt","getClientRects","_type","saveRect","removeAllRanges","boundingRect","offset","_textSize","saveText","_textColor","textSize","textColor","PAGE_TEMPLATE","children","canvas","mozOpaque","renderOptions","pdfDocument","rotate","all","getPage","_ref","_ref2","pdfPage","canvasContext","getContext","alpha","getViewport","scalePage","getTextContent","normalizeWhitespace","textContent","textLayerFactory","PDFJS","DefaultTextLayerFactory","textLayerBuilder","createTextLayerBuilder","setTextContent","wrapper","outputScale","getOutputScale","scaled","sx","sy","sfx","approximateFraction","sfy","visibility","roundToDivide","floor","xinv","limit","x_","q","ctx","devicePixelRatio","backingStoreRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","pixelRatio","div","round","onChange","setColor","fireOnChange","currentValue","closePicker","togglePicker","isPickerOpen","openPicker","picker","COLORS","createColorOption","margin","onclick","className","hex","_typeof","getFileName","url","query","end","min","substring","lastIndexOf","scrollIntoView","element","spot","skipOverflowHiddenElements","parent","offsetParent","checkOverflow","offsetY","clientTop","offsetX","clientLeft","clientHeight","scrollHeight","getComputedStyle","dataset","_scaleY","_scaleX","watchScroll","viewAreaElement","callback","debounceScroll","evt","rAF","requestAnimationFrame","currentY","lastY","state","down","_eventHandler","parseQueryString","parts","params","ii","param","decodeURIComponent","binarySearchFirstItem","items","condition","minIndex","maxIndex","currentIndex","currentItem","getVisibleElements","scrollEl","views","sortByVisibility","isElementBottomBelowViewTop","view","elementBottom","currentHeight","viewHeight","hiddenHeight","percentHeight","currentWidth","viewWidth","clientWidth","visible","firstVisibleElementInd","percent","pc","abs","DefaultAnnotationLayerFactory","CSS_UNITS","DEFAULT_SCALE_VALUE","DEFAULT_SCALE","UNKNOWN_SCALE","MAX_AUTO_SCALE","SCROLLBAR_PADDING","VERTICAL_PADDING","ProgressBar","clamp","opts","bar","units","updateBar","_indeterminate","classList","add","remove","progressSize","_percent","setWidth","viewer","container","scrollbarWidth","hide","show","PDFLinkService","baseUrl","pdfViewer","pdfHistory","_pagesRefCache","setDocument","setViewer","setHistory","pagesCount","numPages","currentPageNumber","navigateTo","dest","destinationPromise","destString","goToDestination","destRef","gen","scrollPageIntoView","hash","getPageIndex","pageIndex","pageNum","cacheKey","getDestination","destination","getDestinationHash","getAnchorUrl","escape","pdfOpenParams","destKind","currentScaleValue","scaleNumber","parseFloat","setHash","updateNextHashParam","nameddest","zoomArgs","zoom","zoomArg","zoomArgNumber","event","createEvent","initCustomEvent","mode","pagemode","dispatchEvent","unescape","executeNamedAction","action","back","forward","cachePageRef","pageRef","refStr","PresentationModeState","UNKNOWN","NORMAL","CHANGING","FULLSCREEN","IGNORE_CURRENT_POSITION_ON_ZOOM","DEFAULT_CACHE_SIZE","CLEANUP_TIMEOUT","RenderingStates","INITIAL","RUNNING","PAUSED","FINISHED","PDFRenderingQueue","pdfThumbnailViewer","onIdle","highestPriorityPage","idleTimeout","printing","isThumbnailViewEnabled","setThumbnailViewer","isHighestPriority","renderingId","renderHighestPriority","currentlyVisiblePages","clearTimeout","forceRendering","bind","getHighestPriority","scrolledDown","visibleViews","numVisible","isViewFinished","nextPageIndex","previousPageIndex","renderingState","renderView","resume","continueRendering","draw","TEXT_LAYER_RENDER_DELAY","PDFPageView","options","defaultViewport","renderingQueue","annotationLayerFactory","pdfPageRotate","hasRestrictedScaling","onBeforeDraw","onAfterDraw","zoomLayer","annotationLayer","setPdfPage","totalRotation","stats","reset","destroy","cleanup","keepZoomLayer","keepAnnotations","renderTask","cancel","childNodes","currentZoomLayerNode","currentAnnotationNode","loadingIconDiv","update","clone","isScalingRestricted","maxCanvasPixels","pixelsInViewport","sqrt","useOnlyCssZoom","cssTransform","firstChild","updatePosition","redrawAnnotations","CustomStyle","relativeRotation","_viewport","absRotation","scaleX","scaleY","setProp","textLayerViewport","textRelativeRotation","textAbsRotation","transX","transY","textLayerDiv","getPagePoint","convertToPdfPoint","pageViewDrawCallback","rejectRenderPromise","isCanvasHidden","zoomLayerCanvas","resolveRenderPromise","canvasWrapper","actualSizeViewport","maxScale","renderContinueCallback","cont","renderContext","onContinue","createAnnotationLayerBuilder","beforePrint","PRINT_OUTPUT_SCALE","cssScale","printContainer","mozPrintCallback","save","fillStyle","fillRect","restore","_transformMatrix","intent","abort","TextLayerBuilder","renderingDone","divContentDone","pageIdx","matches","textDivs","findController","textLayerRenderTask","_bindMouse","_finishRendering","endOfContent","timeout","textLayerFrag","createDocumentFragment","renderTextLayer","updateMatches","reason","convertMatches","iIndex","bidiTexts","queryLen","matchIdx","str","begin","divIdx","renderMatches","beginText","appendTextToDiv","fromOffset","toOffset","span","prevEnd","isSelectedPage","selected","selectedMatchIdx","highlightAll","infinity","i0","i1","isSelected","highlightSuffix","updateMatchPosition","n0","n1","clearedUntilDivIdx","active","pageMatches","adjustTop","divBounds","pageY","toFixed","AnnotationLayerBuilder","pageDiv","linkService","parameters","dontFlip","AnnotationLayer","mozL10n","translate","SimpleLinkService","PDFViewer","PDFPageViewBuffer","shift","resize","newSize","isSameScale","oldScale","newScale","firstElementChild","removePageBorders","defaultRenderingQueue","scroll","_scrollUpdate","updateInProgress","presentationModeState","_resetView","_pages","getPageView","_currentPageNumber","initUIEvent","previousPageNumber","currentScale","_currentScale","_setScale","_currentScaleValue","pagesRotation","_pagesRotation","pageView","resolvePagesPromise","pagesPromise","isOnePageRenderedResolved","resolveOnePageRendered","onePageRendered","bindOnAfterAndBeforeDraw","_buffer","firstPagePromise","disableTextLayer","disableAutoFetch","getPagesLeft","ref","resolveFirstPage","_location","_pagesRequests","hasChildNodes","lastChild","_setScaleDispatchEvent","newValue","preset","presetValue","_setScaleUpdatePages","noScroll","isInPresentationMode","isChangingPresentationMode","currentPage","hPadding","vPadding","pageWidthScale","pageHeightScale","isLandscape","horizontalScale","widthScale","heightScale","changeOrientation","pageWidth","pageHeight","convertToViewportPoint","_updateLocation","firstPage","normalizedScaleValue","currentPageView","topLeft","intLeft","intTop","_getVisiblePages","visiblePages","suggestedCacheSize","currentId","stillFullyVisible","location","containsElement","contains","isHorizontalScrollbarEnabled","scrollWidth","_ensurePdfPageLoaded","getPageTextContent","setFindController","PDFHistory","initialized","initialDestination","initialBookmark","initialize","fingerprint","updateHistoryWithCurrentHash","previousHash","_pushToHistory","_updatePreviousBookmark","replacePreviousHistoryState","rewriteHistoryAfterBack","rewriteHistoryAfterForward","history","allowHashChange","historyUnlocked","pdfHistoryBeforeUnload","previousParams","_getPreviousParams","replacePrevious","current","reInitialized","isViewerInPresentationMode","currentBookmark","updatePreviousBookmark","previousBookmark","previousPage","nextHashParam","currentUid","uid","_isStateObjectDefined","_pushOrReplaceState","_goTo","detail","clearHistoryState","stateObj","replaceState","pushState","isHashChangeUnlocked","updateCurrentBookmark","bookmark","isInitialBookmark","onlyCheckPage","beforeUnload","_stateObj","addPrevious","overwrite","currentHash","go","direction"],"mappings":"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","file":"../pamoja-platform/build/js/pdf-annotate.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PDFAnnotate\"] = factory();\n\telse\n\t\troot[\"PDFAnnotate\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PDFAnnotate\"] = factory();\n\telse\n\t\troot[\"PDFAnnotate\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _PDFJSAnnotate = __webpack_require__(1);\n\t\n\tvar _PDFJSAnnotate2 = _interopRequireDefault(_PDFJSAnnotate);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n\texports.default = _PDFJSAnnotate2.default;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _StoreAdapter = __webpack_require__(2);\n\t\n\tvar _StoreAdapter2 = _interopRequireDefault(_StoreAdapter);\n\t\n\tvar _LocalStoreAdapter = __webpack_require__(8);\n\t\n\tvar _LocalStoreAdapter2 = _interopRequireDefault(_LocalStoreAdapter);\n\t\n\tvar _render = __webpack_require__(10);\n\t\n\tvar _render2 = _interopRequireDefault(_render);\n\t\n\tvar _UI = __webpack_require__(28);\n\t\n\tvar _UI2 = _interopRequireDefault(_UI);\n\t\n\tvar _initColorPicker = __webpack_require__(35);\n\t\n\tvar _initColorPicker2 = _interopRequireDefault(_initColorPicker);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t// expose global PDFJS viewer\n\tvar PDFJS = __webpack_require__(36);\n\t\n\texports.default = {\n\t\n\t  initColorPicker: _initColorPicker2.default,\n\t\n\t  /**\n\t   * Abstract class that needs to be defined so PDFJSAnnotate\n\t   * knows how to communicate with your server.\n\t   */\n\t  StoreAdapter: _StoreAdapter2.default,\n\t\n\t  /**\n\t   * Implementation of StoreAdapter that stores annotation data to localStorage.\n\t   */\n\t  LocalStoreAdapter: _LocalStoreAdapter2.default,\n\t\n\t  /**\n\t   * Abstract instance of StoreAdapter\n\t   */\n\t  __storeAdapter: new _StoreAdapter2.default(),\n\t\n\t  /**\n\t   * Getter for the underlying StoreAdapter property\n\t   *\n\t   * @return {StoreAdapter}\n\t   */\n\t  getStoreAdapter: function getStoreAdapter() {\n\t    return this.__storeAdapter;\n\t  },\n\t\n\t\n\t  /**\n\t   * Setter for the underlying StoreAdapter property\n\t   *\n\t   * @param {StoreAdapter} adapter The StoreAdapter implementation to be used.\n\t   */\n\t  setStoreAdapter: function setStoreAdapter(adapter) {\n\t    // TODO this throws an error when bundled\n\t    // if (!(adapter instanceof StoreAdapter)) {\n\t    //   throw new Error('adapter must be an instance of StoreAdapter');\n\t    // }\n\t\n\t    this.__storeAdapter = adapter;\n\t  },\n\t\n\t\n\t  /**\n\t   * UI is a helper for instrumenting UI interactions for creating,\n\t   * editing, and deleting annotations in the browser.\n\t   */\n\t  UI: _UI2.default,\n\t\n\t  /**\n\t   * Render the annotations for a page in the PDF Document\n\t   *\n\t   * @param {SVGElement} svg The SVG element that annotations should be rendered to\n\t   * @param {PageViewport} viewport The PDFPage.getViewport data\n\t   * @param {Object} data The StoreAdapter.getAnnotations data\n\t   * @return {Promise}\n\t   */\n\t  render: _render2.default,\n\t\n\t  /**\n\t   * Convenience method for getting annotation data\n\t   *\n\t   * @alias StoreAdapter.getAnnotations\n\t   * @param {String} documentId The ID of the document\n\t   * @param {String} pageNumber The page number\n\t   * @return {Promise}\n\t   */\n\t  getAnnotations: function getAnnotations(documentId, pageNumber) {\n\t    var _getStoreAdapter;\n\t\n\t    return (_getStoreAdapter = this.getStoreAdapter()).getAnnotations.apply(_getStoreAdapter, arguments);\n\t  }\n\t};\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _abstractFunction = __webpack_require__(3);\n\t\n\tvar _abstractFunction2 = _interopRequireDefault(_abstractFunction);\n\t\n\tvar _event = __webpack_require__(4);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t// Adapter should never be invoked publicly\n\tvar StoreAdapter = function () {\n\t  /**\n\t   * Create a new StoreAdapter instance\n\t   *\n\t   * @param {Object} [definition] The definition to use for overriding abstract methods\n\t   */\n\t  function StoreAdapter() {\n\t    var _this = this;\n\t\n\t    var definition = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\t\n\t    _classCallCheck(this, StoreAdapter);\n\t\n\t    // Copy each function from definition if it is a function we know about\n\t    Object.keys(definition).forEach(function (key) {\n\t      if (typeof definition[key] === 'function' && typeof _this[key] === 'function') {\n\t        _this[key] = definition[key];\n\t      }\n\t    });\n\t  }\n\t\n\t  /**\n\t   * Get all the annotations for a given document and page number.\n\t   *\n\t   * @param {String} documentId The ID for the document the annotations belong to\n\t   * @param {Number} pageNumber The number of the page the annotations belong to\n\t   * @return {Promise}\n\t   */\n\t\n\t\n\t  _createClass(StoreAdapter, [{\n\t    key: '__getAnnotations',\n\t    value: function __getAnnotations(documentId, pageNumber) {\n\t      (0, _abstractFunction2.default)('getAnnotations');\n\t    }\n\t  }, {\n\t    key: 'getAnnotation',\n\t\n\t\n\t    /**\n\t     * Get the definition for a specific annotation.\n\t     *\n\t     * @param {String} documentId The ID for the document the annotation belongs to\n\t     * @param {String} annotationId The ID for the annotation\n\t     * @return {Promise}\n\t     */\n\t    value: function getAnnotation(documentId, annotationId) {\n\t      (0, _abstractFunction2.default)('getAnnotation');\n\t    }\n\t\n\t    /**\n\t     * Add an annotation\n\t     *\n\t     * @param {String} documentId The ID for the document to add the annotation to\n\t     * @param {String} pageNumber The page number to add the annotation to\n\t     * @param {Object} annotation The definition for the new annotation\n\t     * @return {Promise}\n\t     */\n\t\n\t  }, {\n\t    key: '__addAnnotation',\n\t    value: function __addAnnotation(documentId, pageNumber, annotation) {\n\t      (0, _abstractFunction2.default)('addAnnotation');\n\t    }\n\t  }, {\n\t    key: '__editAnnotation',\n\t\n\t\n\t    /**\n\t     * Edit an annotation\n\t     *\n\t     * @param {String} documentId The ID for the document\n\t     * @param {String} pageNumber the page number of the annotation\n\t     * @param {Object} annotation The definition of the modified annotation\n\t     * @return {Promise}\n\t     */\n\t    value: function __editAnnotation(documentId, pageNumber, annotation) {\n\t      (0, _abstractFunction2.default)('editAnnotation');\n\t    }\n\t  }, {\n\t    key: '__deleteAnnotation',\n\t\n\t\n\t    /**\n\t     * Delete an annotation\n\t     *\n\t     * @param {String} documentId The ID for the document\n\t     * @param {String} annotationId The ID for the annotation\n\t     * @return {Promise}\n\t     */\n\t    value: function __deleteAnnotation(documentId, annotationId) {\n\t      (0, _abstractFunction2.default)('deleteAnnotation');\n\t    }\n\t  }, {\n\t    key: 'getComments',\n\t\n\t\n\t    /**\n\t     * Get all the comments for an annotation\n\t     *\n\t     * @param {String} documentId The ID for the document\n\t     * @param {String} annotationId The ID for the annotation\n\t     * @return {Promise}\n\t     */\n\t    value: function getComments(documentId, annotationId) {\n\t      (0, _abstractFunction2.default)('getComments');\n\t    }\n\t\n\t    /**\n\t     * Add a new comment\n\t     *\n\t     * @param {String} documentId The ID for the document\n\t     * @param {String} annotationId The ID for the annotation\n\t     * @param {Object} content The definition of the comment\n\t     * @return {Promise}\n\t     */\n\t\n\t  }, {\n\t    key: '__addComment',\n\t    value: function __addComment(documentId, annotationId, content) {\n\t      (0, _abstractFunction2.default)('addComment');\n\t    }\n\t  }, {\n\t    key: '__deleteComment',\n\t\n\t\n\t    /**\n\t     * Delete a comment\n\t     *\n\t     * @param {String} documentId The ID for the document\n\t     * @param {String} commentId The ID for the comment\n\t     * @return {Promise}\n\t     */\n\t    value: function __deleteComment(documentId, commentId) {\n\t      (0, _abstractFunction2.default)('deleteComment');\n\t    }\n\t  }, {\n\t    key: 'getAnnotations',\n\t    get: function get() {\n\t      return this.__getAnnotations;\n\t    },\n\t    set: function set(fn) {\n\t      this.__getAnnotations = function getAnnotations(documentId, pageNumber) {\n\t        return fn.apply(undefined, arguments).then(function (annotations) {\n\t          // TODO may be best to have this happen on the server\n\t          if (annotations.annotations) {\n\t            annotations.annotations.forEach(function (a) {\n\t              a.documentId = documentId;\n\t            });\n\t          }\n\t          return annotations;\n\t        });\n\t      };\n\t    }\n\t  }, {\n\t    key: 'addAnnotation',\n\t    get: function get() {\n\t      return this.__addAnnotation;\n\t    },\n\t    set: function set(fn) {\n\t      this.__addAnnotation = function addAnnotation(documentId, pageNumber, annotation) {\n\t        return fn.apply(undefined, arguments).then(function (annotation) {\n\t          (0, _event.fireEvent)('annotation:add', documentId, pageNumber, annotation);\n\t          return annotation;\n\t        });\n\t      };\n\t    }\n\t  }, {\n\t    key: 'editAnnotation',\n\t    get: function get() {\n\t      return this.__editAnnotation;\n\t    },\n\t    set: function set(fn) {\n\t      this.__editAnnotation = function editAnnotation(documentId, annotationId, annotation) {\n\t        return fn.apply(undefined, arguments).then(function (annotation) {\n\t          (0, _event.fireEvent)('annotation:edit', documentId, annotationId, annotation);\n\t          return annotation;\n\t        });\n\t      };\n\t    }\n\t  }, {\n\t    key: 'deleteAnnotation',\n\t    get: function get() {\n\t      return this.__deleteAnnotation;\n\t    },\n\t    set: function set(fn) {\n\t      this.__deleteAnnotation = function deleteAnnotation(documentId, annotationId) {\n\t        return fn.apply(undefined, arguments).then(function (success) {\n\t          if (success) {\n\t            (0, _event.fireEvent)('annotation:delete', documentId, annotationId);\n\t          }\n\t          return success;\n\t        });\n\t      };\n\t    }\n\t  }, {\n\t    key: 'addComment',\n\t    get: function get() {\n\t      return this.__addComment;\n\t    },\n\t    set: function set(fn) {\n\t      this.__addComment = function addComment(documentId, annotationId, content) {\n\t        return fn.apply(undefined, arguments).then(function (comment) {\n\t          (0, _event.fireEvent)('comment:add', documentId, annotationId, comment);\n\t          return comment;\n\t        });\n\t      };\n\t    }\n\t  }, {\n\t    key: 'deleteComment',\n\t    get: function get() {\n\t      return this.__deleteComment;\n\t    },\n\t    set: function set(fn) {\n\t      this.__deleteComment = function deleteComment(documentId, commentId) {\n\t        return fn.apply(undefined, arguments).then(function (success) {\n\t          if (success) {\n\t            (0, _event.fireEvent)('comment:delete', documentId, commentId);\n\t          }\n\t          return success;\n\t        });\n\t      };\n\t    }\n\t  }]);\n\t\n\t  return StoreAdapter;\n\t}();\n\t\n\texports.default = StoreAdapter;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = abstractFunction;\n\t/**\n\t * Throw an Error for an abstract function that hasn't been implemented.\n\t *\n\t * @param {String} name The name of the abstract function\n\t */\n\tfunction abstractFunction(name) {\n\t  throw new Error(name + ' is not implemented');\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.fireEvent = fireEvent;\n\texports.addEventListener = addEventListener;\n\texports.removeEventListener = removeEventListener;\n\t\n\tvar _events = __webpack_require__(5);\n\t\n\tvar _events2 = _interopRequireDefault(_events);\n\t\n\tvar _utils = __webpack_require__(6);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar emitter = new _events2.default();\n\t\n\tvar clickNode = void 0;\n\t\n\t/**\n\t * Handle document.click event\n\t *\n\t * @param {Event} e The DOM event to be handled\n\t */\n\tdocument.addEventListener('click', function handleDocumentClick(e) {\n\t  if (!(0, _utils.findSVGAtPoint)(e.clientX, e.clientY)) {\n\t    return;\n\t  }\n\t\n\t  var target = (0, _utils.findAnnotationAtPoint)(e.clientX, e.clientY);\n\t\n\t  // Emit annotation:blur if clickNode is no longer clicked\n\t  if (clickNode && clickNode !== target) {\n\t    emitter.emit('annotation:blur', clickNode, e);\n\t  }\n\t\n\t  // Emit annotation:click if target was clicked\n\t  if (target) {\n\t    emitter.emit('annotation:click', target, e);\n\t  }\n\t\n\t  clickNode = target;\n\t});\n\t\n\t// let mouseOverNode;\n\t// document.addEventListener('mousemove', function handleDocumentMousemove(e) {\n\t//   let target = findAnnotationAtPoint(e.clientX, e.clientY);\n\t//\n\t//   // Emit annotation:mouseout if target was mouseout'd\n\t//   if (mouseOverNode && !target) {\n\t//     emitter.emit('annotation:mouseout', mouseOverNode);\n\t//   }\n\t//\n\t//   // Emit annotation:mouseover if target was mouseover'd\n\t//   if (target && mouseOverNode !== target) {\n\t//     emitter.emit('annotation:mouseover', target);\n\t//   }\n\t//\n\t//   mouseOverNode = target;\n\t// });\n\t\n\tfunction fireEvent() {\n\t  emitter.emit.apply(emitter, arguments);\n\t};\n\tfunction addEventListener() {\n\t  emitter.on.apply(emitter, arguments);\n\t};\n\tfunction removeEventListener() {\n\t  emitter.removeListener.apply(emitter, arguments);\n\t};\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t// Copyright Joyent, Inc. and other Node contributors.\n\t//\n\t// Permission is hereby granted, free of charge, to any person obtaining a\n\t// copy of this software and associated documentation files (the\n\t// \"Software\"), to deal in the Software without restriction, including\n\t// without limitation the rights to use, copy, modify, merge, publish,\n\t// distribute, sublicense, and/or sell copies of the Software, and to permit\n\t// persons to whom the Software is furnished to do so, subject to the\n\t// following conditions:\n\t//\n\t// The above copyright notice and this permission notice shall be included\n\t// in all copies or substantial portions of the Software.\n\t//\n\t// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n\t// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n\t// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n\t// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n\t// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n\t// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n\t// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\t\n\tfunction EventEmitter() {\n\t  this._events = this._events || {};\n\t  this._maxListeners = this._maxListeners || undefined;\n\t}\n\tmodule.exports = EventEmitter;\n\t\n\t// Backwards-compat with node 0.10.x\n\tEventEmitter.EventEmitter = EventEmitter;\n\t\n\tEventEmitter.prototype._events = undefined;\n\tEventEmitter.prototype._maxListeners = undefined;\n\t\n\t// By default EventEmitters will print a warning if more than 10 listeners are\n\t// added to it. This is a useful default which helps finding memory leaks.\n\tEventEmitter.defaultMaxListeners = 10;\n\t\n\t// Obviously not all Emitters should be limited to 10. This function allows\n\t// that to be increased. Set to zero for unlimited.\n\tEventEmitter.prototype.setMaxListeners = function(n) {\n\t  if (!isNumber(n) || n < 0 || isNaN(n))\n\t    throw TypeError('n must be a positive number');\n\t  this._maxListeners = n;\n\t  return this;\n\t};\n\t\n\tEventEmitter.prototype.emit = function(type) {\n\t  var er, handler, len, args, i, listeners;\n\t\n\t  if (!this._events)\n\t    this._events = {};\n\t\n\t  // If there is no 'error' event listener then throw.\n\t  if (type === 'error') {\n\t    if (!this._events.error ||\n\t        (isObject(this._events.error) && !this._events.error.length)) {\n\t      er = arguments[1];\n\t      if (er instanceof Error) {\n\t        throw er; // Unhandled 'error' event\n\t      } else {\n\t        // At least give some kind of context to the user\n\t        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n\t        err.context = er;\n\t        throw err;\n\t      }\n\t    }\n\t  }\n\t\n\t  handler = this._events[type];\n\t\n\t  if (isUndefined(handler))\n\t    return false;\n\t\n\t  if (isFunction(handler)) {\n\t    switch (arguments.length) {\n\t      // fast cases\n\t      case 1:\n\t        handler.call(this);\n\t        break;\n\t      case 2:\n\t        handler.call(this, arguments[1]);\n\t        break;\n\t      case 3:\n\t        handler.call(this, arguments[1], arguments[2]);\n\t        break;\n\t      // slower\n\t      default:\n\t        args = Array.prototype.slice.call(arguments, 1);\n\t        handler.apply(this, args);\n\t    }\n\t  } else if (isObject(handler)) {\n\t    args = Array.prototype.slice.call(arguments, 1);\n\t    listeners = handler.slice();\n\t    len = listeners.length;\n\t    for (i = 0; i < len; i++)\n\t      listeners[i].apply(this, args);\n\t  }\n\t\n\t  return true;\n\t};\n\t\n\tEventEmitter.prototype.addListener = function(type, listener) {\n\t  var m;\n\t\n\t  if (!isFunction(listener))\n\t    throw TypeError('listener must be a function');\n\t\n\t  if (!this._events)\n\t    this._events = {};\n\t\n\t  // To avoid recursion in the case that type === \"newListener\"! Before\n\t  // adding it to the listeners, first emit \"newListener\".\n\t  if (this._events.newListener)\n\t    this.emit('newListener', type,\n\t              isFunction(listener.listener) ?\n\t              listener.listener : listener);\n\t\n\t  if (!this._events[type])\n\t    // Optimize the case of one listener. Don't need the extra array object.\n\t    this._events[type] = listener;\n\t  else if (isObject(this._events[type]))\n\t    // If we've already got an array, just append.\n\t    this._events[type].push(listener);\n\t  else\n\t    // Adding the second element, need to change to array.\n\t    this._events[type] = [this._events[type], listener];\n\t\n\t  // Check for listener leak\n\t  if (isObject(this._events[type]) && !this._events[type].warned) {\n\t    if (!isUndefined(this._maxListeners)) {\n\t      m = this._maxListeners;\n\t    } else {\n\t      m = EventEmitter.defaultMaxListeners;\n\t    }\n\t\n\t    if (m && m > 0 && this._events[type].length > m) {\n\t      this._events[type].warned = true;\n\t      console.error('(node) warning: possible EventEmitter memory ' +\n\t                    'leak detected. %d listeners added. ' +\n\t                    'Use emitter.setMaxListeners() to increase limit.',\n\t                    this._events[type].length);\n\t      if (typeof console.trace === 'function') {\n\t        // not supported in IE 10\n\t        console.trace();\n\t      }\n\t    }\n\t  }\n\t\n\t  return this;\n\t};\n\t\n\tEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\t\n\tEventEmitter.prototype.once = function(type, listener) {\n\t  if (!isFunction(listener))\n\t    throw TypeError('listener must be a function');\n\t\n\t  var fired = false;\n\t\n\t  function g() {\n\t    this.removeListener(type, g);\n\t\n\t    if (!fired) {\n\t      fired = true;\n\t      listener.apply(this, arguments);\n\t    }\n\t  }\n\t\n\t  g.listener = listener;\n\t  this.on(type, g);\n\t\n\t  return this;\n\t};\n\t\n\t// emits a 'removeListener' event iff the listener was removed\n\tEventEmitter.prototype.removeListener = function(type, listener) {\n\t  var list, position, length, i;\n\t\n\t  if (!isFunction(listener))\n\t    throw TypeError('listener must be a function');\n\t\n\t  if (!this._events || !this._events[type])\n\t    return this;\n\t\n\t  list = this._events[type];\n\t  length = list.length;\n\t  position = -1;\n\t\n\t  if (list === listener ||\n\t      (isFunction(list.listener) && list.listener === listener)) {\n\t    delete this._events[type];\n\t    if (this._events.removeListener)\n\t      this.emit('removeListener', type, listener);\n\t\n\t  } else if (isObject(list)) {\n\t    for (i = length; i-- > 0;) {\n\t      if (list[i] === listener ||\n\t          (list[i].listener && list[i].listener === listener)) {\n\t        position = i;\n\t        break;\n\t      }\n\t    }\n\t\n\t    if (position < 0)\n\t      return this;\n\t\n\t    if (list.length === 1) {\n\t      list.length = 0;\n\t      delete this._events[type];\n\t    } else {\n\t      list.splice(position, 1);\n\t    }\n\t\n\t    if (this._events.removeListener)\n\t      this.emit('removeListener', type, listener);\n\t  }\n\t\n\t  return this;\n\t};\n\t\n\tEventEmitter.prototype.removeAllListeners = function(type) {\n\t  var key, listeners;\n\t\n\t  if (!this._events)\n\t    return this;\n\t\n\t  // not listening for removeListener, no need to emit\n\t  if (!this._events.removeListener) {\n\t    if (arguments.length === 0)\n\t      this._events = {};\n\t    else if (this._events[type])\n\t      delete this._events[type];\n\t    return this;\n\t  }\n\t\n\t  // emit removeListener for all listeners on all events\n\t  if (arguments.length === 0) {\n\t    for (key in this._events) {\n\t      if (key === 'removeListener') continue;\n\t      this.removeAllListeners(key);\n\t    }\n\t    this.removeAllListeners('removeListener');\n\t    this._events = {};\n\t    return this;\n\t  }\n\t\n\t  listeners = this._events[type];\n\t\n\t  if (isFunction(listeners)) {\n\t    this.removeListener(type, listeners);\n\t  } else if (listeners) {\n\t    // LIFO order\n\t    while (listeners.length)\n\t      this.removeListener(type, listeners[listeners.length - 1]);\n\t  }\n\t  delete this._events[type];\n\t\n\t  return this;\n\t};\n\t\n\tEventEmitter.prototype.listeners = function(type) {\n\t  var ret;\n\t  if (!this._events || !this._events[type])\n\t    ret = [];\n\t  else if (isFunction(this._events[type]))\n\t    ret = [this._events[type]];\n\t  else\n\t    ret = this._events[type].slice();\n\t  return ret;\n\t};\n\t\n\tEventEmitter.prototype.listenerCount = function(type) {\n\t  if (this._events) {\n\t    var evlistener = this._events[type];\n\t\n\t    if (isFunction(evlistener))\n\t      return 1;\n\t    else if (evlistener)\n\t      return evlistener.length;\n\t  }\n\t  return 0;\n\t};\n\t\n\tEventEmitter.listenerCount = function(emitter, type) {\n\t  return emitter.listenerCount(type);\n\t};\n\t\n\tfunction isFunction(arg) {\n\t  return typeof arg === 'function';\n\t}\n\t\n\tfunction isNumber(arg) {\n\t  return typeof arg === 'number';\n\t}\n\t\n\tfunction isObject(arg) {\n\t  return typeof arg === 'object' && arg !== null;\n\t}\n\t\n\tfunction isUndefined(arg) {\n\t  return arg === void 0;\n\t}\n\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.BORDER_COLOR = undefined;\n\texports.findSVGContainer = findSVGContainer;\n\texports.findSVGAtPoint = findSVGAtPoint;\n\texports.findAnnotationAtPoint = findAnnotationAtPoint;\n\texports.pointIntersectsRect = pointIntersectsRect;\n\texports.getOffsetAnnotationRect = getOffsetAnnotationRect;\n\texports.getAnnotationRect = getAnnotationRect;\n\texports.scaleUp = scaleUp;\n\texports.scaleDown = scaleDown;\n\texports.getScroll = getScroll;\n\texports.getOffset = getOffset;\n\texports.disableUserSelect = disableUserSelect;\n\texports.enableUserSelect = enableUserSelect;\n\texports.getMetadata = getMetadata;\n\t\n\tvar _createStylesheet = __webpack_require__(7);\n\t\n\tvar _createStylesheet2 = _interopRequireDefault(_createStylesheet);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar BORDER_COLOR = exports.BORDER_COLOR = '#00BFFF';\n\t\n\tvar userSelectStyleSheet = (0, _createStylesheet2.default)({\n\t  body: {\n\t    '-webkit-user-select': 'none',\n\t    '-moz-user-select': 'none',\n\t    '-ms-user-select': 'none',\n\t    'user-select': 'none'\n\t  }\n\t});\n\tuserSelectStyleSheet.setAttribute('data-pdf-annotate-user-select', 'true');\n\t\n\t/**\n\t * Find the SVGElement that contains all the annotations for a page\n\t *\n\t * @param {Element} node An annotation within that container\n\t * @return {SVGElement} The container SVG or null if it can't be found\n\t */\n\tfunction findSVGContainer(node) {\n\t  var parentNode = node;\n\t\n\t  while ((parentNode = parentNode.parentNode) && parentNode !== document) {\n\t    if (parentNode.nodeName.toUpperCase() === 'SVG' && parentNode.getAttribute('data-pdf-annotate-container') === 'true') {\n\t      return parentNode;\n\t    }\n\t  }\n\t\n\t  return null;\n\t}\n\t\n\t/**\n\t * Find an SVGElement container at a given point\n\t *\n\t * @param {Number} x The x coordinate of the point\n\t * @param {Number} y The y coordinate of the point\n\t * @return {SVGElement} The container SVG or null if one can't be found\n\t */\n\tfunction findSVGAtPoint(x, y) {\n\t  var elements = document.querySelectorAll('svg[data-pdf-annotate-container=\"true\"]');\n\t\n\t  for (var i = 0, l = elements.length; i < l; i++) {\n\t    var el = elements[i];\n\t    var rect = el.getBoundingClientRect();\n\t\n\t    if (pointIntersectsRect(x, y, rect)) {\n\t\n\t      return el;\n\t    }\n\t  }\n\t\n\t  return null;\n\t}\n\t\n\t/**\n\t * Find an Element that represents an annotation at a given point\n\t *\n\t * @param {Number} x The x coordinate of the point\n\t * @param {Number} y The y coordinate of the point\n\t * @return {Element} The annotation element or null if one can't be found\n\t */\n\tfunction findAnnotationAtPoint(x, y) {\n\t  var svg = findSVGAtPoint(x, y);\n\t  if (!svg) {\n\t    return;\n\t  }\n\t  var elements = svg.querySelectorAll('[data-pdf-annotate-type]');\n\t\n\t  // Find a target element within SVG\n\t  for (var i = 0, l = elements.length; i < l; i++) {\n\t    var el = elements[i];\n\t    if (pointIntersectsRect(x, y, getOffsetAnnotationRect(el))) {\n\t      return el;\n\t    }\n\t  }\n\t\n\t  return null;\n\t}\n\t\n\t/**\n\t * Determine if a point intersects a rect\n\t *\n\t * @param {Number} x The x coordinate of the point\n\t * @param {Number} y The y coordinate of the point\n\t * @param {Object} rect The points of a rect (likely from getBoundingClientRect)\n\t * @return {Boolean} True if a collision occurs, otherwise false\n\t */\n\tfunction pointIntersectsRect(x, y, rect) {\n\t  return y >= rect.top && y <= rect.bottom && x >= rect.left && x <= rect.right;\n\t}\n\t\n\t/**\n\t * Get the rect of an annotation element accounting for offset.\n\t *\n\t * @param {Element} el The element to get the rect of\n\t * @return {Object} The dimensions of the element\n\t */\n\tfunction getOffsetAnnotationRect(el) {\n\t  var rect = getAnnotationRect(el);\n\t\n\t  var _getOffset = getOffset(el),\n\t      offsetLeft = _getOffset.offsetLeft,\n\t      offsetTop = _getOffset.offsetTop;\n\t\n\t  return {\n\t    top: rect.top + offsetTop,\n\t    left: rect.left + offsetLeft,\n\t    right: rect.right + offsetLeft,\n\t    bottom: rect.bottom + offsetTop\n\t  };\n\t}\n\t\n\t/**\n\t * Get the rect of an annotation element.\n\t *\n\t * @param {Element} el The element to get the rect of\n\t * @return {Object} The dimensions of the element\n\t */\n\tfunction getAnnotationRect(el) {\n\t  var h = 0,\n\t      w = 0,\n\t      x = 0,\n\t      y = 0;\n\t  var rect = el.getBoundingClientRect();\n\t  // TODO this should be calculated somehow\n\t  var LINE_OFFSET = 16;\n\t\n\t  switch (el.nodeName.toLowerCase()) {\n\t    case 'path':\n\t      var minX = void 0,\n\t          maxX = void 0,\n\t          minY = void 0,\n\t          maxY = void 0;\n\t\n\t      el.getAttribute('d').replace(/Z/, '').split('M').splice(1).forEach(function (p) {\n\t        var s = p.split(' ').map(function (i) {\n\t          return parseInt(i, 10);\n\t        });\n\t\n\t        if (typeof minX === 'undefined' || s[0] < minX) {\n\t          minX = s[0];\n\t        }\n\t        if (typeof maxX === 'undefined' || s[2] > maxX) {\n\t          maxX = s[2];\n\t        }\n\t        if (typeof minY === 'undefined' || s[1] < minY) {\n\t          minY = s[1];\n\t        }\n\t        if (typeof maxY === 'undefined' || s[3] > maxY) {\n\t          maxY = s[3];\n\t        }\n\t      });\n\t\n\t      h = maxY - minY;\n\t      w = maxX - minX;\n\t      x = minX;\n\t      y = minY;\n\t      break;\n\t\n\t    case 'line':\n\t      h = parseInt(el.getAttribute('y2'), 10) - parseInt(el.getAttribute('y1'), 10);\n\t      w = parseInt(el.getAttribute('x2'), 10) - parseInt(el.getAttribute('x1'), 10);\n\t      x = parseInt(el.getAttribute('x1'), 10);\n\t      y = parseInt(el.getAttribute('y1'), 10);\n\t\n\t      if (h === 0) {\n\t        h += LINE_OFFSET;\n\t        y -= LINE_OFFSET / 2;\n\t      }\n\t      break;\n\t\n\t    case 'text':\n\t      h = rect.height;\n\t      w = rect.width;\n\t      x = parseInt(el.getAttribute('x'), 10);\n\t      y = parseInt(el.getAttribute('y'), 10) - h;\n\t      break;\n\t\n\t    case 'g':\n\t      var _getOffset2 = getOffset(el),\n\t          offsetLeft = _getOffset2.offsetLeft,\n\t          offsetTop = _getOffset2.offsetTop;\n\t\n\t      h = rect.height;\n\t      w = rect.width;\n\t      x = rect.left - offsetLeft;\n\t      y = rect.top - offsetTop;\n\t\n\t      if (el.getAttribute('data-pdf-annotate-type') === 'strikeout') {\n\t        h += LINE_OFFSET;\n\t        y -= LINE_OFFSET / 2;\n\t      }\n\t      break;\n\t\n\t    case 'rect':\n\t    case 'svg':\n\t      h = parseInt(el.getAttribute('height'), 10);\n\t      w = parseInt(el.getAttribute('width'), 10);\n\t      x = parseInt(el.getAttribute('x'), 10);\n\t      y = parseInt(el.getAttribute('y'), 10);\n\t      break;\n\t  }\n\t\n\t  // Result provides same properties as getBoundingClientRect\n\t  var result = {\n\t    top: y,\n\t    left: x,\n\t    width: w,\n\t    height: h,\n\t    right: x + w,\n\t    bottom: y + h\n\t  };\n\t\n\t  // For the case of nested SVG (point annotations) and grouped\n\t  // lines or rects no adjustment needs to be made for scale.\n\t  // I assume that the scale is already being handled\n\t  // natively by virtue of the `transform` attribute.\n\t  if (!['svg', 'g'].includes(el.nodeName.toLowerCase())) {\n\t    result = scaleUp(findSVGAtPoint(rect.left, rect.top), result);\n\t  }\n\t\n\t  return result;\n\t}\n\t\n\t/**\n\t * Adjust scale from normalized scale (100%) to rendered scale.\n\t *\n\t * @param {SVGElement} svg The SVG to gather metadata from\n\t * @param {Object} rect A map of numeric values to scale\n\t * @return {Object} A copy of `rect` with values scaled up\n\t */\n\tfunction scaleUp(svg, rect) {\n\t  var result = {};\n\t\n\t  var _getMetadata = getMetadata(svg),\n\t      viewport = _getMetadata.viewport;\n\t\n\t  Object.keys(rect).forEach(function (key) {\n\t    result[key] = rect[key] * viewport.scale;\n\t  });\n\t\n\t  return result;\n\t}\n\t\n\t/**\n\t * Adjust scale from rendered scale to a normalized scale (100%).\n\t *\n\t * @param {SVGElement} svg The SVG to gather metadata from\n\t * @param {Object} rect A map of numeric values to scale\n\t * @return {Object} A copy of `rect` with values scaled down\n\t */\n\tfunction scaleDown(svg, rect) {\n\t  var result = {};\n\t\n\t  var _getMetadata2 = getMetadata(svg),\n\t      viewport = _getMetadata2.viewport;\n\t\n\t  Object.keys(rect).forEach(function (key) {\n\t    result[key] = rect[key] / viewport.scale;\n\t  });\n\t\n\t  return result;\n\t}\n\t\n\t/**\n\t * Get the scroll position of an element, accounting for parent elements\n\t *\n\t * @param {Element} el The element to get the scroll position for\n\t * @return {Object} The scrollTop and scrollLeft position\n\t */\n\tfunction getScroll(el) {\n\t  var scrollTop = 0;\n\t  var scrollLeft = 0;\n\t  var parentNode = el;\n\t\n\t  while ((parentNode = parentNode.parentNode) && parentNode !== document) {\n\t    scrollTop += parentNode.scrollTop;\n\t    scrollLeft += parentNode.scrollLeft;\n\t  }\n\t\n\t  return { scrollTop: scrollTop, scrollLeft: scrollLeft };\n\t}\n\t\n\t/**\n\t * Get the offset position of an element, accounting for parent elements\n\t *\n\t * @param {Element} el The element to get the offset position for\n\t * @return {Object} The offsetTop and offsetLeft position\n\t */\n\tfunction getOffset(el) {\n\t  var parentNode = el;\n\t\n\t  while ((parentNode = parentNode.parentNode) && parentNode !== document) {\n\t    if (parentNode.nodeName.toUpperCase() === 'SVG') {\n\t      break;\n\t    }\n\t  }\n\t\n\t  var rect = parentNode.getBoundingClientRect();\n\t\n\t  return { offsetLeft: rect.left, offsetTop: rect.top };\n\t}\n\t\n\t/**\n\t * Disable user ability to select text on page\n\t */\n\tfunction disableUserSelect() {\n\t  if (!userSelectStyleSheet.parentNode) {\n\t    document.head.appendChild(userSelectStyleSheet);\n\t  }\n\t}\n\t\n\t/**\n\t * Enable user ability to select text on page\n\t */\n\tfunction enableUserSelect() {\n\t  if (userSelectStyleSheet.parentNode) {\n\t    userSelectStyleSheet.parentNode.removeChild(userSelectStyleSheet);\n\t  }\n\t}\n\t\n\t/**\n\t * Get the metadata for a SVG container\n\t *\n\t * @param {SVGElement} svg The SVG container to get metadata for\n\t */\n\tfunction getMetadata(svg) {\n\t  return {\n\t    documentId: svg.getAttribute('data-pdf-annotate-document'),\n\t    pageNumber: parseInt(svg.getAttribute('data-pdf-annotate-page'), 10),\n\t    viewport: JSON.parse(svg.getAttribute('data-pdf-annotate-viewport'))\n\t  };\n\t}\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n\tmodule.exports = function createStyleSheet(blocks) {\n\t  var style = document.createElement('style');\n\t  var text = Object.keys(blocks).map(function (selector) {\n\t    return processRuleSet(selector, blocks[selector]);\n\t  }).join('\\n');\n\t  \n\t  style.setAttribute('type', 'text/css');\n\t  style.appendChild(document.createTextNode(text));\n\t\n\t  return style;\n\t}\n\t\n\tfunction processRuleSet(selector, block) {\n\t  return selector + ' {\\n' + processDeclarationBlock(block) + '\\n}';\n\t}\n\t\n\tfunction processDeclarationBlock(block) {\n\t  return Object.keys(block).map(function (prop) {\n\t    return processDeclaration(prop, block[prop]);\n\t  }).join('\\n');\n\t}\n\t\n\tfunction processDeclaration(prop, value) {\n\t  if (!isNaN(value) && value != 0) {\n\t    value = value + 'px';\n\t  }\n\t\n\t  return hyphenate(prop) + ': ' + value + ';';\n\t}\n\t\n\tfunction hyphenate(prop) {\n\t  return prop.replace(/[A-Z]/g, function (match) {\n\t    return '-' + match.toLowerCase();\n\t  });\n\t}\n\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _uuid = __webpack_require__(9);\n\t\n\tvar _uuid2 = _interopRequireDefault(_uuid);\n\t\n\tvar _StoreAdapter2 = __webpack_require__(2);\n\t\n\tvar _StoreAdapter3 = _interopRequireDefault(_StoreAdapter2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\t// StoreAdapter for working with localStorage\n\t// This is ideal for testing, examples, and prototyping\n\tvar LocalStoreAdapter = function (_StoreAdapter) {\n\t  _inherits(LocalStoreAdapter, _StoreAdapter);\n\t\n\t  function LocalStoreAdapter() {\n\t    _classCallCheck(this, LocalStoreAdapter);\n\t\n\t    return _possibleConstructorReturn(this, (LocalStoreAdapter.__proto__ || Object.getPrototypeOf(LocalStoreAdapter)).call(this, {\n\t      getAnnotations: function getAnnotations(documentId, pageNumber) {\n\t        return new Promise(function (resolve, reject) {\n\t          var annotations = _getAnnotations(documentId).filter(function (i) {\n\t            return i.page === pageNumber && i.class === 'Annotation';\n\t          });\n\t\n\t          resolve({\n\t            documentId: documentId,\n\t            pageNumber: pageNumber,\n\t            annotations: annotations\n\t          });\n\t        });\n\t      },\n\t      getAnnotation: function getAnnotation(documentId, annotationId) {\n\t        return Promise.resolve(_getAnnotations(documentId)[findAnnotation(documentId, annotationId)]);\n\t      },\n\t      addAnnotation: function addAnnotation(documentId, pageNumber, annotation) {\n\t        return new Promise(function (resolve, reject) {\n\t          annotation.class = 'Annotation';\n\t          annotation.uuid = (0, _uuid2.default)();\n\t          annotation.page = pageNumber;\n\t\n\t          var annotations = _getAnnotations(documentId);\n\t          annotations.push(annotation);\n\t          updateAnnotations(documentId, annotations);\n\t\n\t          resolve(annotation);\n\t        });\n\t      },\n\t      editAnnotation: function editAnnotation(documentId, annotationId, annotation) {\n\t        return new Promise(function (resolve, reject) {\n\t          var annotations = _getAnnotations(documentId);\n\t          annotations[findAnnotation(documentId, annotationId)] = annotation;\n\t          updateAnnotations(documentId, annotations);\n\t\n\t          resolve(annotation);\n\t        });\n\t      },\n\t      deleteAnnotation: function deleteAnnotation(documentId, annotationId) {\n\t        return new Promise(function (resolve, reject) {\n\t          var index = findAnnotation(documentId, annotationId);\n\t          if (index > -1) {\n\t            var annotations = _getAnnotations(documentId);\n\t            annotations.splice(index, 1);\n\t            updateAnnotations(documentId, annotations);\n\t          }\n\t\n\t          resolve(true);\n\t        });\n\t      },\n\t      getComments: function getComments(documentId, annotationId) {\n\t        return new Promise(function (resolve, reject) {\n\t          resolve(_getAnnotations(documentId).filter(function (i) {\n\t            return i.class === 'Comment' && parseInt(i.annotation) === parseInt(annotationId);\n\t          }));\n\t        });\n\t      },\n\t      addComment: function addComment(documentId, annotationId, content) {\n\t        return new Promise(function (resolve, reject) {\n\t          var comment = {\n\t            class: 'Comment',\n\t            uuid: (0, _uuid2.default)(),\n\t            annotation: annotationId,\n\t            content: content\n\t          };\n\t\n\t          var annotations = _getAnnotations(documentId);\n\t          annotations.push(comment);\n\t          updateAnnotations(documentId, annotations);\n\t\n\t          resolve(comment);\n\t        });\n\t      },\n\t      deleteComment: function deleteComment(documentId, commentId) {\n\t        return new Promise(function (resolve, reject) {\n\t          _getAnnotations(documentId);\n\t          var index = -1;\n\t          var annotations = _getAnnotations(documentId);\n\t          for (var i = 0, l = annotations.length; i < l; i++) {\n\t            if (annotations[i].uuid === commentId) {\n\t              index = i;\n\t              break;\n\t            }\n\t          }\n\t\n\t          if (index > -1) {\n\t            annotations.splice(index, 1);\n\t            updateAnnotations(documentId, annotations);\n\t          }\n\t\n\t          resolve(true);\n\t        });\n\t      }\n\t    }));\n\t  }\n\t\n\t  return LocalStoreAdapter;\n\t}(_StoreAdapter3.default);\n\t\n\texports.default = LocalStoreAdapter;\n\t\n\t\n\tfunction _getAnnotations(documentId) {\n\t  return JSON.parse(localStorage.getItem(documentId + '/annotations')) || [];\n\t}\n\t\n\tfunction updateAnnotations(documentId, annotations) {\n\t  localStorage.setItem(documentId + '/annotations', JSON.stringify(annotations));\n\t}\n\t\n\tfunction findAnnotation(documentId, annotationId) {\n\t  var index = -1;\n\t  var annotations = _getAnnotations(documentId);\n\t  for (var i = 0, l = annotations.length; i < l; i++) {\n\t    if (annotations[i].uuid === annotationId) {\n\t      index = i;\n\t      break;\n\t    }\n\t  }\n\t  return index;\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 9 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = uuid;\n\tvar REGEXP = /[xy]/g;\n\tvar PATTERN = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx';\n\t\n\tfunction replacement(c) {\n\t  var r = Math.random() * 16 | 0;\n\t  var v = c == 'x' ? r : r & 0x3 | 0x8;\n\t  return v.toString(16);\n\t}\n\t\n\t/**\n\t * Generate a univierally unique identifier\n\t *\n\t * @return {String}\n\t */\n\tfunction uuid() {\n\t  return PATTERN.replace(REGEXP, replacement);\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = render;\n\t\n\tvar _PDFJSAnnotate = __webpack_require__(1);\n\t\n\tvar _PDFJSAnnotate2 = _interopRequireDefault(_PDFJSAnnotate);\n\t\n\tvar _appendChild = __webpack_require__(11);\n\t\n\tvar _appendChild2 = _interopRequireDefault(_appendChild);\n\t\n\tvar _renderScreenReaderHints = __webpack_require__(20);\n\t\n\tvar _renderScreenReaderHints2 = _interopRequireDefault(_renderScreenReaderHints);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\n\t * Render the response from PDFJSAnnotate.getStoreAdapter().getAnnotations to SVG\n\t *\n\t * @param {SVGElement} svg The SVG element to render the annotations to\n\t * @param {Object} viewport The page viewport data\n\t * @param {Object} data The response from PDFJSAnnotate.getStoreAdapter().getAnnotations\n\t * @return {Promise} Settled once rendering has completed\n\t *  A settled Promise will be either:\n\t *    - fulfilled: SVGElement\n\t *    - rejected: Error\n\t */\n\tfunction render(svg, viewport, data) {\n\t  return new Promise(function (resolve, reject) {\n\t    // Reset the content of the SVG\n\t    svg.innerHTML = '';\n\t    svg.setAttribute('data-pdf-annotate-container', true);\n\t    svg.setAttribute('data-pdf-annotate-viewport', JSON.stringify(viewport));\n\t    svg.removeAttribute('data-pdf-annotate-document');\n\t    svg.removeAttribute('data-pdf-annotate-page');\n\t\n\t    // If there's no data nothing can be done\n\t    if (!data) {\n\t      return resolve(svg);\n\t    }\n\t\n\t    svg.setAttribute('data-pdf-annotate-document', data.documentId);\n\t    svg.setAttribute('data-pdf-annotate-page', data.pageNumber);\n\t\n\t    // Make sure annotations is an array\n\t    if (!Array.isArray(data.annotations) || data.annotations.length === 0) {\n\t      return resolve(svg);\n\t    }\n\t\n\t    // Append annotation to svg\n\t    data.annotations.forEach(function (a) {\n\t      (0, _appendChild2.default)(svg, a, viewport);\n\t    });\n\t\n\t    resolve(svg);\n\t  });\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = appendChild;\n\t\n\tvar _objectAssign = __webpack_require__(12);\n\t\n\tvar _objectAssign2 = _interopRequireDefault(_objectAssign);\n\t\n\tvar _renderLine = __webpack_require__(13);\n\t\n\tvar _renderLine2 = _interopRequireDefault(_renderLine);\n\t\n\tvar _renderPath = __webpack_require__(16);\n\t\n\tvar _renderPath2 = _interopRequireDefault(_renderPath);\n\t\n\tvar _renderPoint = __webpack_require__(17);\n\t\n\tvar _renderPoint2 = _interopRequireDefault(_renderPoint);\n\t\n\tvar _renderRect = __webpack_require__(18);\n\t\n\tvar _renderRect2 = _interopRequireDefault(_renderRect);\n\t\n\tvar _renderText = __webpack_require__(19);\n\t\n\tvar _renderText2 = _interopRequireDefault(_renderText);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar isFirefox = /firefox/i.test(navigator.userAgent);\n\t\n\t/**\n\t * Get the x/y translation to be used for transforming the annotations\n\t * based on the rotation of the viewport.\n\t *\n\t * @param {Object} viewport The viewport data from the page\n\t * @return {Object}\n\t */\n\tfunction getTranslation(viewport) {\n\t  var x = void 0;\n\t  var y = void 0;\n\t\n\t  // Modulus 360 on the rotation so that we only\n\t  // have to worry about four possible values.\n\t  switch (viewport.rotation % 360) {\n\t    case 0:\n\t      x = y = 0;\n\t      break;\n\t    case 90:\n\t      x = 0;\n\t      y = viewport.width / viewport.scale * -1;\n\t      break;\n\t    case 180:\n\t      x = viewport.width / viewport.scale * -1;\n\t      y = viewport.height / viewport.scale * -1;\n\t      break;\n\t    case 270:\n\t      x = viewport.height / viewport.scale * -1;\n\t      y = 0;\n\t      break;\n\t  }\n\t\n\t  return { x: x, y: y };\n\t}\n\t\n\t/**\n\t * Transform the rotation and scale of a node using SVG's native transform attribute.\n\t *\n\t * @param {Node} node The node to be transformed\n\t * @param {Object} viewport The page's viewport data\n\t * @return {Node}\n\t */\n\tfunction transform(node, viewport) {\n\t  var trans = getTranslation(viewport);\n\t\n\t  // Let SVG natively transform the element\n\t  //node.setAttribute('transform', `scale(${viewport.scale}) rotate(${viewport.rotation}) translate(${trans.x}, ${trans.y})`);\n\t  node.setAttribute('transform', 'scale(' + viewport.scale + ')');\n\t\n\t  // Manually adjust x/y for nested SVG nodes\n\t  if (!isFirefox && node.nodeName.toLowerCase() === 'svg') {\n\t    node.setAttribute('x', parseInt(node.getAttribute('x'), 10) * viewport.scale);\n\t    node.setAttribute('y', parseInt(node.getAttribute('y'), 10) * viewport.scale);\n\t\n\t    var x = parseInt(node.getAttribute('x', 10));\n\t    var y = parseInt(node.getAttribute('y', 10));\n\t    var width = parseInt(node.getAttribute('width'), 10);\n\t    var height = parseInt(node.getAttribute('height'), 10);\n\t    var path = node.querySelector('path');\n\t    var svg = path.parentNode;\n\t\n\t    // Scale width/height\n\t    [node, svg, path, node.querySelector('rect')].forEach(function (n) {\n\t      n.setAttribute('width', parseInt(n.getAttribute('width'), 10) * viewport.scale);\n\t      n.setAttribute('height', parseInt(n.getAttribute('height'), 10) * viewport.scale);\n\t    });\n\t\n\t    // Transform path but keep scale at 100% since it will be handled natively\n\t    transform(path, (0, _objectAssign2.default)({}, viewport, { scale: 1 }));\n\t\n\t    switch (viewport.rotation % 360) {\n\t      case 90:\n\t        node.setAttribute('x', viewport.width - y - width);\n\t        node.setAttribute('y', x);\n\t        svg.setAttribute('x', 1);\n\t        svg.setAttribute('y', 0);\n\t        break;\n\t      case 180:\n\t        node.setAttribute('x', viewport.width - x - width);\n\t        node.setAttribute('y', viewport.height - y - height);\n\t        svg.setAttribute('y', 2);\n\t        break;\n\t      case 270:\n\t        node.setAttribute('x', y);\n\t        node.setAttribute('y', viewport.height - x - height);\n\t        svg.setAttribute('x', -1);\n\t        svg.setAttribute('y', 0);\n\t        break;\n\t    }\n\t  }\n\t\n\t  return node;\n\t}\n\t\n\t/**\n\t * Append an annotation as a child of an SVG.\n\t *\n\t * @param {SVGElement} svg The SVG element to append the annotation to\n\t * @param {Object} annotation The annotation definition to render and append\n\t * @param {Object} viewport The page's viewport data\n\t * @return {SVGElement} A node that was created and appended by this function\n\t */\n\tfunction appendChild(svg, annotation, viewport) {\n\t  if (!viewport) {\n\t    viewport = JSON.parse(svg.getAttribute('data-pdf-annotate-viewport'));\n\t  }\n\t\n\t  var child = void 0;\n\t  switch (annotation.type) {\n\t    case 'area':\n\t    case 'highlight':\n\t      child = (0, _renderRect2.default)(annotation);\n\t      break;\n\t    case 'strikeout':\n\t      child = (0, _renderLine2.default)(annotation);\n\t      break;\n\t    case 'point':\n\t      child = (0, _renderPoint2.default)(annotation);\n\t      break;\n\t    case 'textbox':\n\t      child = (0, _renderText2.default)(annotation);\n\t      break;\n\t    case 'drawing':\n\t      child = (0, _renderPath2.default)(annotation);\n\t      break;\n\t  }\n\t\n\t  // If no type was provided for an annotation it will result in node being null.\n\t  // Skip appending/transforming if node doesn't exist.\n\t  if (child) {\n\t    // Set attributes\n\t    child.setAttribute('data-pdf-annotate-id', annotation.uuid);\n\t    child.setAttribute('data-pdf-annotate-type', annotation.type);\n\t    child.setAttribute('aria-hidden', true);\n\t\n\t    svg.appendChild(transform(child, viewport));\n\t  }\n\t\n\t  return child;\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 12 */\n/***/ function(module, exports) {\n\n\t/*\n\tobject-assign\n\t(c) Sindre Sorhus\n\t@license MIT\n\t*/\n\t\n\t'use strict';\n\t/* eslint-disable no-unused-vars */\n\tvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\n\tvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\tvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\t\n\tfunction toObject(val) {\n\t\tif (val === null || val === undefined) {\n\t\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t\t}\n\t\n\t\treturn Object(val);\n\t}\n\t\n\tfunction shouldUseNative() {\n\t\ttry {\n\t\t\tif (!Object.assign) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\t// Detect buggy property enumeration order in older V8 versions.\n\t\n\t\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\t\ttest1[5] = 'de';\n\t\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\t\tvar test2 = {};\n\t\t\tfor (var i = 0; i < 10; i++) {\n\t\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t\t}\n\t\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\t\treturn test2[n];\n\t\t\t});\n\t\t\tif (order2.join('') !== '0123456789') {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\t\tvar test3 = {};\n\t\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\t\ttest3[letter] = letter;\n\t\t\t});\n\t\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\treturn true;\n\t\t} catch (err) {\n\t\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\tmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\t\tvar from;\n\t\tvar to = toObject(target);\n\t\tvar symbols;\n\t\n\t\tfor (var s = 1; s < arguments.length; s++) {\n\t\t\tfrom = Object(arguments[s]);\n\t\n\t\t\tfor (var key in from) {\n\t\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\t\tto[key] = from[key];\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tif (getOwnPropertySymbols) {\n\t\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\t\treturn to;\n\t};\n\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = renderLine;\n\t\n\tvar _setAttributes = __webpack_require__(14);\n\t\n\tvar _setAttributes2 = _interopRequireDefault(_setAttributes);\n\t\n\tvar _normalizeColor = __webpack_require__(15);\n\t\n\tvar _normalizeColor2 = _interopRequireDefault(_normalizeColor);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\n\t * Create SVGLineElements from an annotation definition.\n\t * This is used for anntations of type `strikeout`.\n\t *\n\t * @param {Object} a The annotation definition\n\t * @return {SVGGElement} A group of all lines to be rendered\n\t */\n\tfunction renderLine(a) {\n\t  var group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n\t  (0, _setAttributes2.default)(group, {\n\t    stroke: (0, _normalizeColor2.default)(a.color || '#f00'),\n\t    strokeWidth: 1\n\t  });\n\t\n\t  a.rectangles.forEach(function (r) {\n\t    var line = document.createElementNS('http://www.w3.org/2000/svg', 'line');\n\t\n\t    (0, _setAttributes2.default)(line, {\n\t      x1: r.x,\n\t      y1: r.y,\n\t      x2: r.x + r.width,\n\t      y2: r.y\n\t    });\n\t\n\t    group.appendChild(line);\n\t  });\n\t\n\t  return group;\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 14 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = setAttributes;\n\tvar UPPER_REGEX = /[A-Z]/g;\n\t\n\t// Don't convert these attributes from camelCase to hyphenated-attributes\n\tvar BLACKLIST = ['viewBox'];\n\t\n\tvar keyCase = function keyCase(key) {\n\t  if (BLACKLIST.indexOf(key) === -1) {\n\t    key = key.replace(UPPER_REGEX, function (match) {\n\t      return '-' + match.toLowerCase();\n\t    });\n\t  }\n\t  return key;\n\t};\n\t\n\t/**\n\t * Set attributes for a node from a map\n\t *\n\t * @param {Node} node The node to set attributes on\n\t * @param {Object} attributes The map of key/value pairs to use for attributes\n\t */\n\tfunction setAttributes(node, attributes) {\n\t  Object.keys(attributes).forEach(function (key) {\n\t    node.setAttribute(keyCase(key), attributes[key]);\n\t  });\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 15 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = normalizeColor;\n\tvar REGEX_HASHLESS_HEX = /^([a-f0-9]{6}|[a-f0-9]{3})$/i;\n\t\n\t/**\n\t * Normalize a color value\n\t *\n\t * @param {String} color The color to normalize\n\t * @return {String}\n\t */\n\tfunction normalizeColor(color) {\n\t  if (REGEX_HASHLESS_HEX.test(color)) {\n\t    color = \"#\" + color;\n\t  }\n\t  return color;\n\t}\n\tmodule.exports = exports[\"default\"];\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = renderPath;\n\t\n\tvar _setAttributes = __webpack_require__(14);\n\t\n\tvar _setAttributes2 = _interopRequireDefault(_setAttributes);\n\t\n\tvar _normalizeColor = __webpack_require__(15);\n\t\n\tvar _normalizeColor2 = _interopRequireDefault(_normalizeColor);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\n\t * Create SVGPathElement from an annotation definition.\n\t * This is used for anntations of type `drawing`.\n\t *\n\t * @param {Object} a The annotation definition\n\t * @return {SVGPathElement} The path to be rendered\n\t */\n\tfunction renderPath(a) {\n\t  var d = [];\n\t  var path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n\t\n\t  for (var i = 0, l = a.lines.length; i < l; i++) {\n\t    var p1 = a.lines[i];\n\t    var p2 = a.lines[i + 1];\n\t    if (p2) {\n\t      d.push('M' + p1[0] + ' ' + p1[1] + ' ' + p2[0] + ' ' + p2[1]);\n\t    }\n\t  }\n\t\n\t  (0, _setAttributes2.default)(path, {\n\t    d: d.join(' ') + 'Z',\n\t    stroke: (0, _normalizeColor2.default)(a.color || '#000'),\n\t    strokeWidth: a.width || 1,\n\t    fill: 'none'\n\t  });\n\t\n\t  return path;\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = renderPoint;\n\t\n\tvar _setAttributes = __webpack_require__(14);\n\t\n\tvar _setAttributes2 = _interopRequireDefault(_setAttributes);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar SIZE = 25;\n\tvar D = 'M499.968 214.336q-113.832 0 -212.877 38.781t-157.356 104.625 -58.311 142.29q0 62.496 39.897 119.133t112.437 97.929l48.546 27.9 -15.066 53.568q-13.392 50.778 -39.06 95.976 84.816 -35.154 153.45 -95.418l23.994 -21.204 31.806 3.348q38.502 4.464 72.54 4.464 113.832 0 212.877 -38.781t157.356 -104.625 58.311 -142.29 -58.311 -142.29 -157.356 -104.625 -212.877 -38.781z';\n\t\n\t/**\n\t * Create SVGElement from an annotation definition.\n\t * This is used for anntations of type `comment`.\n\t *\n\t * @param {Object} a The annotation definition\n\t * @return {SVGElement} A svg to be rendered\n\t */\n\tfunction renderPoint(a) {\n\t  var outerSVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n\t  var innerSVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n\t  var rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n\t  var path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n\t\n\t  (0, _setAttributes2.default)(outerSVG, {\n\t    width: SIZE,\n\t    height: SIZE,\n\t    x: a.x,\n\t    y: a.y\n\t  });\n\t\n\t  (0, _setAttributes2.default)(innerSVG, {\n\t    width: SIZE,\n\t    height: SIZE,\n\t    x: 0,\n\t    y: SIZE * 0.05 * -1,\n\t    viewBox: '0 0 1000 1000'\n\t  });\n\t\n\t  (0, _setAttributes2.default)(rect, {\n\t    width: SIZE,\n\t    height: SIZE,\n\t    stroke: '#000',\n\t    fill: '#ff0'\n\t  });\n\t\n\t  (0, _setAttributes2.default)(path, {\n\t    d: D,\n\t    strokeWidth: 50,\n\t    stroke: '#000',\n\t    fill: '#fff'\n\t  });\n\t\n\t  innerSVG.appendChild(path);\n\t  outerSVG.appendChild(rect);\n\t  outerSVG.appendChild(innerSVG);\n\t\n\t  return outerSVG;\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 18 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = renderRect;\n\t\n\tvar _setAttributes = __webpack_require__(14);\n\t\n\tvar _setAttributes2 = _interopRequireDefault(_setAttributes);\n\t\n\tvar _normalizeColor = __webpack_require__(15);\n\t\n\tvar _normalizeColor2 = _interopRequireDefault(_normalizeColor);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\n\t * Create SVGRectElements from an annotation definition.\n\t * This is used for anntations of type `area` and `highlight`.\n\t *\n\t * @param {Object} a The annotation definition\n\t * @return {SVGGElement|SVGRectElement} A group of all rects to be rendered\n\t */\n\tfunction renderRect(a) {\n\t  if (a.type === 'highlight') {\n\t    var group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n\t    (0, _setAttributes2.default)(group, {\n\t      fill: (0, _normalizeColor2.default)(a.color || '#ff0'),\n\t      fillOpacity: 0.2\n\t    });\n\t\n\t    a.rectangles.forEach(function (r) {\n\t      group.appendChild(createRect(r));\n\t    });\n\t\n\t    return group;\n\t  } else {\n\t    var rect = createRect(a);\n\t    (0, _setAttributes2.default)(rect, {\n\t      stroke: (0, _normalizeColor2.default)(a.color || '#f00'),\n\t      fill: 'none'\n\t    });\n\t\n\t    return rect;\n\t  }\n\t}\n\t\n\tfunction createRect(r) {\n\t  var rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n\t\n\t  (0, _setAttributes2.default)(rect, {\n\t    x: r.x,\n\t    y: r.y,\n\t    width: r.width,\n\t    height: r.height\n\t  });\n\t\n\t  return rect;\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 19 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = renderText;\n\t\n\tvar _setAttributes = __webpack_require__(14);\n\t\n\tvar _setAttributes2 = _interopRequireDefault(_setAttributes);\n\t\n\tvar _normalizeColor = __webpack_require__(15);\n\t\n\tvar _normalizeColor2 = _interopRequireDefault(_normalizeColor);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\n\t * Create SVGTextElement from an annotation definition.\n\t * This is used for anntations of type `textbox`.\n\t *\n\t * @param {Object} a The annotation definition\n\t * @return {SVGTextElement} A text to be rendered\n\t */\n\tfunction renderText(a) {\n\t  var text = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n\t\n\t  (0, _setAttributes2.default)(text, {\n\t    x: a.x,\n\t    y: a.y + parseInt(a.size, 10),\n\t    fill: (0, _normalizeColor2.default)(a.color || '#000'),\n\t    fontSize: a.size\n\t  });\n\t  text.innerHTML = a.content;\n\t\n\t  return text;\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 20 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = renderScreenReaderHints;\n\t\n\tvar _insertScreenReaderHint = __webpack_require__(21);\n\t\n\tvar _insertScreenReaderHint2 = _interopRequireDefault(_insertScreenReaderHint);\n\t\n\tvar _initEventHandlers = __webpack_require__(27);\n\t\n\tvar _initEventHandlers2 = _interopRequireDefault(_initEventHandlers);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t// TODO This is not the right place for this to live\n\t(0, _initEventHandlers2.default)();\n\t\n\t/**\n\t * Insert hints into the DOM for screen readers.\n\t *\n\t * @param {Array} annotations The annotations that hints are inserted for\n\t */\n\tfunction renderScreenReaderHints(annotations) {\n\t  annotations = Array.isArray(annotations) ? annotations : [];\n\t\n\t  // Insert hints for each type\n\t  Object.keys(SORT_TYPES).forEach(function (type) {\n\t    var sortBy = SORT_TYPES[type];\n\t    annotations.filter(function (a) {\n\t      return a.type === type;\n\t    }).sort(sortBy).forEach(function (a, i) {\n\t      return (0, _insertScreenReaderHint2.default)(a, i + 1);\n\t    });\n\t  });\n\t}\n\t\n\t// Sort annotations first by y, then by x.\n\t// This allows hints to be injected in the order they appear,\n\t// which makes numbering them easier.\n\tfunction sortByPoint(a, b) {\n\t  if (a.y < b.y) {\n\t    return a.x - b.x;\n\t  } else {\n\t    return 1;\n\t  }\n\t}\n\t\n\t// Sort annotation by it's first rectangle\n\tfunction sortByRectPoint(a, b) {\n\t  return sortByPoint(a.rectangles[0], b.rectangles[0]);\n\t}\n\t\n\t// Sort annotation by it's first line\n\tfunction sortByLinePoint(a, b) {\n\t  var lineA = a.lines[0];\n\t  var lineB = b.lines[0];\n\t  return sortByPoint({ x: lineA[0], y: lineA[1] }, { x: lineB[0], y: lineB[1] });\n\t}\n\t\n\t// Arrange supported types and associated sort methods\n\tvar SORT_TYPES = {\n\t  'highlight': sortByRectPoint,\n\t  'strikeout': sortByRectPoint,\n\t  'drawing': sortByLinePoint,\n\t  'textbox': sortByPoint,\n\t  'point': sortByPoint,\n\t  'area': sortByPoint\n\t};\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 21 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = insertScreenReaderHint;\n\t\n\tvar _createScreenReaderOnly = __webpack_require__(22);\n\t\n\tvar _createScreenReaderOnly2 = _interopRequireDefault(_createScreenReaderOnly);\n\t\n\tvar _insertElementWithinChildren = __webpack_require__(23);\n\t\n\tvar _insertElementWithinChildren2 = _interopRequireDefault(_insertElementWithinChildren);\n\t\n\tvar _insertElementWithinElement = __webpack_require__(24);\n\t\n\tvar _insertElementWithinElement2 = _interopRequireDefault(_insertElementWithinElement);\n\t\n\tvar _renderScreenReaderComments = __webpack_require__(25);\n\t\n\tvar _renderScreenReaderComments2 = _interopRequireDefault(_renderScreenReaderComments);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t// Annotation types that support comments\n\tvar COMMENT_TYPES = ['highlight', 'point', 'area', 'drawing', 'strikeout'];\n\t\n\t/**\n\t * Insert a hint into the DOM for screen readers for a specific annotation.\n\t *\n\t * @param {Object} annotation The annotation to insert a hint for\n\t * @param {Number} num The number of the annotation out of all annotations of the same type\n\t */\n\tfunction insertScreenReaderHint(annotation) {\n\t  var num = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\t\n\t  switch (annotation.type) {\n\t    case 'highlight':\n\t    case 'strikeout':\n\t      var rects = annotation.rectangles;\n\t      var first = rects[0];\n\t      var last = rects[rects.length - 1];\n\t\n\t      (0, _insertElementWithinElement2.default)((0, _createScreenReaderOnly2.default)('Begin ' + annotation.type + ' annotation ' + num, annotation.uuid), first.x, first.y, annotation.page, true);\n\t\n\t      (0, _insertElementWithinElement2.default)((0, _createScreenReaderOnly2.default)('End ' + annotation.type + ' annotation ' + num, annotation.uuid + '-end'), last.x + last.width, last.y, annotation.page, false);\n\t      break;\n\t\n\t    case 'textbox':\n\t    case 'point':\n\t      var text = annotation.type === 'textbox' ? ' (content: ' + annotation.content + ')' : '';\n\t\n\t      (0, _insertElementWithinChildren2.default)((0, _createScreenReaderOnly2.default)(annotation.type + ' annotation ' + num + text, annotation.uuid), annotation.x, annotation.y, annotation.page);\n\t      break;\n\t\n\t    case 'drawing':\n\t    case 'area':\n\t      var x = typeof annotation.x !== 'undefined' ? annotation.x : annotation.lines[0][0];\n\t      var y = typeof annotation.y !== 'undefined' ? annotation.y : annotation.lines[0][1];\n\t\n\t      (0, _insertElementWithinChildren2.default)((0, _createScreenReaderOnly2.default)('Unlabeled drawing', annotation.uuid), x, y, annotation.page);\n\t      break;\n\t  }\n\t\n\t  // Include comments in screen reader hint\n\t  if (COMMENT_TYPES.includes(annotation.type)) {\n\t    (0, _renderScreenReaderComments2.default)(annotation.documentId, annotation.uuid);\n\t  }\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 22 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = createScreenReaderOnly;\n\t/**\n\t * Create a node that is only visible to screen readers\n\t *\n\t * @param {String} content The text content that should be read by screen reader\n\t * @param {String} [annotationId] The ID of the annotation assocaited\n\t * @return {Element} An Element that is only visible to screen readers\n\t */\n\tfunction createScreenReaderOnly(content, annotationId) {\n\t  var node = document.createElement('div');\n\t  var text = document.createTextNode(content);\n\t  node.appendChild(text);\n\t  node.setAttribute('id', 'pdf-annotate-screenreader-' + annotationId);\n\t  node.style.position = 'absolute';\n\t  node.style.left = '-10000px';\n\t  node.style.top = 'auto';\n\t  node.style.width = '1px';\n\t  node.style.height = '1px';\n\t  node.style.overflow = 'hidden';\n\t  return node;\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 23 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = insertElementWithinChildren;\n\t\n\tvar _insertElementWithinElement = __webpack_require__(24);\n\t\n\tvar _insertElementWithinElement2 = _interopRequireDefault(_insertElementWithinElement);\n\t\n\tvar _utils = __webpack_require__(6);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\t/**\n\t * Insert an element at a point within the document.\n\t * This algorithm will try to insert between elements if possible.\n\t * It will however use `insertElementWithinElement` if it is more accurate.\n\t *\n\t * @param {Element} el The element to be inserted\n\t * @param {Number} x The x coordinate of the point\n\t * @param {Number} y The y coordinate of the point\n\t * @param {Number} pageNumber The page number to limit elements to\n\t * @return {Boolean} True if element was able to be inserted, otherwise false\n\t */\n\tfunction insertElementWithinChildren(el, x, y, pageNumber) {\n\t  // Try and use most accurate method of inserting within an element\n\t  if ((0, _insertElementWithinElement2.default)(el, x, y, pageNumber, true)) {\n\t    return true;\n\t  }\n\t\n\t  // Fall back to inserting between elements\n\t  var svg = document.querySelector('svg[data-pdf-annotate-page=\"' + pageNumber + '\"]');\n\t  var rect = svg.getBoundingClientRect();\n\t  var nodes = [].concat(_toConsumableArray(svg.parentNode.querySelectorAll('.textLayer > div')));\n\t\n\t  y = (0, _utils.scaleUp)(svg, { y: y }).y + rect.top;\n\t  x = (0, _utils.scaleUp)(svg, { x: x }).x + rect.left;\n\t\n\t  // Find the best node to insert before\n\t  for (var i = 0, l = nodes.length; i < l; i++) {\n\t    var n = nodes[i];\n\t    var r = n.getBoundingClientRect();\n\t    if (y <= r.top) {\n\t      n.parentNode.insertBefore(el, n);\n\t      return true;\n\t    }\n\t  }\n\t\n\t  // If all else fails try to append to the bottom\n\t  var textLayer = svg.parentNode.querySelector('.textLayer');\n\t  if (textLayer) {\n\t    var textRect = textLayer.getBoundingClientRect();\n\t    if ((0, _utils.pointIntersectsRect)(x, y, textRect)) {\n\t      textLayer.appendChild(el);\n\t      return true;\n\t    }\n\t  }\n\t\n\t  return false;\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 24 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = insertElementWithinElement;\n\t\n\tvar _utils = __webpack_require__(6);\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\t/**\n\t * Insert an element at a point within the document.\n\t * This algorithm will only insert within an element amidst it's text content.\n\t *\n\t * @param {Element} el The element to be inserted\n\t * @param {Number} x The x coordinate of the point\n\t * @param {Number} y The y coordinate of the point\n\t * @param {Number} pageNumber The page number to limit elements to\n\t * @param {Boolean} insertBefore Whether the element is to be inserted before or after x\n\t * @return {Boolean} True if element was able to be inserted, otherwise false\n\t */\n\tfunction insertElementWithinElement(el, x, y, pageNumber, insertBefore) {\n\t  var OFFSET_ADJUST = 2;\n\t\n\t  // If inserting before adjust `x` by looking for element a few px to the right\n\t  // Otherwise adjust a few px to the left\n\t  // This is to allow a little tolerance by searching within the box, instead\n\t  // of getting a false negative by testing right on the border.\n\t  x = Math.max(x + OFFSET_ADJUST * (insertBefore ? 1 : -1), 0);\n\t\n\t  var node = textLayerElementFromPoint(x, y + OFFSET_ADJUST, pageNumber);\n\t  if (!node) {\n\t    return false;\n\t  }\n\t\n\t  // Now that node has been found inverse the adjustment for `x`.\n\t  // This is done to accomodate tolerance by cutting off on the outside of the\n\t  // text boundary, instead of missing a character by cutting off within.\n\t  x = x + OFFSET_ADJUST * (insertBefore ? -1 : 1);\n\t\n\t  var svg = document.querySelector('svg[data-pdf-annotate-page=\"' + pageNumber + '\"]');\n\t  var left = (0, _utils.scaleDown)(svg, { left: node.getBoundingClientRect().left }).left - svg.getBoundingClientRect().left;\n\t  var temp = node.cloneNode(true);\n\t  var head = temp.innerHTML.split('');\n\t  var tail = [];\n\t\n\t  // Insert temp off screen\n\t  temp.style.position = 'absolute';\n\t  temp.style.top = '-10000px';\n\t  temp.style.left = '-10000px';\n\t  document.body.appendChild(temp);\n\t\n\t  while (head.length) {\n\t    // Don't insert within HTML tags\n\t    if (head[head.length - 1] === '>') {\n\t      while (head.length) {\n\t        tail.unshift(head.pop());\n\t        if (tail[0] === '<') {\n\t          break;\n\t        }\n\t      }\n\t    }\n\t\n\t    // Check if width of temp based on current head value satisfies x\n\t    temp.innerHTML = head.join('');\n\t    var width = (0, _utils.scaleDown)(svg, { width: temp.getBoundingClientRect().width }).width;\n\t    if (left + width <= x) {\n\t      break;\n\t    }\n\t    tail.unshift(head.pop());\n\t  }\n\t\n\t  // Update original node with new markup, including element to be inserted\n\t  node.innerHTML = head.join('') + el.outerHTML + tail.join('');\n\t  temp.parentNode.removeChild(temp);\n\t\n\t  return true;\n\t}\n\t\n\t/**\n\t * Get a text layer element at a given point on a page\n\t *\n\t * @param {Number} x The x coordinate of the point\n\t * @param {Number} y The y coordinate of the point\n\t * @param {Number} pageNumber The page to limit elements to\n\t * @return {Element} First text layer element found at the point\n\t */\n\tfunction textLayerElementFromPoint(x, y, pageNumber) {\n\t  var svg = document.querySelector('svg[data-pdf-annotate-page=\"' + pageNumber + '\"]');\n\t  var rect = svg.getBoundingClientRect();\n\t  y = (0, _utils.scaleUp)(svg, { y: y }).y + rect.top;\n\t  x = (0, _utils.scaleUp)(svg, { x: x }).x + rect.left;\n\t  return [].concat(_toConsumableArray(svg.parentNode.querySelectorAll('.textLayer [data-canvas-width]'))).filter(function (el) {\n\t    return (0, _utils.pointIntersectsRect)(x, y, el.getBoundingClientRect());\n\t  })[0];\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 25 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = renderScreenReaderComments;\n\t\n\tvar _PDFJSAnnotate = __webpack_require__(1);\n\t\n\tvar _PDFJSAnnotate2 = _interopRequireDefault(_PDFJSAnnotate);\n\t\n\tvar _insertScreenReaderComment = __webpack_require__(26);\n\t\n\tvar _insertScreenReaderComment2 = _interopRequireDefault(_insertScreenReaderComment);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\n\t * Insert the comments into the DOM to be available by screen reader\n\t *\n\t * Example output:\n\t *   <div class=\"screenReaderOnly\">\n\t *    <div>Begin highlight 1</div>\n\t *    <ol aria-label=\"Comments\">\n\t *      <li>Foo</li>\n\t *      <li>Bar</li>\n\t *      <li>Baz</li>\n\t *      <li>Qux</li>\n\t *    </ol>\n\t *  </div>\n\t *  <div>Some highlighted text goes here...</div>\n\t *  <div class=\"screenReaderOnly\">End highlight 1</div>\n\t *\n\t * NOTE: `screenReaderOnly` is not a real class, just used for brevity\n\t *\n\t * @param {String} documentId The ID of the document\n\t * @param {String} annotationId The ID of the annotation\n\t * @param {Array} [comments] Optionally preloaded comments to be rendered\n\t * @return {Promise}\n\t */\n\tfunction renderScreenReaderComments(documentId, annotationId, comments) {\n\t  var promise = void 0;\n\t\n\t  if (Array.isArray(comments)) {\n\t    promise = Promise.resolve(comments);\n\t  } else {\n\t    promise = _PDFJSAnnotate2.default.getStoreAdapter().getComments(documentId, annotationId);\n\t  }\n\t\n\t  return promise.then(function (comments) {\n\t    // Node needs to be found by querying DOM as it may have been inserted as innerHTML\n\t    // leaving `screenReaderNode` as an invalid reference (see `insertElementWithinElement`).\n\t    var node = document.getElementById('pdf-annotate-screenreader-' + annotationId);\n\t    if (node) {\n\t      var list = document.createElement('ol');\n\t      list.setAttribute('id', 'pdf-annotate-screenreader-comment-list-' + annotationId);\n\t      list.setAttribute('aria-label', 'Comments');\n\t      node.appendChild(list);\n\t      comments.forEach(_insertScreenReaderComment2.default);\n\t    }\n\t  });\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 26 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = insertScreenReaderComment;\n\t/**\n\t * Insert a comment into the DOM to be available by screen reader\n\t *\n\t * @param {Object} comment The comment to be inserted\n\t */\n\tfunction insertScreenReaderComment(comment) {\n\t  if (!comment) {\n\t    return;\n\t  }\n\t\n\t  var list = document.querySelector('#pdf-annotate-screenreader-' + comment.annotation + ' ol');\n\t  if (list) {\n\t    var item = document.createElement('li');\n\t    item.setAttribute('id', 'pdf-annotate-screenreader-comment-' + comment.uuid);\n\t    item.appendChild(document.createTextNode('' + comment.content));\n\t    list.appendChild(item);\n\t  }\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 27 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = initEventHandlers;\n\t\n\tvar _insertScreenReaderHint = __webpack_require__(21);\n\t\n\tvar _insertScreenReaderHint2 = _interopRequireDefault(_insertScreenReaderHint);\n\t\n\tvar _renderScreenReaderHints = __webpack_require__(20);\n\t\n\tvar _renderScreenReaderHints2 = _interopRequireDefault(_renderScreenReaderHints);\n\t\n\tvar _insertScreenReaderComment = __webpack_require__(26);\n\t\n\tvar _insertScreenReaderComment2 = _interopRequireDefault(_insertScreenReaderComment);\n\t\n\tvar _renderScreenReaderComments = __webpack_require__(25);\n\t\n\tvar _renderScreenReaderComments2 = _interopRequireDefault(_renderScreenReaderComments);\n\t\n\tvar _event = __webpack_require__(4);\n\t\n\tvar _PDFJSAnnotate = __webpack_require__(1);\n\t\n\tvar _PDFJSAnnotate2 = _interopRequireDefault(_PDFJSAnnotate);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\n\t * Initialize the event handlers for keeping screen reader hints synced with data\n\t */\n\tfunction initEventHandlers() {\n\t  (0, _event.addEventListener)('annotation:add', function (documentId, pageNumber, annotation) {\n\t    reorderAnnotationsByType(documentId, pageNumber, annotation.type);\n\t  });\n\t  (0, _event.addEventListener)('annotation:edit', function (documentId, annotationId, annotation) {\n\t    reorderAnnotationsByType(documentId, annotation.page, annotation.type);\n\t  });\n\t  (0, _event.addEventListener)('annotation:delete', removeAnnotation);\n\t  (0, _event.addEventListener)('comment:add', insertComment);\n\t  (0, _event.addEventListener)('comment:delete', removeComment);\n\t}\n\t\n\t/**\n\t * Reorder the annotation numbers by annotation type\n\t *\n\t * @param {String} documentId The ID of the document\n\t * @param {Number} pageNumber The page number of the annotations\n\t * @param {Strig} type The annotation type\n\t */\n\tfunction reorderAnnotationsByType(documentId, pageNumber, type) {\n\t  _PDFJSAnnotate2.default.getStoreAdapter().getAnnotations(documentId, pageNumber).then(function (annotations) {\n\t    return annotations.annotations.filter(function (a) {\n\t      return a.type === type;\n\t    });\n\t  }).then(function (annotations) {\n\t    annotations.forEach(function (a) {\n\t      removeAnnotation(documentId, a.uuid);\n\t    });\n\t\n\t    return annotations;\n\t  }).then(_renderScreenReaderHints2.default);\n\t}\n\t\n\t/**\n\t * Remove the screen reader hint for an annotation\n\t *\n\t * @param {String} documentId The ID of the document\n\t * @param {String} annotationId The Id of the annotation\n\t */\n\tfunction removeAnnotation(documentId, annotationId) {\n\t  removeElementById('pdf-annotate-screenreader-' + annotationId);\n\t  removeElementById('pdf-annotate-screenreader-' + annotationId + '-end');\n\t}\n\t\n\t/**\n\t * Insert a screen reader hint for a comment\n\t *\n\t * @param {String} documentId The ID of the document\n\t * @param {String} annotationId The ID of tha assocated annotation\n\t * @param {Object} comment The comment to insert a hint for\n\t */\n\tfunction insertComment(documentId, annotationId, comment) {\n\t  var list = document.querySelector('pdf-annotate-screenreader-comment-list-' + annotationId);\n\t  var promise = void 0;\n\t\n\t  if (!list) {\n\t    promise = (0, _renderScreenReaderComments2.default)(documentId, annotationId, []).then(function () {\n\t      list = document.querySelector('pdf-annotate-screenreader-comment-list-' + annotationId);\n\t      return true;\n\t    });\n\t  } else {\n\t    promise = Promise.resolve(true);\n\t  }\n\t\n\t  promise.then(function () {\n\t    (0, _insertScreenReaderComment2.default)(comment);\n\t  });\n\t}\n\t\n\t/**\n\t * Remove a screen reader hint for a comment\n\t *\n\t * @param {String} documentId The ID of the document\n\t * @param {String} commentId The ID of the comment\n\t */\n\tfunction removeComment(documentId, commentId) {\n\t  removeElementById('pdf-annotate-screenreader-comment-' + commentId);\n\t}\n\t\n\t/**\n\t * Remove an element from the DOM by it's ID if it exists\n\t *\n\t * @param {String} elementID The ID of the element to be removed\n\t */\n\tfunction removeElementById(elementId) {\n\t  var el = document.getElementById(elementId);\n\t  if (el) {\n\t    el.parentNode.removeChild(el);\n\t  }\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 28 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _event = __webpack_require__(4);\n\t\n\tvar _edit = __webpack_require__(29);\n\t\n\tvar _pen = __webpack_require__(30);\n\t\n\tvar _point = __webpack_require__(31);\n\t\n\tvar _rect = __webpack_require__(32);\n\t\n\tvar _text = __webpack_require__(33);\n\t\n\tvar _page = __webpack_require__(34);\n\t\n\texports.default = {\n\t  addEventListener: _event.addEventListener, removeEventListener: _event.removeEventListener, fireEvent: _event.fireEvent,\n\t  disableEdit: _edit.disableEdit, enableEdit: _edit.enableEdit, setCanEdit: _edit.setCanEdit,\n\t  disablePen: _pen.disablePen, enablePen: _pen.enablePen, setPen: _pen.setPen,\n\t  disablePoint: _point.disablePoint, enablePoint: _point.enablePoint,\n\t  disableRect: _rect.disableRect, enableRect: _rect.enableRect,\n\t  disableText: _text.disableText, enableText: _text.enableText, setText: _text.setText,\n\t  createPage: _page.createPage, renderPage: _page.renderPage\n\t};\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 29 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\texports.setCanEdit = setCanEdit;\n\texports.enableEdit = enableEdit;\n\texports.disableEdit = disableEdit;\n\t\n\tvar _PDFJSAnnotate = __webpack_require__(1);\n\t\n\tvar _PDFJSAnnotate2 = _interopRequireDefault(_PDFJSAnnotate);\n\t\n\tvar _appendChild = __webpack_require__(11);\n\t\n\tvar _appendChild2 = _interopRequireDefault(_appendChild);\n\t\n\tvar _event = __webpack_require__(4);\n\t\n\tvar _utils = __webpack_require__(6);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tvar _enabled = false;\n\tvar _canEdit = true;\n\tvar isDragging = false,\n\t    overlay = void 0;\n\tvar dragOffsetX = void 0,\n\t    dragOffsetY = void 0,\n\t    dragStartX = void 0,\n\t    dragStartY = void 0;\n\tvar OVERLAY_BORDER_SIZE = 3;\n\t\n\t/**\n\t * Create an overlay for editing an annotation.\n\t *\n\t * @param {Element} target The annotation element to apply overlay for\n\t */\n\tfunction createEditOverlay(target) {\n\t\n\t  if (!target || !target.parentNode) {\n\t    return;\n\t  }\n\t\n\t  // check if we are clicking on same Annotation, and if yes, exit early\n\t  if (overlay) {\n\t\n\t    var overlayId = overlay.getAttribute('data-target-id');\n\t    var targetId = target.getAttribute('data-pdf-annotate-id');\n\t\n\t    if (overlayId === targetId) {\n\t      return;\n\t    }\n\t  }\n\t\n\t  destroyEditOverlay();\n\t\n\t  overlay = document.createElement('div');\n\t  var anchor = document.createElement('a');\n\t  var parentNode = (0, _utils.findSVGContainer)(target).parentNode;\n\t  var id = target.getAttribute('data-pdf-annotate-id');\n\t  var rect = (0, _utils.getAnnotationRect)(target);\n\t  var styleLeft = rect.left - OVERLAY_BORDER_SIZE;\n\t  var styleTop = rect.top - OVERLAY_BORDER_SIZE;\n\t\n\t  overlay.setAttribute('id', 'pdf-annotate-edit-overlay');\n\t  overlay.setAttribute('data-target-id', id);\n\t  overlay.style.boxSizing = 'content-box';\n\t  overlay.style.position = 'absolute';\n\t  overlay.style.top = styleTop + 'px';\n\t  overlay.style.left = styleLeft + 'px';\n\t  overlay.style.width = rect.width + 'px';\n\t  overlay.style.height = rect.height + 'px';\n\t  overlay.style.border = OVERLAY_BORDER_SIZE + 'px solid ' + _utils.BORDER_COLOR;\n\t  overlay.style.borderRadius = OVERLAY_BORDER_SIZE + 'px';\n\t\n\t  if (_canEdit) {\n\t    anchor.innerHTML = '';\n\t    anchor.setAttribute('href', 'javascript://');\n\t    anchor.style.background = '#fff';\n\t    anchor.style.borderRadius = '20px';\n\t    anchor.style.border = '1px solid #bbb';\n\t    anchor.style.color = '#bbb';\n\t    anchor.style.fontSize = '16px';\n\t    anchor.style.padding = '2px';\n\t    anchor.style.textAlign = 'center';\n\t    anchor.style.textDecoration = 'none';\n\t    anchor.style.position = 'absolute';\n\t    anchor.style.top = '-13px';\n\t    anchor.style.right = '-13px';\n\t    anchor.style.width = '25px';\n\t    anchor.style.height = '25px';\n\t\n\t    overlay.appendChild(anchor);\n\t\n\t    document.addEventListener('click', handleDocumentClick);\n\t    document.addEventListener('keyup', handleDocumentKeyup);\n\t    document.addEventListener('mousedown', handleDocumentMousedown);\n\t    anchor.addEventListener('click', deleteAnnotation);\n\t    anchor.addEventListener('mouseover', function () {\n\t      anchor.style.color = '#35A4DC';\n\t      anchor.style.borderColor = '#999';\n\t      anchor.style.boxShadow = '0 1px 1px #ccc';\n\t    });\n\t    anchor.addEventListener('mouseout', function () {\n\t      anchor.style.color = '#bbb';\n\t      anchor.style.borderColor = '#bbb';\n\t      anchor.style.boxShadow = '';\n\t    });\n\t    overlay.addEventListener('mouseover', function () {\n\t      if (!isDragging) {\n\t        anchor.style.display = '';\n\t      }\n\t    });\n\t    overlay.addEventListener('mouseout', function () {\n\t      anchor.style.display = 'none';\n\t    });\n\t  }\n\t\n\t  parentNode.appendChild(overlay);\n\t}\n\t\n\t/**\n\t * Destroy the edit overlay if it exists.\n\t */\n\tfunction destroyEditOverlay() {\n\t\n\t  if (overlay && overlay.parentNode) {\n\t    overlay.parentNode.removeChild(overlay);\n\t  }\n\t  overlay = null;\n\t\n\t  document.removeEventListener('click', handleDocumentClick);\n\t  document.removeEventListener('keyup', handleDocumentKeyup);\n\t  document.removeEventListener('mousedown', handleDocumentMousedown);\n\t  document.removeEventListener('mousemove', handleDocumentMousemove);\n\t  document.removeEventListener('mouseup', handleDocumentMouseup);\n\t  (0, _utils.enableUserSelect)();\n\t}\n\t\n\t/**\n\t * Delete currently selected annotation\n\t */\n\tfunction deleteAnnotation() {\n\t  if (!overlay) {\n\t    return;\n\t  }\n\t\n\t  var annotationId = overlay.getAttribute('data-target-id');\n\t  var nodes = document.querySelectorAll('[data-pdf-annotate-id=\"' + annotationId + '\"]');\n\t  var svg = overlay.parentNode.querySelector('svg.annotationLayer');\n\t\n\t  var _getMetadata = (0, _utils.getMetadata)(svg),\n\t      documentId = _getMetadata.documentId;\n\t\n\t  [].concat(_toConsumableArray(nodes)).forEach(function (n) {\n\t    n.parentNode.removeChild(n);\n\t  });\n\t\n\t  _PDFJSAnnotate2.default.getStoreAdapter().deleteAnnotation(documentId, annotationId);\n\t\n\t  destroyEditOverlay();\n\t}\n\t\n\t/**\n\t * Handle document.click event\n\t *\n\t * @param {Event} e The DOM event that needs to be handled\n\t */\n\tfunction handleDocumentClick(e) {\n\t  if (!(0, _utils.findSVGAtPoint)(e.clientX, e.clientY)) {\n\t    return;\n\t  }\n\t\n\t  // Remove current overlay\n\t  var overlay = document.getElementById('pdf-annotate-edit-overlay');\n\t  if (overlay) {\n\t    if (isDragging || e.target === overlay) {\n\t      return;\n\t    }\n\t\n\t    destroyEditOverlay();\n\t  }\n\t}\n\t\n\t/**\n\t * Handle document.keyup event\n\t *\n\t * @param {Event} e The DOM event that needs to be handled\n\t */\n\tfunction handleDocumentKeyup(e) {\n\t  if (overlay && e.keyCode === 46 && e.target.nodeName.toLowerCase() !== 'textarea' && e.target.nodeName.toLowerCase() !== 'input') {\n\t    deleteAnnotation();\n\t  }\n\t}\n\t\n\t/**\n\t * Handle document.mousedown event\n\t *\n\t * @param {Event} e The DOM event that needs to be handled\n\t */\n\tfunction handleDocumentMousedown(e) {\n\t  if (e.target !== overlay) {\n\t    return;\n\t  }\n\t\n\t  // Highlight and strikeout annotations are bound to text within the document.\n\t  // It doesn't make sense to allow repositioning these types of annotations.\n\t  var annotationId = overlay.getAttribute('data-target-id');\n\t  var target = document.querySelector('[data-pdf-annotate-id=\"' + annotationId + '\"]');\n\t  var type = target.getAttribute('data-pdf-annotate-type');\n\t\n\t  if (type === 'highlight' || type === 'strikeout') {\n\t    return;\n\t  }\n\t\n\t  isDragging = true;\n\t  dragOffsetX = e.clientX;\n\t  dragOffsetY = e.clientY;\n\t  dragStartX = overlay.offsetLeft;\n\t  dragStartY = overlay.offsetTop;\n\t\n\t  overlay.style.background = 'rgba(255, 255, 255, 0.7)';\n\t  overlay.style.cursor = 'move';\n\t  overlay.querySelector('a').style.display = 'none';\n\t\n\t  document.addEventListener('mousemove', handleDocumentMousemove);\n\t  document.addEventListener('mouseup', handleDocumentMouseup);\n\t  (0, _utils.disableUserSelect)();\n\t}\n\t\n\t/**\n\t * Handle document.mousemove event\n\t *\n\t * @param {Event} e The DOM event that needs to be handled\n\t */\n\tfunction handleDocumentMousemove(e) {\n\t  var annotationId = overlay.getAttribute('data-target-id');\n\t  var parentNode = overlay.parentNode;\n\t  var rect = parentNode.getBoundingClientRect();\n\t  var y = dragStartY + (e.clientY - dragOffsetY);\n\t  var x = dragStartX + (e.clientX - dragOffsetX);\n\t  var minY = 0;\n\t  var maxY = rect.height;\n\t  var minX = 0;\n\t  var maxX = rect.width;\n\t\n\t  if (y > minY && y + overlay.offsetHeight < maxY) {\n\t    overlay.style.top = y + 'px';\n\t  }\n\t\n\t  if (x > minX && x + overlay.offsetWidth < maxX) {\n\t    overlay.style.left = x + 'px';\n\t  }\n\t}\n\t\n\t/**\n\t * Handle document.mouseup event\n\t *\n\t * @param {Event} e The DOM event that needs to be handled\n\t */\n\tfunction handleDocumentMouseup(e) {\n\t  var annotationId = overlay.getAttribute('data-target-id');\n\t  var target = document.querySelectorAll('[data-pdf-annotate-id=\"' + annotationId + '\"]');\n\t  var type = target[0].getAttribute('data-pdf-annotate-type');\n\t  var svg = overlay.parentNode.querySelector('svg.annotationLayer');\n\t\n\t  var _getMetadata2 = (0, _utils.getMetadata)(svg),\n\t      documentId = _getMetadata2.documentId;\n\t\n\t  overlay.querySelector('a').style.display = '';\n\t\n\t  function getDelta(propX, propY) {\n\t    return calcDelta(parseInt(target[0].getAttribute(propX), 10), parseInt(target[0].getAttribute(propY), 10));\n\t  }\n\t\n\t  function calcDelta(x, y) {\n\t    return {\n\t      deltaX: OVERLAY_BORDER_SIZE + (0, _utils.scaleDown)(svg, { x: overlay.offsetLeft }).x - x,\n\t      deltaY: OVERLAY_BORDER_SIZE + (0, _utils.scaleDown)(svg, { y: overlay.offsetTop }).y - y\n\t    };\n\t  }\n\t\n\t  _PDFJSAnnotate2.default.getStoreAdapter().getAnnotation(documentId, annotationId).then(function (annotation) {\n\t\n\t    // exit early if those are not present (happens with Spammy clicking)\n\t    if (!target || !svg || !target[0] || !target[0].parentNode) {\n\t      return;\n\t    }\n\t\n\t    if (['area', 'highlight', 'point', 'textbox', 'strikeout'].includes(type)) {\n\t      var _getDelta = getDelta('x', 'y'),\n\t          deltaX = _getDelta.deltaX,\n\t          deltaY = _getDelta.deltaY;\n\t\n\t      [].concat(_toConsumableArray(target)).forEach(function (t, i) {\n\t        if (deltaY !== 0) {\n\t          var modelY = parseInt(t.getAttribute('y'), 10) + deltaY;\n\t          var viewY = modelY;\n\t\n\t          if (type === 'textbox') {\n\t            viewY += annotation.size;\n\t          }\n\t\n\t          if (type === 'point') {\n\t            viewY = (0, _utils.scaleUp)(svg, { viewY: viewY }).viewY;\n\t          }\n\t\n\t          t.setAttribute('y', viewY);\n\t          if (annotation.rectangles) {\n\t            annotation.rectangles[i].y = modelY;\n\t          } else if (annotation.y) {\n\t            annotation.y = modelY;\n\t          }\n\t        }\n\t        if (deltaX !== 0) {\n\t          var modelX = parseInt(t.getAttribute('x'), 10) + deltaX;\n\t          var viewX = modelX;\n\t\n\t          if (type === 'point') {\n\t            viewX = (0, _utils.scaleUp)(svg, { viewX: viewX }).viewX;\n\t          }\n\t\n\t          t.setAttribute('x', viewX);\n\t          if (annotation.rectangles) {\n\t            annotation.rectangles[i].x = modelX;\n\t          } else if (annotation.x) {\n\t            annotation.x = modelX;\n\t          }\n\t        }\n\t\n\t        if (deltaX !== 0 || deltaY !== 0) {\n\t          _PDFJSAnnotate2.default.getStoreAdapter().editAnnotation(documentId, annotationId, annotation);\n\t        }\n\t      });\n\t      // } else if (type === 'strikeout') {\n\t      //   let { deltaX, deltaY } = getDelta('x1', 'y1');\n\t      //   [...target].forEach(target, (t, i) => {\n\t      //     if (deltaY !== 0) {\n\t      //       t.setAttribute('y1', parseInt(t.getAttribute('y1'), 10) + deltaY);\n\t      //       t.setAttribute('y2', parseInt(t.getAttribute('y2'), 10) + deltaY);\n\t      //       annotation.rectangles[i].y = parseInt(t.getAttribute('y1'), 10);\n\t      //     }\n\t      //     if (deltaX !== 0) {\n\t      //       t.setAttribute('x1', parseInt(t.getAttribute('x1'), 10) + deltaX);\n\t      //       t.setAttribute('x2', parseInt(t.getAttribute('x2'), 10) + deltaX);\n\t      //       annotation.rectangles[i].x = parseInt(t.getAttribute('x1'), 10);\n\t      //     }\n\t      //   });\n\t    } else if (type === 'drawing') {\n\t      var rect = (0, _utils.scaleDown)(svg, (0, _utils.getAnnotationRect)(target[0]));\n\t\n\t      var _annotation$lines$ = _slicedToArray(annotation.lines[0], 2),\n\t          originX = _annotation$lines$[0],\n\t          originY = _annotation$lines$[1];\n\t\n\t      var _calcDelta = calcDelta(originX, originY),\n\t          _deltaX = _calcDelta.deltaX,\n\t          _deltaY = _calcDelta.deltaY;\n\t\n\t      // origin isn't necessarily at 0/0 in relation to overlay x/y\n\t      // adjust the difference between overlay and drawing coords\n\t\n\t\n\t      _deltaY += originY - rect.top;\n\t      _deltaX += originX - rect.left;\n\t\n\t      annotation.lines.forEach(function (line, i) {\n\t        var _annotation$lines$i = _slicedToArray(annotation.lines[i], 2),\n\t            x = _annotation$lines$i[0],\n\t            y = _annotation$lines$i[1];\n\t\n\t        annotation.lines[i][0] = x + _deltaX;\n\t        annotation.lines[i][1] = y + _deltaY;\n\t      });\n\t\n\t      target[0].parentNode.removeChild(target[0]);\n\t      (0, _appendChild2.default)(svg, annotation);\n\t\n\t      if (_deltaX !== 0 || _deltaY !== 0) {\n\t        _PDFJSAnnotate2.default.getStoreAdapter().editAnnotation(documentId, annotationId, annotation);\n\t      }\n\t    }\n\t  });\n\t\n\t  setTimeout(function () {\n\t    isDragging = false;\n\t  }, 0);\n\t\n\t  overlay.style.background = '';\n\t  overlay.style.cursor = '';\n\t\n\t  document.removeEventListener('mousemove', handleDocumentMousemove);\n\t  document.removeEventListener('mouseup', handleDocumentMouseup);\n\t  (0, _utils.enableUserSelect)();\n\t}\n\t\n\t/**\n\t * Handle annotation.click event\n\t *\n\t * @param {Element} e The annotation element that was clicked\n\t */\n\tfunction handleAnnotationClick(target) {\n\t  createEditOverlay(target);\n\t}\n\t\n\t/**\n\t * Added to disable movement and deletion of annotations while still\n\t * allowing selection\n\t */\n\tfunction setCanEdit(value) {\n\t  _canEdit = value;\n\t}\n\t\n\t/**\n\t * Enable edit mode behavior.\n\t */\n\tfunction enableEdit() {\n\t  if (_enabled) {\n\t    return;\n\t  }\n\t\n\t  _enabled = true;\n\t  (0, _event.addEventListener)('annotation:click', handleAnnotationClick);\n\t};\n\t\n\t/**\n\t * Disable edit mode behavior.\n\t */\n\tfunction disableEdit() {\n\t  destroyEditOverlay();\n\t\n\t  if (!_enabled) {\n\t    return;\n\t  }\n\t\n\t  _enabled = false;\n\t  (0, _event.removeEventListener)('annotation:click', handleAnnotationClick);\n\t};\n\n/***/ },\n/* 30 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.setPen = setPen;\n\texports.enablePen = enablePen;\n\texports.disablePen = disablePen;\n\t\n\tvar _PDFJSAnnotate = __webpack_require__(1);\n\t\n\tvar _PDFJSAnnotate2 = _interopRequireDefault(_PDFJSAnnotate);\n\t\n\tvar _appendChild = __webpack_require__(11);\n\t\n\tvar _appendChild2 = _interopRequireDefault(_appendChild);\n\t\n\tvar _utils = __webpack_require__(6);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar _enabled = false;\n\tvar _penSize = void 0;\n\tvar _penColor = void 0;\n\tvar path = void 0;\n\tvar lines = void 0;\n\t\n\t/**\n\t * Handle document.mousedown event\n\t */\n\tfunction handleDocumentMousedown() {\n\t  path = null;\n\t  lines = [];\n\t\n\t  document.addEventListener('mousemove', handleDocumentMousemove);\n\t  document.addEventListener('mouseup', handleDocumentMouseup);\n\t}\n\t\n\t/**\n\t * Handle document.mouseup event\n\t *\n\t * @param {Event} e The DOM event to be handled\n\t */\n\tfunction handleDocumentMouseup(e) {\n\t  var svg = void 0;\n\t  if (lines.length > 1 && (svg = (0, _utils.findSVGAtPoint)(e.clientX, e.clientY))) {\n\t    var _getMetadata = (0, _utils.getMetadata)(svg),\n\t        documentId = _getMetadata.documentId,\n\t        pageNumber = _getMetadata.pageNumber;\n\t\n\t    _PDFJSAnnotate2.default.getStoreAdapter().addAnnotation(documentId, pageNumber, {\n\t      type: 'drawing',\n\t      width: _penSize,\n\t      color: _penColor,\n\t      lines: lines\n\t    }).then(function (annotation) {\n\t      if (path) {\n\t        svg.removeChild(path);\n\t      }\n\t\n\t      (0, _appendChild2.default)(svg, annotation);\n\t    });\n\t  }\n\t\n\t  document.removeEventListener('mousemove', handleDocumentMousemove);\n\t  document.removeEventListener('mouseup', handleDocumentMouseup);\n\t}\n\t\n\t/**\n\t * Handle document.mousemove event\n\t *\n\t * @param {Event} e The DOM event to be handled\n\t */\n\tfunction handleDocumentMousemove(e) {\n\t  savePoint(e.clientX, e.clientY);\n\t}\n\t\n\t/**\n\t * Handle document.keyup event\n\t *\n\t * @param {Event} e The DOM event to be handled\n\t */\n\tfunction handleDocumentKeyup(e) {\n\t  // Cancel rect if Esc is pressed\n\t  if (e.keyCode === 27) {\n\t    lines = null;\n\t    path.parentNode.removeChild(path);\n\t    document.removeEventListener('mousemove', handleDocumentMousemove);\n\t    document.removeEventListener('mouseup', handleDocumentMouseup);\n\t  }\n\t}\n\t\n\t/**\n\t * Save a point to the line being drawn.\n\t *\n\t * @param {Number} x The x coordinate of the point\n\t * @param {Number} y The y coordinate of the point\n\t */\n\tfunction savePoint(x, y) {\n\t  var svg = (0, _utils.findSVGAtPoint)(x, y);\n\t  if (!svg) {\n\t    return;\n\t  }\n\t\n\t  var rect = svg.getBoundingClientRect();\n\t  var point = (0, _utils.scaleDown)(svg, {\n\t    x: x - rect.left,\n\t    y: y - rect.top\n\t  });\n\t\n\t  lines.push([point.x, point.y]);\n\t\n\t  if (lines.length <= 1) {\n\t    return;\n\t  }\n\t\n\t  if (path) {\n\t    svg.removeChild(path);\n\t  }\n\t\n\t  path = (0, _appendChild2.default)(svg, {\n\t    type: 'drawing',\n\t    color: _penColor,\n\t    width: _penSize,\n\t    lines: lines\n\t  });\n\t}\n\t\n\t/**\n\t * Set the attributes of the pen.\n\t *\n\t * @param {Number} penSize The size of the lines drawn by the pen\n\t * @param {String} penColor The color of the lines drawn by the pen\n\t */\n\tfunction setPen() {\n\t  var penSize = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n\t  var penColor = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '000000';\n\t\n\t  _penSize = parseInt(penSize, 10);\n\t  _penColor = penColor;\n\t}\n\t\n\t/**\n\t * Enable the pen behavior\n\t */\n\tfunction enablePen() {\n\t  if (_enabled) {\n\t    return;\n\t  }\n\t\n\t  _enabled = true;\n\t  document.addEventListener('mousedown', handleDocumentMousedown);\n\t  document.addEventListener('keyup', handleDocumentKeyup);\n\t  (0, _utils.disableUserSelect)();\n\t}\n\t\n\t/**\n\t * Disable the pen behavior\n\t */\n\tfunction disablePen() {\n\t  if (!_enabled) {\n\t    return;\n\t  }\n\t\n\t  _enabled = false;\n\t  document.removeEventListener('mousedown', handleDocumentMousedown);\n\t  document.removeEventListener('keyup', handleDocumentKeyup);\n\t  (0, _utils.enableUserSelect)();\n\t}\n\n/***/ },\n/* 31 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.enablePoint = enablePoint;\n\texports.disablePoint = disablePoint;\n\t\n\tvar _PDFJSAnnotate = __webpack_require__(1);\n\t\n\tvar _PDFJSAnnotate2 = _interopRequireDefault(_PDFJSAnnotate);\n\t\n\tvar _appendChild = __webpack_require__(11);\n\t\n\tvar _appendChild2 = _interopRequireDefault(_appendChild);\n\t\n\tvar _utils = __webpack_require__(6);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar _enabled = false;\n\tvar input = void 0;\n\t\n\t/**\n\t * Handle document.mouseup event\n\t *\n\t * @param {Event} The DOM event to be handled\n\t */\n\tfunction handleDocumentMouseup(e) {\n\t  if (input || !(0, _utils.findSVGAtPoint)(e.clientX, e.clientY)) {\n\t    return;\n\t  }\n\t\n\t  input = document.createElement('input');\n\t  input.setAttribute('id', 'pdf-annotate-point-input');\n\t  input.setAttribute('placeholder', 'Enter comment');\n\t  input.style.border = '3px solid ' + _utils.BORDER_COLOR;\n\t  input.style.borderRadius = '3px';\n\t  input.style.position = 'absolute';\n\t  input.style.top = e.clientY + 'px';\n\t  input.style.left = e.clientX + 'px';\n\t\n\t  input.addEventListener('blur', handleInputBlur);\n\t  input.addEventListener('keyup', handleInputKeyup);\n\t\n\t  document.body.appendChild(input);\n\t  input.focus();\n\t}\n\t\n\t/**\n\t * Handle input.blur event\n\t */\n\tfunction handleInputBlur() {\n\t  savePoint();\n\t}\n\t\n\t/**\n\t * Handle input.keyup event\n\t *\n\t * @param {Event} e The DOM event to handle\n\t */\n\tfunction handleInputKeyup(e) {\n\t  if (e.keyCode === 27) {\n\t    closeInput();\n\t  } else if (e.keyCode === 13) {\n\t    savePoint();\n\t  }\n\t}\n\t\n\t/**\n\t * Save a new point annotation from input\n\t */\n\tfunction savePoint() {\n\t  if (input.value.trim().length > 0) {\n\t    var clientX = parseInt(input.style.left, 10);\n\t    var clientY = parseInt(input.style.top, 10);\n\t    var content = input.value.trim();\n\t    var svg = (0, _utils.findSVGAtPoint)(clientX, clientY);\n\t    if (!svg) {\n\t      return;\n\t    }\n\t\n\t    var rect = svg.getBoundingClientRect();\n\t\n\t    var _getMetadata = (0, _utils.getMetadata)(svg),\n\t        documentId = _getMetadata.documentId,\n\t        pageNumber = _getMetadata.pageNumber;\n\t\n\t    var annotation = Object.assign({\n\t      type: 'point'\n\t    }, (0, _utils.scaleDown)(svg, {\n\t      x: clientX - rect.left,\n\t      y: clientY - rect.top\n\t    }));\n\t\n\t    _PDFJSAnnotate2.default.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation).then(function (annotation) {\n\t      _PDFJSAnnotate2.default.getStoreAdapter().addComment(documentId, annotation.uuid, content);\n\t\n\t      (0, _appendChild2.default)(svg, annotation);\n\t    });\n\t  }\n\t\n\t  closeInput();\n\t}\n\t\n\t/**\n\t * Close the input element\n\t */\n\tfunction closeInput() {\n\t  input.removeEventListener('blur', handleInputBlur);\n\t  input.removeEventListener('keyup', handleInputKeyup);\n\t  document.body.removeChild(input);\n\t  input = null;\n\t}\n\t\n\t/**\n\t * Enable point annotation behavior\n\t */\n\tfunction enablePoint() {\n\t  if (_enabled) {\n\t    return;\n\t  }\n\t\n\t  _enabled = true;\n\t  document.addEventListener('mouseup', handleDocumentMouseup);\n\t}\n\t\n\t/**\n\t * Disable point annotation behavior\n\t */\n\tfunction disablePoint() {\n\t  if (!_enabled) {\n\t    return;\n\t  }\n\t\n\t  _enabled = false;\n\t  document.removeEventListener('mouseup', handleDocumentMouseup);\n\t}\n\n/***/ },\n/* 32 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.enableRect = enableRect;\n\texports.disableRect = disableRect;\n\t\n\tvar _PDFJSAnnotate = __webpack_require__(1);\n\t\n\tvar _PDFJSAnnotate2 = _interopRequireDefault(_PDFJSAnnotate);\n\t\n\tvar _appendChild = __webpack_require__(11);\n\t\n\tvar _appendChild2 = _interopRequireDefault(_appendChild);\n\t\n\tvar _utils = __webpack_require__(6);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tvar _enabled = false;\n\tvar _type = void 0;\n\tvar overlay = void 0;\n\tvar originY = void 0;\n\tvar originX = void 0;\n\t\n\t/**\n\t * Get the current window selection as rects\n\t *\n\t * @return {Array} An Array of rects\n\t */\n\tfunction getSelectionRects() {\n\t  try {\n\t    var selection = window.getSelection();\n\t    var range = selection.getRangeAt(0);\n\t    var rects = range.getClientRects();\n\t\n\t    if (rects.length > 0 && rects[0].width > 0 && rects[0].height > 0) {\n\t      return rects;\n\t    }\n\t  } catch (e) {}\n\t\n\t  return null;\n\t}\n\t\n\t/**\n\t * Handle document.mousedown event\n\t *\n\t * @param {Event} e The DOM event to handle\n\t */\n\tfunction handleDocumentMousedown(e) {\n\t  var svg = void 0;\n\t  if (_type !== 'area' || !(svg = (0, _utils.findSVGAtPoint)(e.clientX, e.clientY))) {\n\t    return;\n\t  }\n\t\n\t  var rect = svg.getBoundingClientRect();\n\t  originY = e.clientY;\n\t  originX = e.clientX;\n\t\n\t  overlay = document.createElement('div');\n\t  overlay.style.position = 'absolute';\n\t  overlay.style.top = originY - rect.top + 'px';\n\t  overlay.style.left = originX - rect.left + 'px';\n\t  overlay.style.border = '3px solid ' + _utils.BORDER_COLOR;\n\t  overlay.style.borderRadius = '3px';\n\t  svg.parentNode.appendChild(overlay);\n\t\n\t  document.addEventListener('mousemove', handleDocumentMousemove);\n\t  (0, _utils.disableUserSelect)();\n\t}\n\t\n\t/**\n\t * Handle document.mousemove event\n\t *\n\t * @param {Event} e The DOM event to handle\n\t */\n\tfunction handleDocumentMousemove(e) {\n\t  var svg = overlay.parentNode.querySelector('svg.annotationLayer');\n\t  var rect = svg.getBoundingClientRect();\n\t\n\t  if (originX + (e.clientX - originX) < rect.right) {\n\t    overlay.style.width = e.clientX - originX + 'px';\n\t  }\n\t\n\t  if (originY + (e.clientY - originY) < rect.bottom) {\n\t    overlay.style.height = e.clientY - originY + 'px';\n\t  }\n\t}\n\t\n\t/**\n\t * Handle document.mouseup event\n\t *\n\t * @param {Event} e The DOM event to handle\n\t */\n\tfunction handleDocumentMouseup(e) {\n\t  var rects = void 0;\n\t\n\t  // TODO: Pamoja: temp fix (mrbrdo) - fix problem if creating highlight annotation and then clicking arrow icon (would duplicate annotation because of this function call)\n\t  if (!(0, _utils.findSVGAtPoint)(e.clientX, e.clientY)) {\n\t    return;\n\t  }\n\t\n\t  if (_type !== 'area' && (rects = getSelectionRects())) {\n\t    var svg = (0, _utils.findSVGAtPoint)(rects[0].left, rects[0].top);\n\t    saveRect(_type, [].concat(_toConsumableArray(rects)).map(function (r) {\n\t      return {\n\t        top: r.top,\n\t        left: r.left,\n\t        width: r.width,\n\t        height: r.height\n\t      };\n\t    }));\n\t  } else if (_type === 'area' && overlay) {\n\t    var _svg = overlay.parentNode.querySelector('svg.annotationLayer');\n\t    var rect = _svg.getBoundingClientRect();\n\t    saveRect(_type, [{\n\t      top: parseInt(overlay.style.top, 10) + rect.top,\n\t      left: parseInt(overlay.style.left, 10) + rect.left,\n\t      width: parseInt(overlay.style.width, 10),\n\t      height: parseInt(overlay.style.height, 10)\n\t    }]);\n\t\n\t    overlay.parentNode.removeChild(overlay);\n\t    overlay = null;\n\t\n\t    document.removeEventListener('mousemove', handleDocumentMousemove);\n\t    (0, _utils.enableUserSelect)();\n\t  }\n\t}\n\t\n\t/**\n\t * Handle document.keyup event\n\t *\n\t * @param {Event} e The DOM event to handle\n\t */\n\tfunction handleDocumentKeyup(e) {\n\t  // Cancel rect if Esc is pressed\n\t  if (e.keyCode === 27) {\n\t    var selection = window.getSelection();\n\t    selection.removeAllRanges();\n\t    if (overlay && overlay.parentNode) {\n\t      overlay.parentNode.removeChild(overlay);\n\t      overlay = null;\n\t      document.removeEventListener('mousemove', handleDocumentMousemove);\n\t    }\n\t  }\n\t}\n\t\n\t/**\n\t * Save a rect annotation\n\t *\n\t * @param {String} type The type of rect (area, highlight, strikeout)\n\t * @param {Array} rects The rects to use for annotation\n\t * @param {String} color The color of the rects\n\t */\n\tfunction saveRect(type, rects, color) {\n\t  var svg = (0, _utils.findSVGAtPoint)(rects[0].left, rects[0].top);\n\t  var node = void 0;\n\t  var annotation = void 0;\n\t\n\t  if (!svg) {\n\t    return;\n\t  }\n\t\n\t  var boundingRect = svg.getBoundingClientRect();\n\t\n\t  if (!color) {\n\t    if (type === 'highlight') {\n\t      color = 'FFFF00';\n\t    } else if (type === 'strikeout') {\n\t      color = 'FF0000';\n\t    }\n\t  }\n\t\n\t  // Initialize the annotation\n\t  annotation = {\n\t    type: type,\n\t    color: color,\n\t    rectangles: [].concat(_toConsumableArray(rects)).map(function (r) {\n\t      var offset = 0;\n\t\n\t      if (type === 'strikeout') {\n\t        offset = r.height / 2;\n\t      }\n\t\n\t      return (0, _utils.scaleDown)(svg, {\n\t        y: r.top + offset - boundingRect.top,\n\t        x: r.left - boundingRect.left,\n\t        width: r.width,\n\t        height: r.height\n\t      });\n\t    }).filter(function (r) {\n\t      return r.width > 0 && r.height > 0 && r.x > -1 && r.y > -1;\n\t    })\n\t  };\n\t\n\t  // Short circuit if no rectangles exist\n\t  if (annotation.rectangles.length === 0) {\n\t    return;\n\t  }\n\t\n\t  // Special treatment for area as it only supports a single rect\n\t  if (type === 'area') {\n\t    var rect = annotation.rectangles[0];\n\t    delete annotation.rectangles;\n\t    annotation.x = rect.x;\n\t    annotation.y = rect.y;\n\t    annotation.width = rect.width;\n\t    annotation.height = rect.height;\n\t  }\n\t\n\t  var _getMetadata = (0, _utils.getMetadata)(svg),\n\t      documentId = _getMetadata.documentId,\n\t      pageNumber = _getMetadata.pageNumber;\n\t\n\t  // Add the annotation\n\t\n\t\n\t  _PDFJSAnnotate2.default.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation).then(function (annotation) {\n\t    (0, _appendChild2.default)(svg, annotation);\n\t  });\n\t}\n\t\n\t/**\n\t * Enable rect behavior\n\t */\n\tfunction enableRect(type) {\n\t  _type = type;\n\t\n\t  if (_enabled) {\n\t    return;\n\t  }\n\t\n\t  _enabled = true;\n\t  document.addEventListener('mouseup', handleDocumentMouseup);\n\t  document.addEventListener('mousedown', handleDocumentMousedown);\n\t  document.addEventListener('keyup', handleDocumentKeyup);\n\t}\n\t\n\t/**\n\t * Disable rect behavior\n\t */\n\tfunction disableRect() {\n\t  if (!_enabled) {\n\t    return;\n\t  }\n\t\n\t  _enabled = false;\n\t  document.removeEventListener('mouseup', handleDocumentMouseup);\n\t  document.removeEventListener('mousedown', handleDocumentMousedown);\n\t  document.removeEventListener('keyup', handleDocumentKeyup);\n\t}\n\n/***/ },\n/* 33 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.setText = setText;\n\texports.enableText = enableText;\n\texports.disableText = disableText;\n\t\n\tvar _PDFJSAnnotate = __webpack_require__(1);\n\t\n\tvar _PDFJSAnnotate2 = _interopRequireDefault(_PDFJSAnnotate);\n\t\n\tvar _appendChild = __webpack_require__(11);\n\t\n\tvar _appendChild2 = _interopRequireDefault(_appendChild);\n\t\n\tvar _utils = __webpack_require__(6);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar _enabled = false;\n\tvar input = void 0;\n\tvar _textSize = void 0;\n\tvar _textColor = void 0;\n\t\n\t/**\n\t * Handle document.mouseup event\n\t *\n\t * @param {Event} e The DOM event to handle\n\t */\n\tfunction handleDocumentMouseup(e) {\n\t  if (input || !(0, _utils.findSVGAtPoint)(e.clientX, e.clientY)) {\n\t    return;\n\t  }\n\t\n\t  input = document.createElement('input');\n\t  input.setAttribute('id', 'pdf-annotate-text-input');\n\t  input.setAttribute('placeholder', 'Enter text');\n\t  input.style.border = '3px solid ' + _utils.BORDER_COLOR;\n\t  input.style.borderRadius = '3px';\n\t  input.style.position = 'absolute';\n\t  input.style.top = e.clientY + 'px';\n\t  input.style.left = e.clientX + 'px';\n\t  input.style.fontSize = _textSize + 'px';\n\t\n\t  input.addEventListener('blur', handleInputBlur);\n\t  input.addEventListener('keyup', handleInputKeyup);\n\t\n\t  document.body.appendChild(input);\n\t  input.focus();\n\t}\n\t\n\t/**\n\t * Handle input.blur event\n\t */\n\tfunction handleInputBlur() {\n\t  saveText();\n\t}\n\t\n\t/**\n\t * Handle input.keyup event\n\t *\n\t * @param {Event} e The DOM event to handle\n\t */\n\tfunction handleInputKeyup(e) {\n\t  if (e.keyCode === 27) {\n\t    closeInput();\n\t  } else if (e.keyCode === 13) {\n\t    saveText();\n\t  }\n\t}\n\t\n\t/**\n\t * Save a text annotation from input\n\t */\n\tfunction saveText() {\n\t  if (input.value.trim().length > 0) {\n\t    var clientX = parseInt(input.style.left, 10);\n\t    var clientY = parseInt(input.style.top, 10);\n\t    var svg = (0, _utils.findSVGAtPoint)(clientX, clientY);\n\t    if (!svg) {\n\t      return;\n\t    }\n\t\n\t    var _getMetadata = (0, _utils.getMetadata)(svg),\n\t        documentId = _getMetadata.documentId,\n\t        pageNumber = _getMetadata.pageNumber;\n\t\n\t    var rect = svg.getBoundingClientRect();\n\t    var annotation = Object.assign({\n\t      type: 'textbox',\n\t      size: _textSize,\n\t      color: _textColor,\n\t      content: input.value.trim()\n\t    }, (0, _utils.scaleDown)(svg, {\n\t      x: clientX - rect.left,\n\t      y: clientY - rect.top,\n\t      width: input.offsetWidth,\n\t      height: input.offsetHeight\n\t    }));\n\t\n\t    _PDFJSAnnotate2.default.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation).then(function (annotation) {\n\t      (0, _appendChild2.default)(svg, annotation);\n\t    });\n\t  }\n\t\n\t  closeInput();\n\t}\n\t\n\t/**\n\t * Close the input\n\t */\n\tfunction closeInput() {\n\t  if (input) {\n\t    input.removeEventListener('blur', handleInputBlur);\n\t    input.removeEventListener('keyup', handleInputKeyup);\n\t    document.body.removeChild(input);\n\t    input = null;\n\t  }\n\t}\n\t\n\t/**\n\t * Set the text attributes\n\t *\n\t * @param {Number} textSize The size of the text\n\t * @param {String} textColor The color of the text\n\t */\n\tfunction setText() {\n\t  var textSize = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 12;\n\t  var textColor = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '000000';\n\t\n\t  _textSize = parseInt(textSize, 10);\n\t  _textColor = textColor;\n\t}\n\t\n\t/**\n\t * Enable text behavior\n\t */\n\tfunction enableText() {\n\t  if (_enabled) {\n\t    return;\n\t  }\n\t\n\t  _enabled = true;\n\t  document.addEventListener('mouseup', handleDocumentMouseup);\n\t}\n\t\n\t/**\n\t * Disable text behavior\n\t */\n\tfunction disableText() {\n\t  if (!_enabled) {\n\t    return;\n\t  }\n\t\n\t  _enabled = false;\n\t  document.removeEventListener('mouseup', handleDocumentMouseup);\n\t}\n\n/***/ },\n/* 34 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\texports.createPage = createPage;\n\texports.renderPage = renderPage;\n\t\n\tvar _PDFJSAnnotate = __webpack_require__(1);\n\t\n\tvar _PDFJSAnnotate2 = _interopRequireDefault(_PDFJSAnnotate);\n\t\n\tvar _renderScreenReaderHints = __webpack_require__(20);\n\t\n\tvar _renderScreenReaderHints2 = _interopRequireDefault(_renderScreenReaderHints);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t// Template for creating a new page\n\tvar PAGE_TEMPLATE = '\\n  <div style=\"visibility: hidden;\" class=\"page\" data-loaded=\"false\">\\n    <div class=\"canvasWrapper\">\\n      <canvas></canvas>\\n    </div>\\n    <svg class=\"annotationLayer\"></svg>\\n    <div class=\"textLayer\"></div>\\n  </div>\\n';\n\t\n\t/**\n\t * Create a new page to be appended to the DOM.\n\t *\n\t * @param {Number} pageNumber The page number that is being created\n\t * @return {HTMLElement}\n\t */\n\tfunction createPage(pageNumber) {\n\t  var temp = document.createElement('div');\n\t  temp.innerHTML = PAGE_TEMPLATE;\n\t\n\t  var page = temp.children[0];\n\t  var canvas = page.querySelector('canvas');\n\t\n\t  page.setAttribute('id', 'pageContainer' + pageNumber);\n\t  page.setAttribute('data-page-number', pageNumber);\n\t\n\t  canvas.mozOpaque = true;\n\t  canvas.setAttribute('id', 'page' + pageNumber);\n\t\n\t  return page;\n\t}\n\t\n\t/**\n\t * Render a page that has already been created.\n\t *\n\t * @param {Number} pageNumber The page number to be rendered\n\t * @param {Object} renderOptions The options for rendering\n\t * @return {Promise} Settled once rendering has completed\n\t *  A settled Promise will be either:\n\t *    - fulfilled: [pdfPage, annotations]\n\t *    - rejected: Error\n\t */\n\tfunction renderPage(pageNumber, renderOptions) {\n\t  var documentId = renderOptions.documentId,\n\t      pdfDocument = renderOptions.pdfDocument,\n\t      scale = renderOptions.scale,\n\t      rotate = renderOptions.rotate;\n\t\n\t  // Load the page and annotations\n\t\n\t  return Promise.all([pdfDocument.getPage(pageNumber), _PDFJSAnnotate2.default.getAnnotations(documentId, pageNumber)]).then(function (_ref) {\n\t    var _ref2 = _slicedToArray(_ref, 2),\n\t        pdfPage = _ref2[0],\n\t        annotations = _ref2[1];\n\t\n\t    var page = document.getElementById('pageContainer' + pageNumber);\n\t    var svg = page.querySelector('.annotationLayer');\n\t    var canvas = page.querySelector('.canvasWrapper canvas');\n\t    var canvasContext = canvas.getContext('2d', { alpha: false });\n\t    var viewport = pdfPage.getViewport(scale, rotate);\n\t    var transform = scalePage(pageNumber, viewport, canvasContext);\n\t\n\t    // Render the page\n\t    return Promise.all([pdfPage.render({ canvasContext: canvasContext, viewport: viewport, transform: transform }), _PDFJSAnnotate2.default.render(svg, viewport, annotations)]).then(function () {\n\t      // Text content is needed for a11y, but is also necessary for creating\n\t      // highlight and strikeout annotations which require selecting text.\n\t      return pdfPage.getTextContent({ normalizeWhitespace: true }).then(function (textContent) {\n\t        return new Promise(function (resolve, reject) {\n\t          // Render text layer for a11y of text content\n\t          var textLayer = page.querySelector('.textLayer');\n\t          var textLayerFactory = new PDFJS.DefaultTextLayerFactory();\n\t          var textLayerBuilder = textLayerFactory.createTextLayerBuilder(textLayer, pageNumber - 1, viewport);\n\t          textLayerBuilder.setTextContent(textContent);\n\t          textLayerBuilder.render();\n\t\n\t          // Enable a11y for annotations\n\t          // Timeout is needed to wait for `textLayerBuilder.render`\n\t          setTimeout(function () {\n\t            try {\n\t              (0, _renderScreenReaderHints2.default)(annotations.annotations);\n\t              resolve();\n\t            } catch (e) {\n\t              reject(e);\n\t            }\n\t          });\n\t        });\n\t      });\n\t    }).then(function () {\n\t      // Indicate that the page was loaded\n\t      page.setAttribute('data-loaded', 'true');\n\t\n\t      return [pdfPage, annotations];\n\t    });\n\t  });\n\t}\n\t\n\t/**\n\t * Scale the elements of a page.\n\t *\n\t * @param {Number} pageNumber The page number to be scaled\n\t * @param {Object} viewport The viewport of the PDF page (see pdfPage.getViewport(scale, rotate))\n\t * @param {Object} context The canvas context that the PDF page is rendered to\n\t * @return {Array} The transform data for rendering the PDF page\n\t */\n\tfunction scalePage(pageNumber, viewport, context) {\n\t  var page = document.getElementById('pageContainer' + pageNumber);\n\t  var canvas = page.querySelector('.canvasWrapper canvas');\n\t  var svg = page.querySelector('.annotationLayer');\n\t  var wrapper = page.querySelector('.canvasWrapper');\n\t  var textLayer = page.querySelector('.textLayer');\n\t  var outputScale = getOutputScale(context);\n\t  var transform = !outputScale.scaled ? null : [outputScale.sx, 0, 0, outputScale.sy, 0, 0];\n\t  var sfx = approximateFraction(outputScale.sx);\n\t  var sfy = approximateFraction(outputScale.sy);\n\t\n\t  // Adjust width/height for scale\n\t  page.style.visibility = '';\n\t  canvas.width = roundToDivide(viewport.width * outputScale.sx, sfx[0]);\n\t  canvas.height = roundToDivide(viewport.height * outputScale.sy, sfy[0]);\n\t  canvas.style.width = roundToDivide(viewport.width, sfx[1]) + 'px';\n\t  canvas.style.height = roundToDivide(viewport.height, sfx[1]) + 'px';\n\t  svg.setAttribute('width', viewport.width);\n\t  svg.setAttribute('height', viewport.height);\n\t  svg.style.width = viewport.width + 'px';\n\t  svg.style.height = viewport.height + 'px';\n\t  page.style.width = viewport.width + 'px';\n\t  page.style.height = viewport.height + 'px';\n\t  wrapper.style.width = viewport.width + 'px';\n\t  wrapper.style.height = viewport.height + 'px';\n\t  textLayer.style.width = viewport.width + 'px';\n\t  textLayer.style.height = viewport.height + 'px';\n\t\n\t  return transform;\n\t}\n\t\n\t/**\n\t * The following methods are taken from mozilla/pdf.js and as such fall under\n\t * the Apache License (http://www.apache.org/licenses/).\n\t *\n\t * Original source can be found at mozilla/pdf.js:\n\t * https://github.com/mozilla/pdf.js/blob/master/web/ui_utils.js\n\t */\n\t\n\t/**\n\t * Approximates a float number as a fraction using Farey sequence (max order\n\t * of 8).\n\t *\n\t * @param {Number} x Positive float number\n\t * @return {Array} Estimated fraction: the first array item is a numerator,\n\t *                 the second one is a denominator.\n\t */\n\tfunction approximateFraction(x) {\n\t  // Fast path for int numbers or their inversions.\n\t  if (Math.floor(x) === x) {\n\t    return [x, 1];\n\t  }\n\t\n\t  var xinv = 1 / x;\n\t  var limit = 8;\n\t  if (xinv > limit) {\n\t    return [1, limit];\n\t  } else if (Math.floor(xinv) === xinv) {\n\t    return [1, xinv];\n\t  }\n\t\n\t  var x_ = x > 1 ? xinv : x;\n\t\n\t  // a/b and c/d are neighbours in Farey sequence.\n\t  var a = 0,\n\t      b = 1,\n\t      c = 1,\n\t      d = 1;\n\t\n\t  // Limit search to order 8.\n\t  while (true) {\n\t    // Generating next term in sequence (order of q).\n\t    var p = a + c,\n\t        q = b + d;\n\t    if (q > limit) {\n\t      break;\n\t    }\n\t    if (x_ <= p / q) {\n\t      c = p;d = q;\n\t    } else {\n\t      a = p;b = q;\n\t    }\n\t  }\n\t\n\t  // Select closest of neighbours to x.\n\t  if (x_ - a / b < c / d - x_) {\n\t    return x_ === x ? [a, b] : [b, a];\n\t  } else {\n\t    return x_ === x ? [c, d] : [d, c];\n\t  }\n\t}\n\t\n\tfunction getOutputScale(ctx) {\n\t  var devicePixelRatio = window.devicePixelRatio || 1;\n\t  var backingStoreRatio = ctx.webkitBackingStorePixelRatio || ctx.mozBackingStorePixelRatio || ctx.msBackingStorePixelRatio || ctx.oBackingStorePixelRatio || ctx.backingStorePixelRatio || 1;\n\t  var pixelRatio = devicePixelRatio / backingStoreRatio;\n\t  return {\n\t    sx: pixelRatio,\n\t    sy: pixelRatio,\n\t    scaled: pixelRatio !== 1\n\t  };\n\t}\n\t\n\tfunction roundToDivide(x, div) {\n\t  var r = x % div;\n\t  return r === 0 ? x : Math.round(x - r + div);\n\t}\n\n/***/ },\n/* 35 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = initColorPicker;\n\t// Color picker component\n\tvar COLORS = [{ hex: '#000000', name: 'Black' }, { hex: '#EF4437', name: 'Red' }, { hex: '#E71F63', name: 'Pink' }, { hex: '#8F3E97', name: 'Purple' }, { hex: '#65499D', name: 'Deep Purple' }, { hex: '#4554A4', name: 'Indigo' }, { hex: '#2083C5', name: 'Blue' }, { hex: '#35A4DC', name: 'Light Blue' }, { hex: '#09BCD3', name: 'Cyan' }, { hex: '#009688', name: 'Teal' }, { hex: '#43A047', name: 'Green' }, { hex: '#8BC34A', name: 'Light Green' }, { hex: '#FDC010', name: 'Yellow' }, { hex: '#F8971C', name: 'Orange' }, { hex: '#F0592B', name: 'Deep Orange' }, { hex: '#F06291', name: 'Light Pink' }];\n\t\n\tfunction initColorPicker(el, value, onChange) {\n\t  function setColor(value) {\n\t    var fireOnChange = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\t\n\t    currentValue = value;\n\t    a.setAttribute('data-color', value);\n\t    a.style.background = value;\n\t    if (fireOnChange && typeof onChange === 'function') {\n\t      onChange(value);\n\t    }\n\t    closePicker();\n\t  }\n\t\n\t  function togglePicker() {\n\t    if (isPickerOpen) {\n\t      closePicker();\n\t    } else {\n\t      openPicker();\n\t    }\n\t  }\n\t\n\t  function closePicker() {\n\t    document.removeEventListener('keyup', handleDocumentKeyup);\n\t    if (picker && picker.parentNode) {\n\t      picker.parentNode.removeChild(picker);\n\t    }\n\t    isPickerOpen = false;\n\t    a.focus();\n\t  }\n\t\n\t  function openPicker() {\n\t    if (!picker) {\n\t      picker = document.createElement('div');\n\t      picker.style.background = '#fff';\n\t      picker.style.border = '1px solid #ccc';\n\t      picker.style.padding = '2px';\n\t      picker.style.position = 'absolute';\n\t      picker.style.width = '122px';\n\t      el.style.position = 'relative';\n\t\n\t      COLORS.map(createColorOption).forEach(function (c) {\n\t        c.style.margin = '2px';\n\t        c.onclick = function () {\n\t          setColor(c.getAttribute('data-color'));\n\t        };\n\t        picker.appendChild(c);\n\t      });\n\t    }\n\t\n\t    document.addEventListener('keyup', handleDocumentKeyup);\n\t    el.appendChild(picker);\n\t    isPickerOpen = true;\n\t  }\n\t\n\t  function createColorOption(color) {\n\t    var e = document.createElement('a');\n\t    e.className = 'color';\n\t    e.setAttribute('href', 'javascript://');\n\t    e.setAttribute('title', color.name);\n\t    e.setAttribute('data-color', color.hex);\n\t    e.style.background = color.hex;\n\t    return e;\n\t  }\n\t\n\t  function handleDocumentKeyup(e) {\n\t    if (e.keyCode === 27) {\n\t      closePicker();\n\t    }\n\t  }\n\t\n\t  var picker = void 0;\n\t  var isPickerOpen = false;\n\t  var currentValue = void 0;\n\t  var a = createColorOption({ hex: value });\n\t  a.onclick = togglePicker;\n\t  el.appendChild(a);\n\t  setColor(value, false);\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 36 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\t/* Copyright 2014 Mozilla Foundation\n\t *\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t/*jshint globalstrict: false */\n\t/* globals PDFJS, PDFViewer, PDFPageView, TextLayerBuilder, PDFLinkService,\n\t           DefaultTextLayerFactory, AnnotationLayerBuilder, PDFHistory,\n\t           DefaultAnnotationLayerFactory, getFileName, ProgressBar */\n\t\n\t// Initializing PDFJS global object (if still undefined)\n\tif (typeof PDFJS === 'undefined') {\n\t  (typeof window !== 'undefined' ? window : undefined).PDFJS = {};\n\t}\n\t\n\t(function pdfViewerWrapper() {\n\t  'use strict';\n\t\n\t  var CSS_UNITS = 96.0 / 72.0;\n\t  var DEFAULT_SCALE_VALUE = 'auto';\n\t  var DEFAULT_SCALE = 1.0;\n\t  var UNKNOWN_SCALE = 0;\n\t  var MAX_AUTO_SCALE = 1.25;\n\t  var SCROLLBAR_PADDING = 40;\n\t  var VERTICAL_PADDING = 5;\n\t\n\t  function getFileName(url) {\n\t    var anchor = url.indexOf('#');\n\t    var query = url.indexOf('?');\n\t    var end = Math.min(anchor > 0 ? anchor : url.length, query > 0 ? query : url.length);\n\t    return url.substring(url.lastIndexOf('/', end) + 1, end);\n\t  }\n\t\n\t  /**\n\t   * Returns scale factor for the canvas. It makes sense for the HiDPI displays.\n\t   * @return {Object} The object with horizontal (sx) and vertical (sy)\n\t                      scales. The scaled property is set to false if scaling is\n\t                      not required, true otherwise.\n\t   */\n\t  function getOutputScale(ctx) {\n\t    var devicePixelRatio = window.devicePixelRatio || 1;\n\t    var backingStoreRatio = ctx.webkitBackingStorePixelRatio || ctx.mozBackingStorePixelRatio || ctx.msBackingStorePixelRatio || ctx.oBackingStorePixelRatio || ctx.backingStorePixelRatio || 1;\n\t    var pixelRatio = devicePixelRatio / backingStoreRatio;\n\t    return {\n\t      sx: pixelRatio,\n\t      sy: pixelRatio,\n\t      scaled: pixelRatio !== 1\n\t    };\n\t  }\n\t\n\t  /**\n\t   * Scrolls specified element into view of its parent.\n\t   * @param {Object} element - The element to be visible.\n\t   * @param {Object} spot - An object with optional top and left properties,\n\t   *   specifying the offset from the top left edge.\n\t   * @param {boolean} skipOverflowHiddenElements - Ignore elements that have\n\t   *   the CSS rule `overflow: hidden;` set. The default is false.\n\t   */\n\t  function scrollIntoView(element, spot, skipOverflowHiddenElements) {\n\t    // Assuming offsetParent is available (it's not available when viewer is in\n\t    // hidden iframe or object). We have to scroll: if the offsetParent is not set\n\t    // producing the error. See also animationStartedClosure.\n\t    var parent = element.offsetParent;\n\t    if (!parent) {\n\t      console.error('offsetParent is not set -- cannot scroll');\n\t      return;\n\t    }\n\t    var checkOverflow = skipOverflowHiddenElements || false;\n\t    var offsetY = element.offsetTop + element.clientTop;\n\t    var offsetX = element.offsetLeft + element.clientLeft;\n\t    while (parent.clientHeight === parent.scrollHeight || checkOverflow && getComputedStyle(parent).overflow === 'hidden') {\n\t      if (parent.dataset._scaleY) {\n\t        offsetY /= parent.dataset._scaleY;\n\t        offsetX /= parent.dataset._scaleX;\n\t      }\n\t      offsetY += parent.offsetTop;\n\t      offsetX += parent.offsetLeft;\n\t      parent = parent.offsetParent;\n\t      if (!parent) {\n\t        return; // no need to scroll\n\t      }\n\t    }\n\t    if (spot) {\n\t      if (spot.top !== undefined) {\n\t        offsetY += spot.top;\n\t      }\n\t      if (spot.left !== undefined) {\n\t        offsetX += spot.left;\n\t        parent.scrollLeft = offsetX;\n\t      }\n\t    }\n\t    parent.scrollTop = offsetY;\n\t  }\n\t\n\t  /**\n\t   * Helper function to start monitoring the scroll event and converting them into\n\t   * PDF.js friendly one: with scroll debounce and scroll direction.\n\t   */\n\t  function watchScroll(viewAreaElement, callback) {\n\t    var debounceScroll = function debounceScroll(evt) {\n\t      if (rAF) {\n\t        return;\n\t      }\n\t      // schedule an invocation of scroll for next animation frame.\n\t      rAF = window.requestAnimationFrame(function viewAreaElementScrolled() {\n\t        rAF = null;\n\t\n\t        var currentY = viewAreaElement.scrollTop;\n\t        var lastY = state.lastY;\n\t        if (currentY !== lastY) {\n\t          state.down = currentY > lastY;\n\t        }\n\t        state.lastY = currentY;\n\t        callback(state);\n\t      });\n\t    };\n\t\n\t    var state = {\n\t      down: true,\n\t      lastY: viewAreaElement.scrollTop,\n\t      _eventHandler: debounceScroll\n\t    };\n\t\n\t    var rAF = null;\n\t    viewAreaElement.addEventListener('scroll', debounceScroll, true);\n\t    return state;\n\t  }\n\t\n\t  /**\n\t   * Helper function to parse query string (e.g. ?param1=value&parm2=...).\n\t   */\n\t  function parseQueryString(query) {\n\t    var parts = query.split('&');\n\t    var params = {};\n\t    for (var i = 0, ii = parts.length; i < ii; ++i) {\n\t      var param = parts[i].split('=');\n\t      var key = param[0].toLowerCase();\n\t      var value = param.length > 1 ? param[1] : null;\n\t      params[decodeURIComponent(key)] = decodeURIComponent(value);\n\t    }\n\t    return params;\n\t  }\n\t\n\t  /**\n\t   * Use binary search to find the index of the first item in a given array which\n\t   * passes a given condition. The items are expected to be sorted in the sense\n\t   * that if the condition is true for one item in the array, then it is also true\n\t   * for all following items.\n\t   *\n\t   * @returns {Number} Index of the first array element to pass the test,\n\t   *                   or |items.length| if no such element exists.\n\t   */\n\t  function binarySearchFirstItem(items, condition) {\n\t    var minIndex = 0;\n\t    var maxIndex = items.length - 1;\n\t\n\t    if (items.length === 0 || !condition(items[maxIndex])) {\n\t      return items.length;\n\t    }\n\t    if (condition(items[minIndex])) {\n\t      return minIndex;\n\t    }\n\t\n\t    while (minIndex < maxIndex) {\n\t      var currentIndex = minIndex + maxIndex >> 1;\n\t      var currentItem = items[currentIndex];\n\t      if (condition(currentItem)) {\n\t        maxIndex = currentIndex;\n\t      } else {\n\t        minIndex = currentIndex + 1;\n\t      }\n\t    }\n\t    return minIndex; /* === maxIndex */\n\t  }\n\t\n\t  /**\n\t   *  Approximates float number as a fraction using Farey sequence (max order\n\t   *  of 8).\n\t   *  @param {number} x - Positive float number.\n\t   *  @returns {Array} Estimated fraction: the first array item is a numerator,\n\t   *                   the second one is a denominator.\n\t   */\n\t  function approximateFraction(x) {\n\t    // Fast paths for int numbers or their inversions.\n\t    if (Math.floor(x) === x) {\n\t      return [x, 1];\n\t    }\n\t    var xinv = 1 / x;\n\t    var limit = 8;\n\t    if (xinv > limit) {\n\t      return [1, limit];\n\t    } else if (Math.floor(xinv) === xinv) {\n\t      return [1, xinv];\n\t    }\n\t\n\t    var x_ = x > 1 ? xinv : x;\n\t    // a/b and c/d are neighbours in Farey sequence.\n\t    var a = 0,\n\t        b = 1,\n\t        c = 1,\n\t        d = 1;\n\t    // Limiting search to order 8.\n\t    while (true) {\n\t      // Generating next term in sequence (order of q).\n\t      var p = a + c,\n\t          q = b + d;\n\t      if (q > limit) {\n\t        break;\n\t      }\n\t      if (x_ <= p / q) {\n\t        c = p;d = q;\n\t      } else {\n\t        a = p;b = q;\n\t      }\n\t    }\n\t    // Select closest of the neighbours to x.\n\t    if (x_ - a / b < c / d - x_) {\n\t      return x_ === x ? [a, b] : [b, a];\n\t    } else {\n\t      return x_ === x ? [c, d] : [d, c];\n\t    }\n\t  }\n\t\n\t  function roundToDivide(x, div) {\n\t    var r = x % div;\n\t    return r === 0 ? x : Math.round(x - r + div);\n\t  }\n\t\n\t  /**\n\t   * Generic helper to find out what elements are visible within a scroll pane.\n\t   */\n\t  function getVisibleElements(scrollEl, views, sortByVisibility) {\n\t    var top = scrollEl.scrollTop,\n\t        bottom = top + scrollEl.clientHeight;\n\t    var left = scrollEl.scrollLeft,\n\t        right = left + scrollEl.clientWidth;\n\t\n\t    function isElementBottomBelowViewTop(view) {\n\t      var element = view.div;\n\t      var elementBottom = element.offsetTop + element.clientTop + element.clientHeight;\n\t      return elementBottom > top;\n\t    }\n\t\n\t    var visible = [],\n\t        view,\n\t        element;\n\t    var currentHeight, viewHeight, hiddenHeight, percentHeight;\n\t    var currentWidth, viewWidth;\n\t    var firstVisibleElementInd = views.length === 0 ? 0 : binarySearchFirstItem(views, isElementBottomBelowViewTop);\n\t\n\t    for (var i = firstVisibleElementInd, ii = views.length; i < ii; i++) {\n\t      view = views[i];\n\t      element = view.div;\n\t      currentHeight = element.offsetTop + element.clientTop;\n\t      viewHeight = element.clientHeight;\n\t\n\t      if (currentHeight > bottom) {\n\t        break;\n\t      }\n\t\n\t      currentWidth = element.offsetLeft + element.clientLeft;\n\t      viewWidth = element.clientWidth;\n\t      if (currentWidth + viewWidth < left || currentWidth > right) {\n\t        continue;\n\t      }\n\t      hiddenHeight = Math.max(0, top - currentHeight) + Math.max(0, currentHeight + viewHeight - bottom);\n\t      percentHeight = (viewHeight - hiddenHeight) * 100 / viewHeight | 0;\n\t\n\t      visible.push({\n\t        id: view.id,\n\t        x: currentWidth,\n\t        y: currentHeight,\n\t        view: view,\n\t        percent: percentHeight\n\t      });\n\t    }\n\t\n\t    var first = visible[0];\n\t    var last = visible[visible.length - 1];\n\t\n\t    if (sortByVisibility) {\n\t      visible.sort(function (a, b) {\n\t        var pc = a.percent - b.percent;\n\t        if (Math.abs(pc) > 0.001) {\n\t          return -pc;\n\t        }\n\t        return a.id - b.id; // ensure stability\n\t      });\n\t    }\n\t    return { first: first, last: last, views: visible };\n\t  }\n\t\n\t  /**\n\t   * Event handler to suppress context menu.\n\t   */\n\t  function noContextMenuHandler(e) {\n\t    e.preventDefault();\n\t  }\n\t\n\t  /**\n\t   * Returns the filename or guessed filename from the url (see issue 3455).\n\t   * url {String} The original PDF location.\n\t   * @return {String} Guessed PDF file name.\n\t   */\n\t  function getPDFFileNameFromURL(url) {\n\t    var reURI = /^(?:([^:]+:)?\\/\\/[^\\/]+)?([^?#]*)(\\?[^#]*)?(#.*)?$/;\n\t    //            SCHEME      HOST         1.PATH  2.QUERY   3.REF\n\t    // Pattern to get last matching NAME.pdf\n\t    var reFilename = /[^\\/?#=]+\\.pdf\\b(?!.*\\.pdf\\b)/i;\n\t    var splitURI = reURI.exec(url);\n\t    var suggestedFilename = reFilename.exec(splitURI[1]) || reFilename.exec(splitURI[2]) || reFilename.exec(splitURI[3]);\n\t    if (suggestedFilename) {\n\t      suggestedFilename = suggestedFilename[0];\n\t      if (suggestedFilename.indexOf('%') !== -1) {\n\t        // URL-encoded %2Fpath%2Fto%2Ffile.pdf should be file.pdf\n\t        try {\n\t          suggestedFilename = reFilename.exec(decodeURIComponent(suggestedFilename))[0];\n\t        } catch (e) {// Possible (extremely rare) errors:\n\t          // URIError \"Malformed URI\", e.g. for \"%AA.pdf\"\n\t          // TypeError \"null has no properties\", e.g. for \"%2F.pdf\"\n\t        }\n\t      }\n\t    }\n\t    return suggestedFilename || 'document.pdf';\n\t  }\n\t\n\t  var ProgressBar = function ProgressBarClosure() {\n\t\n\t    function clamp(v, min, max) {\n\t      return Math.min(Math.max(v, min), max);\n\t    }\n\t\n\t    function ProgressBar(id, opts) {\n\t      this.visible = true;\n\t\n\t      // Fetch the sub-elements for later.\n\t      this.div = document.querySelector(id + ' .progress');\n\t\n\t      // Get the loading bar element, so it can be resized to fit the viewer.\n\t      this.bar = this.div.parentNode;\n\t\n\t      // Get options, with sensible defaults.\n\t      this.height = opts.height || 100;\n\t      this.width = opts.width || 100;\n\t      this.units = opts.units || '%';\n\t\n\t      // Initialize heights.\n\t      this.div.style.height = this.height + this.units;\n\t      this.percent = 0;\n\t    }\n\t\n\t    ProgressBar.prototype = {\n\t\n\t      updateBar: function ProgressBar_updateBar() {\n\t        if (this._indeterminate) {\n\t          this.div.classList.add('indeterminate');\n\t          this.div.style.width = this.width + this.units;\n\t          return;\n\t        }\n\t\n\t        this.div.classList.remove('indeterminate');\n\t        var progressSize = this.width * this._percent / 100;\n\t        this.div.style.width = progressSize + this.units;\n\t      },\n\t\n\t      get percent() {\n\t        return this._percent;\n\t      },\n\t\n\t      set percent(val) {\n\t        this._indeterminate = isNaN(val);\n\t        this._percent = clamp(val, 0, 100);\n\t        this.updateBar();\n\t      },\n\t\n\t      setWidth: function ProgressBar_setWidth(viewer) {\n\t        if (viewer) {\n\t          var container = viewer.parentNode;\n\t          var scrollbarWidth = container.offsetWidth - viewer.offsetWidth;\n\t          if (scrollbarWidth > 0) {\n\t            this.bar.setAttribute('style', 'width: calc(100% - ' + scrollbarWidth + 'px);');\n\t          }\n\t        }\n\t      },\n\t\n\t      hide: function ProgressBar_hide() {\n\t        if (!this.visible) {\n\t          return;\n\t        }\n\t        this.visible = false;\n\t        this.bar.classList.add('hidden');\n\t        document.body.classList.remove('loadingInProgress');\n\t      },\n\t\n\t      show: function ProgressBar_show() {\n\t        if (this.visible) {\n\t          return;\n\t        }\n\t        this.visible = true;\n\t        document.body.classList.add('loadingInProgress');\n\t        this.bar.classList.remove('hidden');\n\t      }\n\t    };\n\t\n\t    return ProgressBar;\n\t  }();\n\t\n\t  /**\n\t   * Performs navigation functions inside PDF, such as opening specified page,\n\t   * or destination.\n\t   * @class\n\t   * @implements {IPDFLinkService}\n\t   */\n\t  var PDFLinkService = function () {\n\t    /**\n\t     * @constructs PDFLinkService\n\t     */\n\t    function PDFLinkService() {\n\t      this.baseUrl = null;\n\t      this.pdfDocument = null;\n\t      this.pdfViewer = null;\n\t      this.pdfHistory = null;\n\t\n\t      this._pagesRefCache = null;\n\t    }\n\t\n\t    PDFLinkService.prototype = {\n\t      setDocument: function PDFLinkService_setDocument(pdfDocument, baseUrl) {\n\t        this.baseUrl = baseUrl;\n\t        this.pdfDocument = pdfDocument;\n\t        this._pagesRefCache = Object.create(null);\n\t      },\n\t\n\t      setViewer: function PDFLinkService_setViewer(pdfViewer) {\n\t        this.pdfViewer = pdfViewer;\n\t      },\n\t\n\t      setHistory: function PDFLinkService_setHistory(pdfHistory) {\n\t        this.pdfHistory = pdfHistory;\n\t      },\n\t\n\t      /**\n\t       * @returns {number}\n\t       */\n\t      get pagesCount() {\n\t        return this.pdfDocument.numPages;\n\t      },\n\t\n\t      /**\n\t       * @returns {number}\n\t       */\n\t      get page() {\n\t        return this.pdfViewer.currentPageNumber;\n\t      },\n\t\n\t      /**\n\t       * @param {number} value\n\t       */\n\t      set page(value) {\n\t        this.pdfViewer.currentPageNumber = value;\n\t      },\n\t\n\t      /**\n\t       * @param dest - The PDF destination object.\n\t       */\n\t      navigateTo: function PDFLinkService_navigateTo(dest) {\n\t        var destString = '';\n\t        var self = this;\n\t\n\t        var goToDestination = function goToDestination(destRef) {\n\t          // dest array looks like that: <page-ref> </XYZ|FitXXX> <args..>\n\t          var pageNumber = destRef instanceof Object ? self._pagesRefCache[destRef.num + ' ' + destRef.gen + ' R'] : destRef + 1;\n\t          if (pageNumber) {\n\t            if (pageNumber > self.pagesCount) {\n\t              pageNumber = self.pagesCount;\n\t            }\n\t            self.pdfViewer.scrollPageIntoView(pageNumber, dest);\n\t\n\t            if (self.pdfHistory) {\n\t              // Update the browsing history.\n\t              self.pdfHistory.push({\n\t                dest: dest,\n\t                hash: destString,\n\t                page: pageNumber\n\t              });\n\t            }\n\t          } else {\n\t            self.pdfDocument.getPageIndex(destRef).then(function (pageIndex) {\n\t              var pageNum = pageIndex + 1;\n\t              var cacheKey = destRef.num + ' ' + destRef.gen + ' R';\n\t              self._pagesRefCache[cacheKey] = pageNum;\n\t              goToDestination(destRef);\n\t            });\n\t          }\n\t        };\n\t\n\t        var destinationPromise;\n\t        if (typeof dest === 'string') {\n\t          destString = dest;\n\t          destinationPromise = this.pdfDocument.getDestination(dest);\n\t        } else {\n\t          destinationPromise = Promise.resolve(dest);\n\t        }\n\t        destinationPromise.then(function (destination) {\n\t          dest = destination;\n\t          if (!(destination instanceof Array)) {\n\t            return; // invalid destination\n\t          }\n\t          goToDestination(destination[0]);\n\t        });\n\t      },\n\t\n\t      /**\n\t       * @param dest - The PDF destination object.\n\t       * @returns {string} The hyperlink to the PDF object.\n\t       */\n\t      getDestinationHash: function PDFLinkService_getDestinationHash(dest) {\n\t        if (typeof dest === 'string') {\n\t          return this.getAnchorUrl('#' + escape(dest));\n\t        }\n\t        if (dest instanceof Array) {\n\t          var destRef = dest[0]; // see navigateTo method for dest format\n\t          var pageNumber = destRef instanceof Object ? this._pagesRefCache[destRef.num + ' ' + destRef.gen + ' R'] : destRef + 1;\n\t          if (pageNumber) {\n\t            var pdfOpenParams = this.getAnchorUrl('#page=' + pageNumber);\n\t            var destKind = dest[1];\n\t            if ((typeof destKind === 'undefined' ? 'undefined' : _typeof(destKind)) === 'object' && 'name' in destKind && destKind.name === 'XYZ') {\n\t              var scale = dest[4] || this.pdfViewer.currentScaleValue;\n\t              var scaleNumber = parseFloat(scale);\n\t              if (scaleNumber) {\n\t                scale = scaleNumber * 100;\n\t              }\n\t              pdfOpenParams += '&zoom=' + scale;\n\t              if (dest[2] || dest[3]) {\n\t                pdfOpenParams += ',' + (dest[2] || 0) + ',' + (dest[3] || 0);\n\t              }\n\t            }\n\t            return pdfOpenParams;\n\t          }\n\t        }\n\t        return this.getAnchorUrl('');\n\t      },\n\t\n\t      /**\n\t       * Prefix the full url on anchor links to make sure that links are resolved\n\t       * relative to the current URL instead of the one defined in <base href>.\n\t       * @param {String} anchor The anchor hash, including the #.\n\t       * @returns {string} The hyperlink to the PDF object.\n\t       */\n\t      getAnchorUrl: function PDFLinkService_getAnchorUrl(anchor) {\n\t        return (this.baseUrl || '') + anchor;\n\t      },\n\t\n\t      /**\n\t       * @param {string} hash\n\t       */\n\t      setHash: function PDFLinkService_setHash(hash) {\n\t        if (hash.indexOf('=') >= 0) {\n\t          var params = parseQueryString(hash);\n\t          // borrowing syntax from \"Parameters for Opening PDF Files\"\n\t          if ('nameddest' in params) {\n\t            if (this.pdfHistory) {\n\t              this.pdfHistory.updateNextHashParam(params.nameddest);\n\t            }\n\t            this.navigateTo(params.nameddest);\n\t            return;\n\t          }\n\t          var pageNumber, dest;\n\t          if ('page' in params) {\n\t            pageNumber = params.page | 0 || 1;\n\t          }\n\t          if ('zoom' in params) {\n\t            // Build the destination array.\n\t            var zoomArgs = params.zoom.split(','); // scale,left,top\n\t            var zoomArg = zoomArgs[0];\n\t            var zoomArgNumber = parseFloat(zoomArg);\n\t\n\t            if (zoomArg.indexOf('Fit') === -1) {\n\t              // If the zoomArg is a number, it has to get divided by 100. If it's\n\t              // a string, it should stay as it is.\n\t              dest = [null, { name: 'XYZ' }, zoomArgs.length > 1 ? zoomArgs[1] | 0 : null, zoomArgs.length > 2 ? zoomArgs[2] | 0 : null, zoomArgNumber ? zoomArgNumber / 100 : zoomArg];\n\t            } else {\n\t              if (zoomArg === 'Fit' || zoomArg === 'FitB') {\n\t                dest = [null, { name: zoomArg }];\n\t              } else if (zoomArg === 'FitH' || zoomArg === 'FitBH' || zoomArg === 'FitV' || zoomArg === 'FitBV') {\n\t                dest = [null, { name: zoomArg }, zoomArgs.length > 1 ? zoomArgs[1] | 0 : null];\n\t              } else if (zoomArg === 'FitR') {\n\t                if (zoomArgs.length !== 5) {\n\t                  console.error('PDFLinkService_setHash: ' + 'Not enough parameters for \\'FitR\\'.');\n\t                } else {\n\t                  dest = [null, { name: zoomArg }, zoomArgs[1] | 0, zoomArgs[2] | 0, zoomArgs[3] | 0, zoomArgs[4] | 0];\n\t                }\n\t              } else {\n\t                console.error('PDFLinkService_setHash: \\'' + zoomArg + '\\' is not a valid zoom value.');\n\t              }\n\t            }\n\t          }\n\t          if (dest) {\n\t            this.pdfViewer.scrollPageIntoView(pageNumber || this.page, dest);\n\t          } else if (pageNumber) {\n\t            this.page = pageNumber; // simple page\n\t          }\n\t          if ('pagemode' in params) {\n\t            var event = document.createEvent('CustomEvent');\n\t            event.initCustomEvent('pagemode', true, true, {\n\t              mode: params.pagemode\n\t            });\n\t            this.pdfViewer.container.dispatchEvent(event);\n\t          }\n\t        } else if (/^\\d+$/.test(hash)) {\n\t          // page number\n\t          this.page = hash;\n\t        } else {\n\t          // named destination\n\t          if (this.pdfHistory) {\n\t            this.pdfHistory.updateNextHashParam(unescape(hash));\n\t          }\n\t          this.navigateTo(unescape(hash));\n\t        }\n\t      },\n\t\n\t      /**\n\t       * @param {string} action\n\t       */\n\t      executeNamedAction: function PDFLinkService_executeNamedAction(action) {\n\t        // See PDF reference, table 8.45 - Named action\n\t        switch (action) {\n\t          case 'GoBack':\n\t            if (this.pdfHistory) {\n\t              this.pdfHistory.back();\n\t            }\n\t            break;\n\t\n\t          case 'GoForward':\n\t            if (this.pdfHistory) {\n\t              this.pdfHistory.forward();\n\t            }\n\t            break;\n\t\n\t          case 'NextPage':\n\t            this.page++;\n\t            break;\n\t\n\t          case 'PrevPage':\n\t            this.page--;\n\t            break;\n\t\n\t          case 'LastPage':\n\t            this.page = this.pagesCount;\n\t            break;\n\t\n\t          case 'FirstPage':\n\t            this.page = 1;\n\t            break;\n\t\n\t          default:\n\t            break; // No action according to spec\n\t        }\n\t\n\t        var event = document.createEvent('CustomEvent');\n\t        event.initCustomEvent('namedaction', true, true, {\n\t          action: action\n\t        });\n\t        this.pdfViewer.container.dispatchEvent(event);\n\t      },\n\t\n\t      /**\n\t       * @param {number} pageNum - page number.\n\t       * @param {Object} pageRef - reference to the page.\n\t       */\n\t      cachePageRef: function PDFLinkService_cachePageRef(pageNum, pageRef) {\n\t        var refStr = pageRef.num + ' ' + pageRef.gen + ' R';\n\t        this._pagesRefCache[refStr] = pageNum;\n\t      }\n\t    };\n\t\n\t    return PDFLinkService;\n\t  }();\n\t\n\t  var PresentationModeState = {\n\t    UNKNOWN: 0,\n\t    NORMAL: 1,\n\t    CHANGING: 2,\n\t    FULLSCREEN: 3\n\t  };\n\t\n\t  var IGNORE_CURRENT_POSITION_ON_ZOOM = false;\n\t  var DEFAULT_CACHE_SIZE = 10;\n\t\n\t  var CLEANUP_TIMEOUT = 30000;\n\t\n\t  var RenderingStates = {\n\t    INITIAL: 0,\n\t    RUNNING: 1,\n\t    PAUSED: 2,\n\t    FINISHED: 3\n\t  };\n\t\n\t  /**\n\t   * Controls rendering of the views for pages and thumbnails.\n\t   * @class\n\t   */\n\t  var PDFRenderingQueue = function PDFRenderingQueueClosure() {\n\t    /**\n\t     * @constructs\n\t     */\n\t    function PDFRenderingQueue() {\n\t      this.pdfViewer = null;\n\t      this.pdfThumbnailViewer = null;\n\t      this.onIdle = null;\n\t\n\t      this.highestPriorityPage = null;\n\t      this.idleTimeout = null;\n\t      this.printing = false;\n\t      this.isThumbnailViewEnabled = false;\n\t    }\n\t\n\t    PDFRenderingQueue.prototype = /** @lends PDFRenderingQueue.prototype */{\n\t      /**\n\t       * @param {PDFViewer} pdfViewer\n\t       */\n\t      setViewer: function PDFRenderingQueue_setViewer(pdfViewer) {\n\t        this.pdfViewer = pdfViewer;\n\t      },\n\t\n\t      /**\n\t       * @param {PDFThumbnailViewer} pdfThumbnailViewer\n\t       */\n\t      setThumbnailViewer: function PDFRenderingQueue_setThumbnailViewer(pdfThumbnailViewer) {\n\t        this.pdfThumbnailViewer = pdfThumbnailViewer;\n\t      },\n\t\n\t      /**\n\t       * @param {IRenderableView} view\n\t       * @returns {boolean}\n\t       */\n\t      isHighestPriority: function PDFRenderingQueue_isHighestPriority(view) {\n\t        return this.highestPriorityPage === view.renderingId;\n\t      },\n\t\n\t      renderHighestPriority: function PDFRenderingQueue_renderHighestPriority(currentlyVisiblePages) {\n\t        if (this.idleTimeout) {\n\t          clearTimeout(this.idleTimeout);\n\t          this.idleTimeout = null;\n\t        }\n\t\n\t        // Pages have a higher priority than thumbnails, so check them first.\n\t        if (this.pdfViewer.forceRendering(currentlyVisiblePages)) {\n\t          return;\n\t        }\n\t        // No pages needed rendering so check thumbnails.\n\t        if (this.pdfThumbnailViewer && this.isThumbnailViewEnabled) {\n\t          if (this.pdfThumbnailViewer.forceRendering()) {\n\t            return;\n\t          }\n\t        }\n\t\n\t        if (this.printing) {\n\t          // If printing is currently ongoing do not reschedule cleanup.\n\t          return;\n\t        }\n\t\n\t        if (this.onIdle) {\n\t          this.idleTimeout = setTimeout(this.onIdle.bind(this), CLEANUP_TIMEOUT);\n\t        }\n\t      },\n\t\n\t      getHighestPriority: function PDFRenderingQueue_getHighestPriority(visible, views, scrolledDown) {\n\t        // The state has changed figure out which page has the highest priority to\n\t        // render next (if any).\n\t        // Priority:\n\t        // 1 visible pages\n\t        // 2 if last scrolled down page after the visible pages\n\t        // 2 if last scrolled up page before the visible pages\n\t        var visibleViews = visible.views;\n\t\n\t        var numVisible = visibleViews.length;\n\t        if (numVisible === 0) {\n\t          return false;\n\t        }\n\t        for (var i = 0; i < numVisible; ++i) {\n\t          var view = visibleViews[i].view;\n\t          if (!this.isViewFinished(view)) {\n\t            return view;\n\t          }\n\t        }\n\t\n\t        // All the visible views have rendered, try to render next/previous pages.\n\t        if (scrolledDown) {\n\t          var nextPageIndex = visible.last.id;\n\t          // ID's start at 1 so no need to add 1.\n\t          if (views[nextPageIndex] && !this.isViewFinished(views[nextPageIndex])) {\n\t            return views[nextPageIndex];\n\t          }\n\t        } else {\n\t          var previousPageIndex = visible.first.id - 2;\n\t          if (views[previousPageIndex] && !this.isViewFinished(views[previousPageIndex])) {\n\t            return views[previousPageIndex];\n\t          }\n\t        }\n\t        // Everything that needs to be rendered has been.\n\t        return null;\n\t      },\n\t\n\t      /**\n\t       * @param {IRenderableView} view\n\t       * @returns {boolean}\n\t       */\n\t      isViewFinished: function PDFRenderingQueue_isViewFinished(view) {\n\t        return view.renderingState === RenderingStates.FINISHED;\n\t      },\n\t\n\t      /**\n\t       * Render a page or thumbnail view. This calls the appropriate function\n\t       * based on the views state. If the view is already rendered it will return\n\t       * false.\n\t       * @param {IRenderableView} view\n\t       */\n\t      renderView: function PDFRenderingQueue_renderView(view) {\n\t        var state = view.renderingState;\n\t        switch (state) {\n\t          case RenderingStates.FINISHED:\n\t            return false;\n\t          case RenderingStates.PAUSED:\n\t            this.highestPriorityPage = view.renderingId;\n\t            view.resume();\n\t            break;\n\t          case RenderingStates.RUNNING:\n\t            this.highestPriorityPage = view.renderingId;\n\t            break;\n\t          case RenderingStates.INITIAL:\n\t            this.highestPriorityPage = view.renderingId;\n\t            var continueRendering = function () {\n\t              this.renderHighestPriority();\n\t            }.bind(this);\n\t            view.draw().then(continueRendering, continueRendering);\n\t            break;\n\t        }\n\t        return true;\n\t      }\n\t    };\n\t\n\t    return PDFRenderingQueue;\n\t  }();\n\t\n\t  var TEXT_LAYER_RENDER_DELAY = 200; // ms\n\t\n\t  /**\n\t   * @typedef {Object} PDFPageViewOptions\n\t   * @property {HTMLDivElement} container - The viewer element.\n\t   * @property {number} id - The page unique ID (normally its number).\n\t   * @property {number} scale - The page scale display.\n\t   * @property {PageViewport} defaultViewport - The page viewport.\n\t   * @property {PDFRenderingQueue} renderingQueue - The rendering queue object.\n\t   * @property {IPDFTextLayerFactory} textLayerFactory\n\t   * @property {IPDFAnnotationLayerFactory} annotationLayerFactory\n\t   */\n\t\n\t  /**\n\t   * @class\n\t   * @implements {IRenderableView}\n\t   */\n\t  var PDFPageView = function PDFPageViewClosure() {\n\t    /**\n\t     * @constructs PDFPageView\n\t     * @param {PDFPageViewOptions} options\n\t     */\n\t    function PDFPageView(options) {\n\t      var container = options.container;\n\t      var id = options.id;\n\t      var scale = options.scale;\n\t      var defaultViewport = options.defaultViewport;\n\t      var renderingQueue = options.renderingQueue;\n\t      var textLayerFactory = options.textLayerFactory;\n\t      var annotationLayerFactory = options.annotationLayerFactory;\n\t\n\t      this.id = id;\n\t      this.renderingId = 'page' + id;\n\t\n\t      this.rotation = 0;\n\t      this.scale = scale || DEFAULT_SCALE;\n\t      this.viewport = defaultViewport;\n\t      this.pdfPageRotate = defaultViewport.rotation;\n\t      this.hasRestrictedScaling = false;\n\t\n\t      this.renderingQueue = renderingQueue;\n\t      this.textLayerFactory = textLayerFactory;\n\t      this.annotationLayerFactory = annotationLayerFactory;\n\t\n\t      this.renderingState = RenderingStates.INITIAL;\n\t      this.resume = null;\n\t\n\t      this.onBeforeDraw = null;\n\t      this.onAfterDraw = null;\n\t\n\t      this.textLayer = null;\n\t\n\t      this.zoomLayer = null;\n\t\n\t      this.annotationLayer = null;\n\t\n\t      var div = document.createElement('div');\n\t      div.id = 'pageContainer' + this.id;\n\t      div.className = 'page';\n\t      div.style.width = Math.floor(this.viewport.width) + 'px';\n\t      div.style.height = Math.floor(this.viewport.height) + 'px';\n\t      div.setAttribute('data-page-number', this.id);\n\t      this.div = div;\n\t\n\t      container.appendChild(div);\n\t    }\n\t\n\t    PDFPageView.prototype = {\n\t      setPdfPage: function PDFPageView_setPdfPage(pdfPage) {\n\t        this.pdfPage = pdfPage;\n\t        this.pdfPageRotate = pdfPage.rotate;\n\t        var totalRotation = (this.rotation + this.pdfPageRotate) % 360;\n\t        this.viewport = pdfPage.getViewport(this.scale * CSS_UNITS, totalRotation);\n\t        this.stats = pdfPage.stats;\n\t        this.reset();\n\t      },\n\t\n\t      destroy: function PDFPageView_destroy() {\n\t        this.zoomLayer = null;\n\t        this.reset();\n\t        if (this.pdfPage) {\n\t          this.pdfPage.cleanup();\n\t        }\n\t      },\n\t\n\t      reset: function PDFPageView_reset(keepZoomLayer, keepAnnotations) {\n\t        if (this.renderTask) {\n\t          this.renderTask.cancel();\n\t        }\n\t        this.resume = null;\n\t        this.renderingState = RenderingStates.INITIAL;\n\t\n\t        var div = this.div;\n\t        div.style.width = Math.floor(this.viewport.width) + 'px';\n\t        div.style.height = Math.floor(this.viewport.height) + 'px';\n\t\n\t        var childNodes = div.childNodes;\n\t        var currentZoomLayerNode = keepZoomLayer && this.zoomLayer || null;\n\t        var currentAnnotationNode = keepAnnotations && this.annotationLayer && this.annotationLayer.div || null;\n\t        for (var i = childNodes.length - 1; i >= 0; i--) {\n\t          var node = childNodes[i];\n\t          if (currentZoomLayerNode === node || currentAnnotationNode === node) {\n\t            continue;\n\t          }\n\t          div.removeChild(node);\n\t        }\n\t        div.removeAttribute('data-loaded');\n\t\n\t        if (currentAnnotationNode) {\n\t          // Hide annotationLayer until all elements are resized\n\t          // so they are not displayed on the already-resized page\n\t          this.annotationLayer.hide();\n\t        } else {\n\t          this.annotationLayer = null;\n\t        }\n\t\n\t        if (this.canvas && !currentZoomLayerNode) {\n\t          // Zeroing the width and height causes Firefox to release graphics\n\t          // resources immediately, which can greatly reduce memory consumption.\n\t          this.canvas.width = 0;\n\t          this.canvas.height = 0;\n\t          delete this.canvas;\n\t        }\n\t\n\t        this.loadingIconDiv = document.createElement('div');\n\t        this.loadingIconDiv.className = 'loadingIcon';\n\t        div.appendChild(this.loadingIconDiv);\n\t      },\n\t\n\t      update: function PDFPageView_update(scale, rotation) {\n\t        this.scale = scale || this.scale;\n\t\n\t        if (typeof rotation !== 'undefined') {\n\t          this.rotation = rotation;\n\t        }\n\t\n\t        var totalRotation = (this.rotation + this.pdfPageRotate) % 360;\n\t        this.viewport = this.viewport.clone({\n\t          scale: this.scale * CSS_UNITS,\n\t          rotation: totalRotation\n\t        });\n\t\n\t        var isScalingRestricted = false;\n\t        if (this.canvas && PDFJS.maxCanvasPixels > 0) {\n\t          var outputScale = this.outputScale;\n\t          var pixelsInViewport = this.viewport.width * this.viewport.height;\n\t          var maxScale = Math.sqrt(PDFJS.maxCanvasPixels / pixelsInViewport);\n\t          if ((Math.floor(this.viewport.width) * outputScale.sx | 0) * (Math.floor(this.viewport.height) * outputScale.sy | 0) > PDFJS.maxCanvasPixels) {\n\t            isScalingRestricted = true;\n\t          }\n\t        }\n\t\n\t        if (this.canvas) {\n\t          if (PDFJS.useOnlyCssZoom || this.hasRestrictedScaling && isScalingRestricted) {\n\t            this.cssTransform(this.canvas, true);\n\t\n\t            var event = document.createEvent('CustomEvent');\n\t            event.initCustomEvent('pagerendered', true, true, {\n\t              pageNumber: this.id,\n\t              cssTransform: true\n\t            });\n\t            this.div.dispatchEvent(event);\n\t\n\t            return;\n\t          }\n\t          if (!this.zoomLayer) {\n\t            this.zoomLayer = this.canvas.parentNode;\n\t            this.zoomLayer.style.position = 'absolute';\n\t          }\n\t        }\n\t        if (this.zoomLayer) {\n\t          this.cssTransform(this.zoomLayer.firstChild);\n\t        }\n\t        this.reset( /* keepZoomLayer = */true, /* keepAnnotations = */true);\n\t      },\n\t\n\t      /**\n\t       * Called when moved in the parent's container.\n\t       */\n\t      updatePosition: function PDFPageView_updatePosition() {\n\t        if (this.textLayer) {\n\t          this.textLayer.render(TEXT_LAYER_RENDER_DELAY);\n\t        }\n\t      },\n\t\n\t      cssTransform: function PDFPageView_transform(canvas, redrawAnnotations) {\n\t        var CustomStyle = PDFJS.CustomStyle;\n\t\n\t        // Scale canvas, canvas wrapper, and page container.\n\t        var width = this.viewport.width;\n\t        var height = this.viewport.height;\n\t        var div = this.div;\n\t        canvas.style.width = canvas.parentNode.style.width = div.style.width = Math.floor(width) + 'px';\n\t        canvas.style.height = canvas.parentNode.style.height = div.style.height = Math.floor(height) + 'px';\n\t        // The canvas may have been originally rotated, rotate relative to that.\n\t        var relativeRotation = this.viewport.rotation - canvas._viewport.rotation;\n\t        var absRotation = Math.abs(relativeRotation);\n\t        var scaleX = 1,\n\t            scaleY = 1;\n\t        if (absRotation === 90 || absRotation === 270) {\n\t          // Scale x and y because of the rotation.\n\t          scaleX = height / width;\n\t          scaleY = width / height;\n\t        }\n\t        var cssTransform = 'rotate(' + relativeRotation + 'deg) ' + 'scale(' + scaleX + ',' + scaleY + ')';\n\t        CustomStyle.setProp('transform', canvas, cssTransform);\n\t\n\t        if (this.textLayer) {\n\t          // Rotating the text layer is more complicated since the divs inside the\n\t          // the text layer are rotated.\n\t          // TODO: This could probably be simplified by drawing the text layer in\n\t          // one orientation then rotating overall.\n\t          var textLayerViewport = this.textLayer.viewport;\n\t          var textRelativeRotation = this.viewport.rotation - textLayerViewport.rotation;\n\t          var textAbsRotation = Math.abs(textRelativeRotation);\n\t          var scale = width / textLayerViewport.width;\n\t          if (textAbsRotation === 90 || textAbsRotation === 270) {\n\t            scale = width / textLayerViewport.height;\n\t          }\n\t          var textLayerDiv = this.textLayer.textLayerDiv;\n\t          var transX, transY;\n\t          switch (textAbsRotation) {\n\t            case 0:\n\t              transX = transY = 0;\n\t              break;\n\t            case 90:\n\t              transX = 0;\n\t              transY = '-' + textLayerDiv.style.height;\n\t              break;\n\t            case 180:\n\t              transX = '-' + textLayerDiv.style.width;\n\t              transY = '-' + textLayerDiv.style.height;\n\t              break;\n\t            case 270:\n\t              transX = '-' + textLayerDiv.style.width;\n\t              transY = 0;\n\t              break;\n\t            default:\n\t              console.error('Bad rotation value.');\n\t              break;\n\t          }\n\t          CustomStyle.setProp('transform', textLayerDiv, 'rotate(' + textAbsRotation + 'deg) ' + 'scale(' + scale + ', ' + scale + ') ' + 'translate(' + transX + ', ' + transY + ')');\n\t          CustomStyle.setProp('transformOrigin', textLayerDiv, '0% 0%');\n\t        }\n\t\n\t        if (redrawAnnotations && this.annotationLayer) {\n\t          this.annotationLayer.render(this.viewport, 'display');\n\t        }\n\t      },\n\t\n\t      get width() {\n\t        return this.viewport.width;\n\t      },\n\t\n\t      get height() {\n\t        return this.viewport.height;\n\t      },\n\t\n\t      getPagePoint: function PDFPageView_getPagePoint(x, y) {\n\t        return this.viewport.convertToPdfPoint(x, y);\n\t      },\n\t\n\t      draw: function PDFPageView_draw() {\n\t        if (this.renderingState !== RenderingStates.INITIAL) {\n\t          console.error('Must be in new state before drawing');\n\t        }\n\t\n\t        this.renderingState = RenderingStates.RUNNING;\n\t\n\t        var pdfPage = this.pdfPage;\n\t        var viewport = this.viewport;\n\t        var div = this.div;\n\t        // Wrap the canvas so if it has a css transform for highdpi the overflow\n\t        // will be hidden in FF.\n\t        var canvasWrapper = document.createElement('div');\n\t        canvasWrapper.style.width = div.style.width;\n\t        canvasWrapper.style.height = div.style.height;\n\t        canvasWrapper.classList.add('canvasWrapper');\n\t\n\t        var canvas = document.createElement('canvas');\n\t        canvas.id = 'page' + this.id;\n\t        // Keep the canvas hidden until the first draw callback, or until drawing\n\t        // is complete when `!this.renderingQueue`, to prevent black flickering.\n\t        canvas.setAttribute('hidden', 'hidden');\n\t        var isCanvasHidden = true;\n\t\n\t        canvasWrapper.appendChild(canvas);\n\t        if (this.annotationLayer && this.annotationLayer.div) {\n\t          // annotationLayer needs to stay on top\n\t          div.insertBefore(canvasWrapper, this.annotationLayer.div);\n\t        } else {\n\t          div.appendChild(canvasWrapper);\n\t        }\n\t        this.canvas = canvas;\n\t\n\t        var ctx = canvas.getContext('2d', { alpha: false });\n\t        var outputScale = getOutputScale(ctx);\n\t        this.outputScale = outputScale;\n\t\n\t        if (PDFJS.useOnlyCssZoom) {\n\t          var actualSizeViewport = viewport.clone({ scale: CSS_UNITS });\n\t          // Use a scale that will make the canvas be the original intended size\n\t          // of the page.\n\t          outputScale.sx *= actualSizeViewport.width / viewport.width;\n\t          outputScale.sy *= actualSizeViewport.height / viewport.height;\n\t          outputScale.scaled = true;\n\t        }\n\t\n\t        if (PDFJS.maxCanvasPixels > 0) {\n\t          var pixelsInViewport = viewport.width * viewport.height;\n\t          var maxScale = Math.sqrt(PDFJS.maxCanvasPixels / pixelsInViewport);\n\t          if (outputScale.sx > maxScale || outputScale.sy > maxScale) {\n\t            outputScale.sx = maxScale;\n\t            outputScale.sy = maxScale;\n\t            outputScale.scaled = true;\n\t            this.hasRestrictedScaling = true;\n\t          } else {\n\t            this.hasRestrictedScaling = false;\n\t          }\n\t        }\n\t\n\t        var sfx = approximateFraction(outputScale.sx);\n\t        var sfy = approximateFraction(outputScale.sy);\n\t        canvas.width = roundToDivide(viewport.width * outputScale.sx, sfx[0]);\n\t        canvas.height = roundToDivide(viewport.height * outputScale.sy, sfy[0]);\n\t        canvas.style.width = roundToDivide(viewport.width, sfx[1]) + 'px';\n\t        canvas.style.height = roundToDivide(viewport.height, sfy[1]) + 'px';\n\t        // Add the viewport so it's known what it was originally drawn with.\n\t        canvas._viewport = viewport;\n\t\n\t        var textLayerDiv = null;\n\t        var textLayer = null;\n\t        if (this.textLayerFactory) {\n\t          textLayerDiv = document.createElement('div');\n\t          textLayerDiv.className = 'textLayer';\n\t          textLayerDiv.style.width = canvasWrapper.style.width;\n\t          textLayerDiv.style.height = canvasWrapper.style.height;\n\t          if (this.annotationLayer && this.annotationLayer.div) {\n\t            // annotationLayer needs to stay on top\n\t            div.insertBefore(textLayerDiv, this.annotationLayer.div);\n\t          } else {\n\t            div.appendChild(textLayerDiv);\n\t          }\n\t\n\t          textLayer = this.textLayerFactory.createTextLayerBuilder(textLayerDiv, this.id - 1, this.viewport);\n\t        }\n\t        this.textLayer = textLayer;\n\t\n\t        var resolveRenderPromise, rejectRenderPromise;\n\t        var promise = new Promise(function (resolve, reject) {\n\t          resolveRenderPromise = resolve;\n\t          rejectRenderPromise = reject;\n\t        });\n\t\n\t        // Rendering area\n\t\n\t        var self = this;\n\t        function pageViewDrawCallback(error) {\n\t          // The renderTask may have been replaced by a new one, so only remove\n\t          // the reference to the renderTask if it matches the one that is\n\t          // triggering this callback.\n\t          if (renderTask === self.renderTask) {\n\t            self.renderTask = null;\n\t          }\n\t\n\t          if (error === 'cancelled') {\n\t            rejectRenderPromise(error);\n\t            return;\n\t          }\n\t\n\t          self.renderingState = RenderingStates.FINISHED;\n\t\n\t          if (isCanvasHidden) {\n\t            self.canvas.removeAttribute('hidden');\n\t            isCanvasHidden = false;\n\t          }\n\t\n\t          if (self.loadingIconDiv) {\n\t            div.removeChild(self.loadingIconDiv);\n\t            delete self.loadingIconDiv;\n\t          }\n\t\n\t          if (self.zoomLayer) {\n\t            // Zeroing the width and height causes Firefox to release graphics\n\t            // resources immediately, which can greatly reduce memory consumption.\n\t            var zoomLayerCanvas = self.zoomLayer.firstChild;\n\t            zoomLayerCanvas.width = 0;\n\t            zoomLayerCanvas.height = 0;\n\t\n\t            div.removeChild(self.zoomLayer);\n\t            self.zoomLayer = null;\n\t          }\n\t\n\t          self.error = error;\n\t          self.stats = pdfPage.stats;\n\t          if (self.onAfterDraw) {\n\t            self.onAfterDraw();\n\t          }\n\t          var event = document.createEvent('CustomEvent');\n\t          event.initCustomEvent('pagerendered', true, true, {\n\t            pageNumber: self.id,\n\t            cssTransform: false\n\t          });\n\t          div.dispatchEvent(event);\n\t\n\t          if (!error) {\n\t            resolveRenderPromise(undefined);\n\t          } else {\n\t            rejectRenderPromise(error);\n\t          }\n\t        }\n\t\n\t        var renderContinueCallback = null;\n\t        if (this.renderingQueue) {\n\t          renderContinueCallback = function renderContinueCallback(cont) {\n\t            if (!self.renderingQueue.isHighestPriority(self)) {\n\t              self.renderingState = RenderingStates.PAUSED;\n\t              self.resume = function resumeCallback() {\n\t                self.renderingState = RenderingStates.RUNNING;\n\t                cont();\n\t              };\n\t              return;\n\t            }\n\t            if (isCanvasHidden) {\n\t              self.canvas.removeAttribute('hidden');\n\t              isCanvasHidden = false;\n\t            }\n\t            cont();\n\t          };\n\t        }\n\t\n\t        var transform = !outputScale.scaled ? null : [outputScale.sx, 0, 0, outputScale.sy, 0, 0];\n\t        var renderContext = {\n\t          canvasContext: ctx,\n\t          transform: transform,\n\t          viewport: this.viewport\n\t        };\n\t        var renderTask = this.renderTask = this.pdfPage.render(renderContext);\n\t        renderTask.onContinue = renderContinueCallback;\n\t\n\t        this.renderTask.promise.then(function pdfPageRenderCallback() {\n\t          pageViewDrawCallback(null);\n\t          if (textLayer) {\n\t            self.pdfPage.getTextContent({ normalizeWhitespace: true }).then(function textContentResolved(textContent) {\n\t              textLayer.setTextContent(textContent);\n\t              textLayer.render(TEXT_LAYER_RENDER_DELAY);\n\t            });\n\t          }\n\t        }, function pdfPageRenderError(error) {\n\t          pageViewDrawCallback(error);\n\t        });\n\t\n\t        if (this.annotationLayerFactory) {\n\t          if (!this.annotationLayer) {\n\t            this.annotationLayer = this.annotationLayerFactory.createAnnotationLayerBuilder(div, this.pdfPage);\n\t          }\n\t          this.annotationLayer.render(this.viewport, 'display');\n\t        }\n\t        div.setAttribute('data-loaded', true);\n\t\n\t        if (self.onBeforeDraw) {\n\t          self.onBeforeDraw();\n\t        }\n\t        return promise;\n\t      },\n\t\n\t      beforePrint: function PDFPageView_beforePrint() {\n\t        var CustomStyle = PDFJS.CustomStyle;\n\t        var pdfPage = this.pdfPage;\n\t\n\t        var viewport = pdfPage.getViewport(1);\n\t        // Use the same hack we use for high dpi displays for printing to get\n\t        // better output until bug 811002 is fixed in FF.\n\t        var PRINT_OUTPUT_SCALE = 2;\n\t        var canvas = document.createElement('canvas');\n\t\n\t        // The logical size of the canvas.\n\t        canvas.width = Math.floor(viewport.width) * PRINT_OUTPUT_SCALE;\n\t        canvas.height = Math.floor(viewport.height) * PRINT_OUTPUT_SCALE;\n\t\n\t        // The rendered size of the canvas, relative to the size of canvasWrapper.\n\t        canvas.style.width = PRINT_OUTPUT_SCALE * 100 + '%';\n\t        canvas.style.height = PRINT_OUTPUT_SCALE * 100 + '%';\n\t\n\t        var cssScale = 'scale(' + 1 / PRINT_OUTPUT_SCALE + ', ' + 1 / PRINT_OUTPUT_SCALE + ')';\n\t        CustomStyle.setProp('transform', canvas, cssScale);\n\t        CustomStyle.setProp('transformOrigin', canvas, '0% 0%');\n\t\n\t        var printContainer = document.getElementById('printContainer');\n\t        var canvasWrapper = document.createElement('div');\n\t        canvasWrapper.style.width = viewport.width + 'pt';\n\t        canvasWrapper.style.height = viewport.height + 'pt';\n\t        canvasWrapper.appendChild(canvas);\n\t        printContainer.appendChild(canvasWrapper);\n\t\n\t        canvas.mozPrintCallback = function (obj) {\n\t          var ctx = obj.context;\n\t\n\t          ctx.save();\n\t          ctx.fillStyle = 'rgb(255, 255, 255)';\n\t          ctx.fillRect(0, 0, canvas.width, canvas.height);\n\t          ctx.restore();\n\t          // Used by the mozCurrentTransform polyfill in src/display/canvas.js.\n\t          ctx._transformMatrix = [PRINT_OUTPUT_SCALE, 0, 0, PRINT_OUTPUT_SCALE, 0, 0];\n\t          ctx.scale(PRINT_OUTPUT_SCALE, PRINT_OUTPUT_SCALE);\n\t\n\t          var renderContext = {\n\t            canvasContext: ctx,\n\t            viewport: viewport,\n\t            intent: 'print'\n\t          };\n\t\n\t          pdfPage.render(renderContext).promise.then(function () {\n\t            // Tell the printEngine that rendering this canvas/page has finished.\n\t            obj.done();\n\t          }, function (error) {\n\t            console.error(error);\n\t            // Tell the printEngine that rendering this canvas/page has failed.\n\t            // This will make the print proces stop.\n\t            if ('abort' in obj) {\n\t              obj.abort();\n\t            } else {\n\t              obj.done();\n\t            }\n\t          });\n\t        };\n\t      }\n\t    };\n\t\n\t    return PDFPageView;\n\t  }();\n\t\n\t  /**\n\t   * @typedef {Object} TextLayerBuilderOptions\n\t   * @property {HTMLDivElement} textLayerDiv - The text layer container.\n\t   * @property {number} pageIndex - The page index.\n\t   * @property {PageViewport} viewport - The viewport of the text layer.\n\t   * @property {PDFFindController} findController\n\t   */\n\t\n\t  /**\n\t   * TextLayerBuilder provides text-selection functionality for the PDF.\n\t   * It does this by creating overlay divs over the PDF text. These divs\n\t   * contain text that matches the PDF text they are overlaying. This object\n\t   * also provides a way to highlight text that is being searched for.\n\t   * @class\n\t   */\n\t  var TextLayerBuilder = function TextLayerBuilderClosure() {\n\t    function TextLayerBuilder(options) {\n\t      this.textLayerDiv = options.textLayerDiv;\n\t      this.renderingDone = false;\n\t      this.divContentDone = false;\n\t      this.pageIdx = options.pageIndex;\n\t      this.pageNumber = this.pageIdx + 1;\n\t      this.matches = [];\n\t      this.viewport = options.viewport;\n\t      this.textDivs = [];\n\t      this.findController = options.findController || null;\n\t      this.textLayerRenderTask = null;\n\t      this._bindMouse();\n\t    }\n\t\n\t    TextLayerBuilder.prototype = {\n\t      _finishRendering: function TextLayerBuilder_finishRendering() {\n\t        this.renderingDone = true;\n\t\n\t        var endOfContent = document.createElement('div');\n\t        endOfContent.className = 'endOfContent';\n\t        this.textLayerDiv.appendChild(endOfContent);\n\t\n\t        var event = document.createEvent('CustomEvent');\n\t        event.initCustomEvent('textlayerrendered', true, true, {\n\t          pageNumber: this.pageNumber\n\t        });\n\t        this.textLayerDiv.dispatchEvent(event);\n\t      },\n\t\n\t      /**\n\t       * Renders the text layer.\n\t       * @param {number} timeout (optional) if specified, the rendering waits\n\t       *   for specified amount of ms.\n\t       */\n\t      render: function TextLayerBuilder_render(timeout) {\n\t        if (!this.divContentDone || this.renderingDone) {\n\t          return;\n\t        }\n\t\n\t        if (this.textLayerRenderTask) {\n\t          this.textLayerRenderTask.cancel();\n\t          this.textLayerRenderTask = null;\n\t        }\n\t\n\t        this.textDivs = [];\n\t        var textLayerFrag = document.createDocumentFragment();\n\t        this.textLayerRenderTask = PDFJS.renderTextLayer({\n\t          textContent: this.textContent,\n\t          container: textLayerFrag,\n\t          viewport: this.viewport,\n\t          textDivs: this.textDivs,\n\t          timeout: timeout\n\t        });\n\t        this.textLayerRenderTask.promise.then(function () {\n\t          this.textLayerDiv.appendChild(textLayerFrag);\n\t          this._finishRendering();\n\t          this.updateMatches();\n\t        }.bind(this), function (reason) {\n\t          // canceled or failed to render text layer -- skipping errors\n\t        });\n\t      },\n\t\n\t      setTextContent: function TextLayerBuilder_setTextContent(textContent) {\n\t        if (this.textLayerRenderTask) {\n\t          this.textLayerRenderTask.cancel();\n\t          this.textLayerRenderTask = null;\n\t        }\n\t        this.textContent = textContent;\n\t        this.divContentDone = true;\n\t      },\n\t\n\t      convertMatches: function TextLayerBuilder_convertMatches(matches) {\n\t        var i = 0;\n\t        var iIndex = 0;\n\t        var bidiTexts = this.textContent.items;\n\t        var end = bidiTexts.length - 1;\n\t        var queryLen = this.findController === null ? 0 : this.findController.state.query.length;\n\t        var ret = [];\n\t\n\t        for (var m = 0, len = matches.length; m < len; m++) {\n\t          // Calculate the start position.\n\t          var matchIdx = matches[m];\n\t\n\t          // Loop over the divIdxs.\n\t          while (i !== end && matchIdx >= iIndex + bidiTexts[i].str.length) {\n\t            iIndex += bidiTexts[i].str.length;\n\t            i++;\n\t          }\n\t\n\t          if (i === bidiTexts.length) {\n\t            console.error('Could not find a matching mapping');\n\t          }\n\t\n\t          var match = {\n\t            begin: {\n\t              divIdx: i,\n\t              offset: matchIdx - iIndex\n\t            }\n\t          };\n\t\n\t          // Calculate the end position.\n\t          matchIdx += queryLen;\n\t\n\t          // Somewhat the same array as above, but use > instead of >= to get\n\t          // the end position right.\n\t          while (i !== end && matchIdx > iIndex + bidiTexts[i].str.length) {\n\t            iIndex += bidiTexts[i].str.length;\n\t            i++;\n\t          }\n\t\n\t          match.end = {\n\t            divIdx: i,\n\t            offset: matchIdx - iIndex\n\t          };\n\t          ret.push(match);\n\t        }\n\t\n\t        return ret;\n\t      },\n\t\n\t      renderMatches: function TextLayerBuilder_renderMatches(matches) {\n\t        // Early exit if there is nothing to render.\n\t        if (matches.length === 0) {\n\t          return;\n\t        }\n\t\n\t        var bidiTexts = this.textContent.items;\n\t        var textDivs = this.textDivs;\n\t        var prevEnd = null;\n\t        var pageIdx = this.pageIdx;\n\t        var isSelectedPage = this.findController === null ? false : pageIdx === this.findController.selected.pageIdx;\n\t        var selectedMatchIdx = this.findController === null ? -1 : this.findController.selected.matchIdx;\n\t        var highlightAll = this.findController === null ? false : this.findController.state.highlightAll;\n\t        var infinity = {\n\t          divIdx: -1,\n\t          offset: undefined\n\t        };\n\t\n\t        function beginText(begin, className) {\n\t          var divIdx = begin.divIdx;\n\t          textDivs[divIdx].textContent = '';\n\t          appendTextToDiv(divIdx, 0, begin.offset, className);\n\t        }\n\t\n\t        function appendTextToDiv(divIdx, fromOffset, toOffset, className) {\n\t          var div = textDivs[divIdx];\n\t          var content = bidiTexts[divIdx].str.substring(fromOffset, toOffset);\n\t          var node = document.createTextNode(content);\n\t          if (className) {\n\t            var span = document.createElement('span');\n\t            span.className = className;\n\t            span.appendChild(node);\n\t            div.appendChild(span);\n\t            return;\n\t          }\n\t          div.appendChild(node);\n\t        }\n\t\n\t        var i0 = selectedMatchIdx,\n\t            i1 = i0 + 1;\n\t        if (highlightAll) {\n\t          i0 = 0;\n\t          i1 = matches.length;\n\t        } else if (!isSelectedPage) {\n\t          // Not highlighting all and this isn't the selected page, so do nothing.\n\t          return;\n\t        }\n\t\n\t        for (var i = i0; i < i1; i++) {\n\t          var match = matches[i];\n\t          var begin = match.begin;\n\t          var end = match.end;\n\t          var isSelected = isSelectedPage && i === selectedMatchIdx;\n\t          var highlightSuffix = isSelected ? ' selected' : '';\n\t\n\t          if (this.findController) {\n\t            this.findController.updateMatchPosition(pageIdx, i, textDivs, begin.divIdx, end.divIdx);\n\t          }\n\t\n\t          // Match inside new div.\n\t          if (!prevEnd || begin.divIdx !== prevEnd.divIdx) {\n\t            // If there was a previous div, then add the text at the end.\n\t            if (prevEnd !== null) {\n\t              appendTextToDiv(prevEnd.divIdx, prevEnd.offset, infinity.offset);\n\t            }\n\t            // Clear the divs and set the content until the starting point.\n\t            beginText(begin);\n\t          } else {\n\t            appendTextToDiv(prevEnd.divIdx, prevEnd.offset, begin.offset);\n\t          }\n\t\n\t          if (begin.divIdx === end.divIdx) {\n\t            appendTextToDiv(begin.divIdx, begin.offset, end.offset, 'highlight' + highlightSuffix);\n\t          } else {\n\t            appendTextToDiv(begin.divIdx, begin.offset, infinity.offset, 'highlight begin' + highlightSuffix);\n\t            for (var n0 = begin.divIdx + 1, n1 = end.divIdx; n0 < n1; n0++) {\n\t              textDivs[n0].className = 'highlight middle' + highlightSuffix;\n\t            }\n\t            beginText(end, 'highlight end' + highlightSuffix);\n\t          }\n\t          prevEnd = end;\n\t        }\n\t\n\t        if (prevEnd) {\n\t          appendTextToDiv(prevEnd.divIdx, prevEnd.offset, infinity.offset);\n\t        }\n\t      },\n\t\n\t      updateMatches: function TextLayerBuilder_updateMatches() {\n\t        // Only show matches when all rendering is done.\n\t        if (!this.renderingDone) {\n\t          return;\n\t        }\n\t\n\t        // Clear all matches.\n\t        var matches = this.matches;\n\t        var textDivs = this.textDivs;\n\t        var bidiTexts = this.textContent.items;\n\t        var clearedUntilDivIdx = -1;\n\t\n\t        // Clear all current matches.\n\t        for (var i = 0, len = matches.length; i < len; i++) {\n\t          var match = matches[i];\n\t          var begin = Math.max(clearedUntilDivIdx, match.begin.divIdx);\n\t          for (var n = begin, end = match.end.divIdx; n <= end; n++) {\n\t            var div = textDivs[n];\n\t            div.textContent = bidiTexts[n].str;\n\t            div.className = '';\n\t          }\n\t          clearedUntilDivIdx = match.end.divIdx + 1;\n\t        }\n\t\n\t        if (this.findController === null || !this.findController.active) {\n\t          return;\n\t        }\n\t\n\t        // Convert the matches on the page controller into the match format\n\t        // used for the textLayer.\n\t        this.matches = this.convertMatches(this.findController === null ? [] : this.findController.pageMatches[this.pageIdx] || []);\n\t        this.renderMatches(this.matches);\n\t      },\n\t\n\t      /**\n\t       * Fixes text selection: adds additional div where mouse was clicked.\n\t       * This reduces flickering of the content if mouse slowly dragged down/up.\n\t       * @private\n\t       */\n\t      _bindMouse: function TextLayerBuilder_bindMouse() {\n\t        var div = this.textLayerDiv;\n\t        div.addEventListener('mousedown', function (e) {\n\t          var end = div.querySelector('.endOfContent');\n\t          if (!end) {\n\t            return;\n\t          }\n\t          // On non-Firefox browsers, the selection will feel better if the height\n\t          // of the endOfContent div will be adjusted to start at mouse click\n\t          // location -- this will avoid flickering when selections moves up.\n\t          // However it does not work when selection started on empty space.\n\t          var adjustTop = e.target !== div;\n\t          if (adjustTop) {\n\t            var divBounds = div.getBoundingClientRect();\n\t            var r = Math.max(0, (e.pageY - divBounds.top) / divBounds.height);\n\t            end.style.top = (r * 100).toFixed(2) + '%';\n\t          }\n\t          end.classList.add('active');\n\t        });\n\t        div.addEventListener('mouseup', function (e) {\n\t          var end = div.querySelector('.endOfContent');\n\t          if (!end) {\n\t            return;\n\t          }\n\t          end.style.top = '';\n\t          end.classList.remove('active');\n\t        });\n\t      }\n\t    };\n\t    return TextLayerBuilder;\n\t  }();\n\t\n\t  /**\n\t   * @constructor\n\t   * @implements IPDFTextLayerFactory\n\t   */\n\t  function DefaultTextLayerFactory() {}\n\t  DefaultTextLayerFactory.prototype = {\n\t    /**\n\t     * @param {HTMLDivElement} textLayerDiv\n\t     * @param {number} pageIndex\n\t     * @param {PageViewport} viewport\n\t     * @returns {TextLayerBuilder}\n\t     */\n\t    createTextLayerBuilder: function createTextLayerBuilder(textLayerDiv, pageIndex, viewport) {\n\t      return new TextLayerBuilder({\n\t        textLayerDiv: textLayerDiv,\n\t        pageIndex: pageIndex,\n\t        viewport: viewport\n\t      });\n\t    }\n\t  };\n\t\n\t  /**\n\t   * @typedef {Object} AnnotationLayerBuilderOptions\n\t   * @property {HTMLDivElement} pageDiv\n\t   * @property {PDFPage} pdfPage\n\t   * @property {IPDFLinkService} linkService\n\t   */\n\t\n\t  /**\n\t   * @class\n\t   */\n\t  var AnnotationLayerBuilder = function AnnotationLayerBuilderClosure() {\n\t    /**\n\t     * @param {AnnotationLayerBuilderOptions} options\n\t     * @constructs AnnotationLayerBuilder\n\t     */\n\t    function AnnotationLayerBuilder(options) {\n\t      this.pageDiv = options.pageDiv;\n\t      this.pdfPage = options.pdfPage;\n\t      this.linkService = options.linkService;\n\t\n\t      this.div = null;\n\t    }\n\t\n\t    AnnotationLayerBuilder.prototype =\n\t    /** @lends AnnotationLayerBuilder.prototype */{\n\t\n\t      /**\n\t       * @param {PageViewport} viewport\n\t       * @param {string} intent (default value is 'display')\n\t       */\n\t      render: function AnnotationLayerBuilder_render(viewport, intent) {\n\t        var self = this;\n\t        var parameters = {\n\t          intent: intent === undefined ? 'display' : intent\n\t        };\n\t\n\t        this.pdfPage.getAnnotations(parameters).then(function (annotations) {\n\t          viewport = viewport.clone({ dontFlip: true });\n\t          parameters = {\n\t            viewport: viewport,\n\t            div: self.div,\n\t            annotations: annotations,\n\t            page: self.pdfPage,\n\t            linkService: self.linkService\n\t          };\n\t\n\t          if (self.div) {\n\t            // If an annotationLayer already exists, refresh its children's\n\t            // transformation matrices.\n\t            PDFJS.AnnotationLayer.update(parameters);\n\t          } else {\n\t            // Create an annotation layer div and render the annotations\n\t            // if there is at least one annotation.\n\t            if (annotations.length === 0) {\n\t              return;\n\t            }\n\t\n\t            self.div = document.createElement('div');\n\t            self.div.className = 'annotationLayer';\n\t            self.pageDiv.appendChild(self.div);\n\t            parameters.div = self.div;\n\t\n\t            PDFJS.AnnotationLayer.render(parameters);\n\t            if (typeof mozL10n !== 'undefined') {\n\t              mozL10n.translate(self.div);\n\t            }\n\t          }\n\t        });\n\t      },\n\t\n\t      hide: function AnnotationLayerBuilder_hide() {\n\t        if (!this.div) {\n\t          return;\n\t        }\n\t        this.div.setAttribute('hidden', 'true');\n\t      }\n\t    };\n\t\n\t    return AnnotationLayerBuilder;\n\t  }();\n\t\n\t  /**\n\t   * @constructor\n\t   * @implements IPDFAnnotationLayerFactory\n\t   */\n\t  function DefaultAnnotationLayerFactory() {}\n\t  DefaultAnnotationLayerFactory.prototype = {\n\t    /**\n\t     * @param {HTMLDivElement} pageDiv\n\t     * @param {PDFPage} pdfPage\n\t     * @returns {AnnotationLayerBuilder}\n\t     */\n\t    createAnnotationLayerBuilder: function createAnnotationLayerBuilder(pageDiv, pdfPage) {\n\t      return new AnnotationLayerBuilder({\n\t        pageDiv: pageDiv,\n\t        pdfPage: pdfPage,\n\t        linkService: new SimpleLinkService()\n\t      });\n\t    }\n\t  };\n\t\n\t  /**\n\t   * @typedef {Object} PDFViewerOptions\n\t   * @property {HTMLDivElement} container - The container for the viewer element.\n\t   * @property {HTMLDivElement} viewer - (optional) The viewer element.\n\t   * @property {IPDFLinkService} linkService - The navigation/linking service.\n\t   * @property {PDFRenderingQueue} renderingQueue - (optional) The rendering\n\t   *   queue object.\n\t   * @property {boolean} removePageBorders - (optional) Removes the border shadow\n\t   *   around the pages. The default is false.\n\t   */\n\t\n\t  /**\n\t   * Simple viewer control to display PDF content/pages.\n\t   * @class\n\t   * @implements {IRenderableView}\n\t   */\n\t  var PDFViewer = function pdfViewer() {\n\t    function PDFPageViewBuffer(size) {\n\t      var data = [];\n\t      this.push = function cachePush(view) {\n\t        var i = data.indexOf(view);\n\t        if (i >= 0) {\n\t          data.splice(i, 1);\n\t        }\n\t        data.push(view);\n\t        if (data.length > size) {\n\t          data.shift().destroy();\n\t        }\n\t      };\n\t      this.resize = function (newSize) {\n\t        size = newSize;\n\t        while (data.length > size) {\n\t          data.shift().destroy();\n\t        }\n\t      };\n\t    }\n\t\n\t    function isSameScale(oldScale, newScale) {\n\t      if (newScale === oldScale) {\n\t        return true;\n\t      }\n\t      if (Math.abs(newScale - oldScale) < 1e-15) {\n\t        // Prevent unnecessary re-rendering of all pages when the scale\n\t        // changes only because of limited numerical precision.\n\t        return true;\n\t      }\n\t      return false;\n\t    }\n\t\n\t    /**\n\t     * @constructs PDFViewer\n\t     * @param {PDFViewerOptions} options\n\t     */\n\t    function PDFViewer(options) {\n\t      this.container = options.container;\n\t      this.viewer = options.viewer || options.container.firstElementChild;\n\t      this.linkService = options.linkService || new SimpleLinkService();\n\t      this.removePageBorders = options.removePageBorders || false;\n\t\n\t      this.defaultRenderingQueue = !options.renderingQueue;\n\t      if (this.defaultRenderingQueue) {\n\t        // Custom rendering queue is not specified, using default one\n\t        this.renderingQueue = new PDFRenderingQueue();\n\t        this.renderingQueue.setViewer(this);\n\t      } else {\n\t        this.renderingQueue = options.renderingQueue;\n\t      }\n\t\n\t      this.scroll = watchScroll(this.container, this._scrollUpdate.bind(this));\n\t      this.updateInProgress = false;\n\t      this.presentationModeState = PresentationModeState.UNKNOWN;\n\t      this._resetView();\n\t\n\t      if (this.removePageBorders) {\n\t        this.viewer.classList.add('removePageBorders');\n\t      }\n\t    }\n\t\n\t    PDFViewer.prototype = /** @lends PDFViewer.prototype */{\n\t      get pagesCount() {\n\t        return this._pages.length;\n\t      },\n\t\n\t      getPageView: function getPageView(index) {\n\t        return this._pages[index];\n\t      },\n\t\n\t      get currentPageNumber() {\n\t        return this._currentPageNumber;\n\t      },\n\t\n\t      set currentPageNumber(val) {\n\t        if (!this.pdfDocument) {\n\t          this._currentPageNumber = val;\n\t          return;\n\t        }\n\t\n\t        var event = document.createEvent('UIEvents');\n\t        event.initUIEvent('pagechange', true, true, window, 0);\n\t        event.updateInProgress = this.updateInProgress;\n\t\n\t        if (!(0 < val && val <= this.pagesCount)) {\n\t          event.pageNumber = this._currentPageNumber;\n\t          event.previousPageNumber = val;\n\t          this.container.dispatchEvent(event);\n\t          return;\n\t        }\n\t\n\t        event.previousPageNumber = this._currentPageNumber;\n\t        this._currentPageNumber = val;\n\t        event.pageNumber = val;\n\t        this.container.dispatchEvent(event);\n\t\n\t        // Check if the caller is `PDFViewer_update`, to avoid breaking scrolling.\n\t        if (this.updateInProgress) {\n\t          return;\n\t        }\n\t        this.scrollPageIntoView(val);\n\t      },\n\t\n\t      /**\n\t       * @returns {number}\n\t       */\n\t      get currentScale() {\n\t        return this._currentScale !== UNKNOWN_SCALE ? this._currentScale : DEFAULT_SCALE;\n\t      },\n\t\n\t      /**\n\t       * @param {number} val - Scale of the pages in percents.\n\t       */\n\t      set currentScale(val) {\n\t        if (isNaN(val)) {\n\t          throw new Error('Invalid numeric scale');\n\t        }\n\t        if (!this.pdfDocument) {\n\t          this._currentScale = val;\n\t          this._currentScaleValue = val !== UNKNOWN_SCALE ? val.toString() : null;\n\t          return;\n\t        }\n\t        this._setScale(val, false);\n\t      },\n\t\n\t      /**\n\t       * @returns {string}\n\t       */\n\t      get currentScaleValue() {\n\t        return this._currentScaleValue;\n\t      },\n\t\n\t      /**\n\t       * @param val - The scale of the pages (in percent or predefined value).\n\t       */\n\t      set currentScaleValue(val) {\n\t        if (!this.pdfDocument) {\n\t          this._currentScale = isNaN(val) ? UNKNOWN_SCALE : val;\n\t          this._currentScaleValue = val;\n\t          return;\n\t        }\n\t        this._setScale(val, false);\n\t      },\n\t\n\t      /**\n\t       * @returns {number}\n\t       */\n\t      get pagesRotation() {\n\t        return this._pagesRotation;\n\t      },\n\t\n\t      /**\n\t       * @param {number} rotation - The rotation of the pages (0, 90, 180, 270).\n\t       */\n\t      set pagesRotation(rotation) {\n\t        this._pagesRotation = rotation;\n\t\n\t        for (var i = 0, l = this._pages.length; i < l; i++) {\n\t          var pageView = this._pages[i];\n\t          pageView.update(pageView.scale, rotation);\n\t        }\n\t\n\t        this._setScale(this._currentScaleValue, true);\n\t\n\t        if (this.defaultRenderingQueue) {\n\t          this.update();\n\t        }\n\t      },\n\t\n\t      /**\n\t       * @param pdfDocument {PDFDocument}\n\t       */\n\t      setDocument: function setDocument(pdfDocument) {\n\t        if (this.pdfDocument) {\n\t          this._resetView();\n\t        }\n\t\n\t        this.pdfDocument = pdfDocument;\n\t        if (!pdfDocument) {\n\t          return;\n\t        }\n\t\n\t        var pagesCount = pdfDocument.numPages;\n\t        var self = this;\n\t\n\t        var resolvePagesPromise;\n\t        var pagesPromise = new Promise(function (resolve) {\n\t          resolvePagesPromise = resolve;\n\t        });\n\t        this.pagesPromise = pagesPromise;\n\t        pagesPromise.then(function () {\n\t          var event = document.createEvent('CustomEvent');\n\t          event.initCustomEvent('pagesloaded', true, true, {\n\t            pagesCount: pagesCount\n\t          });\n\t          self.container.dispatchEvent(event);\n\t        });\n\t\n\t        var isOnePageRenderedResolved = false;\n\t        var resolveOnePageRendered = null;\n\t        var onePageRendered = new Promise(function (resolve) {\n\t          resolveOnePageRendered = resolve;\n\t        });\n\t        this.onePageRendered = onePageRendered;\n\t\n\t        var bindOnAfterAndBeforeDraw = function bindOnAfterAndBeforeDraw(pageView) {\n\t          pageView.onBeforeDraw = function pdfViewLoadOnBeforeDraw() {\n\t            // Add the page to the buffer at the start of drawing. That way it can\n\t            // be evicted from the buffer and destroyed even if we pause its\n\t            // rendering.\n\t            self._buffer.push(this);\n\t          };\n\t          // when page is painted, using the image as thumbnail base\n\t          pageView.onAfterDraw = function pdfViewLoadOnAfterDraw() {\n\t            if (!isOnePageRenderedResolved) {\n\t              isOnePageRenderedResolved = true;\n\t              resolveOnePageRendered();\n\t            }\n\t          };\n\t        };\n\t\n\t        var firstPagePromise = pdfDocument.getPage(1);\n\t        this.firstPagePromise = firstPagePromise;\n\t\n\t        // Fetch a single page so we can get a viewport that will be the default\n\t        // viewport for all pages\n\t        return firstPagePromise.then(function (pdfPage) {\n\t          var scale = this.currentScale;\n\t          var viewport = pdfPage.getViewport(scale * CSS_UNITS);\n\t          for (var pageNum = 1; pageNum <= pagesCount; ++pageNum) {\n\t            var textLayerFactory = null;\n\t            if (!PDFJS.disableTextLayer) {\n\t              textLayerFactory = this;\n\t            }\n\t            var pageView = new PDFPageView({\n\t              container: this.viewer,\n\t              id: pageNum,\n\t              scale: scale,\n\t              defaultViewport: viewport.clone(),\n\t              renderingQueue: this.renderingQueue,\n\t              textLayerFactory: textLayerFactory,\n\t              annotationLayerFactory: this\n\t            });\n\t            bindOnAfterAndBeforeDraw(pageView);\n\t            this._pages.push(pageView);\n\t          }\n\t\n\t          var linkService = this.linkService;\n\t\n\t          // Fetch all the pages since the viewport is needed before printing\n\t          // starts to create the correct size canvas. Wait until one page is\n\t          // rendered so we don't tie up too many resources early on.\n\t          onePageRendered.then(function () {\n\t            if (!PDFJS.disableAutoFetch) {\n\t              var getPagesLeft = pagesCount;\n\t              for (var pageNum = 1; pageNum <= pagesCount; ++pageNum) {\n\t                pdfDocument.getPage(pageNum).then(function (pageNum, pdfPage) {\n\t                  var pageView = self._pages[pageNum - 1];\n\t                  if (!pageView.pdfPage) {\n\t                    pageView.setPdfPage(pdfPage);\n\t                  }\n\t                  linkService.cachePageRef(pageNum, pdfPage.ref);\n\t                  getPagesLeft--;\n\t                  if (!getPagesLeft) {\n\t                    resolvePagesPromise();\n\t                  }\n\t                }.bind(null, pageNum));\n\t              }\n\t            } else {\n\t              // XXX: Printing is semi-broken with auto fetch disabled.\n\t              resolvePagesPromise();\n\t            }\n\t          });\n\t\n\t          var event = document.createEvent('CustomEvent');\n\t          event.initCustomEvent('pagesinit', true, true, null);\n\t          self.container.dispatchEvent(event);\n\t\n\t          if (this.defaultRenderingQueue) {\n\t            this.update();\n\t          }\n\t\n\t          if (this.findController) {\n\t            this.findController.resolveFirstPage();\n\t          }\n\t        }.bind(this));\n\t      },\n\t\n\t      _resetView: function _resetView() {\n\t        this._pages = [];\n\t        this._currentPageNumber = 1;\n\t        this._currentScale = UNKNOWN_SCALE;\n\t        this._currentScaleValue = null;\n\t        this._buffer = new PDFPageViewBuffer(DEFAULT_CACHE_SIZE);\n\t        this._location = null;\n\t        this._pagesRotation = 0;\n\t        this._pagesRequests = [];\n\t\n\t        var container = this.viewer;\n\t        while (container.hasChildNodes()) {\n\t          container.removeChild(container.lastChild);\n\t        }\n\t      },\n\t\n\t      _scrollUpdate: function PDFViewer_scrollUpdate() {\n\t        if (this.pagesCount === 0) {\n\t          return;\n\t        }\n\t        this.update();\n\t        for (var i = 0, ii = this._pages.length; i < ii; i++) {\n\t          this._pages[i].updatePosition();\n\t        }\n\t      },\n\t\n\t      _setScaleDispatchEvent: function pdfViewer_setScaleDispatchEvent(newScale, newValue, preset) {\n\t        var event = document.createEvent('UIEvents');\n\t        event.initUIEvent('scalechange', true, true, window, 0);\n\t        event.scale = newScale;\n\t        if (preset) {\n\t          event.presetValue = newValue;\n\t        }\n\t        this.container.dispatchEvent(event);\n\t      },\n\t\n\t      _setScaleUpdatePages: function pdfViewer_setScaleUpdatePages(newScale, newValue, noScroll, preset) {\n\t        this._currentScaleValue = newValue;\n\t\n\t        if (isSameScale(this._currentScale, newScale)) {\n\t          if (preset) {\n\t            this._setScaleDispatchEvent(newScale, newValue, true);\n\t          }\n\t          return;\n\t        }\n\t\n\t        for (var i = 0, ii = this._pages.length; i < ii; i++) {\n\t          this._pages[i].update(newScale);\n\t        }\n\t        this._currentScale = newScale;\n\t\n\t        if (!noScroll) {\n\t          var page = this._currentPageNumber,\n\t              dest;\n\t          if (this._location && !IGNORE_CURRENT_POSITION_ON_ZOOM && !(this.isInPresentationMode || this.isChangingPresentationMode)) {\n\t            page = this._location.pageNumber;\n\t            dest = [null, { name: 'XYZ' }, this._location.left, this._location.top, null];\n\t          }\n\t          this.scrollPageIntoView(page, dest);\n\t        }\n\t\n\t        this._setScaleDispatchEvent(newScale, newValue, preset);\n\t\n\t        if (this.defaultRenderingQueue) {\n\t          this.update();\n\t        }\n\t      },\n\t\n\t      _setScale: function pdfViewer_setScale(value, noScroll) {\n\t        var scale = parseFloat(value);\n\t\n\t        if (scale > 0) {\n\t          this._setScaleUpdatePages(scale, value, noScroll, false);\n\t        } else {\n\t          var currentPage = this._pages[this._currentPageNumber - 1];\n\t          if (!currentPage) {\n\t            return;\n\t          }\n\t          var hPadding = this.isInPresentationMode || this.removePageBorders ? 0 : SCROLLBAR_PADDING;\n\t          var vPadding = this.isInPresentationMode || this.removePageBorders ? 0 : VERTICAL_PADDING;\n\t          var pageWidthScale = (this.container.clientWidth - hPadding) / currentPage.width * currentPage.scale;\n\t          var pageHeightScale = (this.container.clientHeight - vPadding) / currentPage.height * currentPage.scale;\n\t          switch (value) {\n\t            case 'page-actual':\n\t              scale = 1;\n\t              break;\n\t            case 'page-width':\n\t              scale = pageWidthScale;\n\t              break;\n\t            case 'page-height':\n\t              scale = pageHeightScale;\n\t              break;\n\t            case 'page-fit':\n\t              scale = Math.min(pageWidthScale, pageHeightScale);\n\t              break;\n\t            case 'auto':\n\t              var isLandscape = currentPage.width > currentPage.height;\n\t              // For pages in landscape mode, fit the page height to the viewer\n\t              // *unless* the page would thus become too wide to fit horizontally.\n\t              var horizontalScale = isLandscape ? Math.min(pageHeightScale, pageWidthScale) : pageWidthScale;\n\t              scale = Math.min(MAX_AUTO_SCALE, horizontalScale);\n\t              break;\n\t            default:\n\t              console.error('pdfViewSetScale: \\'' + value + '\\' is an unknown zoom value.');\n\t              return;\n\t          }\n\t          this._setScaleUpdatePages(scale, value, noScroll, true);\n\t        }\n\t      },\n\t\n\t      /**\n\t       * Scrolls page into view.\n\t       * @param {number} pageNumber\n\t       * @param {Array} dest - (optional) original PDF destination array:\n\t       *   <page-ref> </XYZ|FitXXX> <args..>\n\t       */\n\t      scrollPageIntoView: function PDFViewer_scrollPageIntoView(pageNumber, dest) {\n\t        if (!this.pdfDocument) {\n\t          return;\n\t        }\n\t\n\t        var pageView = this._pages[pageNumber - 1];\n\t\n\t        if (this.isInPresentationMode) {\n\t          if (this._currentPageNumber !== pageView.id) {\n\t            // Avoid breaking getVisiblePages in presentation mode.\n\t            this.currentPageNumber = pageView.id;\n\t            return;\n\t          }\n\t          dest = null;\n\t          // Fixes the case when PDF has different page sizes.\n\t          this._setScale(this._currentScaleValue, true);\n\t        }\n\t        if (!dest) {\n\t          scrollIntoView(pageView.div);\n\t          return;\n\t        }\n\t\n\t        var x = 0,\n\t            y = 0;\n\t        var width = 0,\n\t            height = 0,\n\t            widthScale,\n\t            heightScale;\n\t        var changeOrientation = pageView.rotation % 180 === 0 ? false : true;\n\t        var pageWidth = (changeOrientation ? pageView.height : pageView.width) / pageView.scale / CSS_UNITS;\n\t        var pageHeight = (changeOrientation ? pageView.width : pageView.height) / pageView.scale / CSS_UNITS;\n\t        var scale = 0;\n\t        switch (dest[1].name) {\n\t          case 'XYZ':\n\t            x = dest[2];\n\t            y = dest[3];\n\t            scale = dest[4];\n\t            // If x and/or y coordinates are not supplied, default to\n\t            // _top_ left of the page (not the obvious bottom left,\n\t            // since aligning the bottom of the intended page with the\n\t            // top of the window is rarely helpful).\n\t            x = x !== null ? x : 0;\n\t            y = y !== null ? y : pageHeight;\n\t            break;\n\t          case 'Fit':\n\t          case 'FitB':\n\t            scale = 'page-fit';\n\t            break;\n\t          case 'FitH':\n\t          case 'FitBH':\n\t            y = dest[2];\n\t            scale = 'page-width';\n\t            // According to the PDF spec, section 12.3.2.2, a `null` value in the\n\t            // parameter should maintain the position relative to the new page.\n\t            if (y === null && this._location) {\n\t              x = this._location.left;\n\t              y = this._location.top;\n\t            }\n\t            break;\n\t          case 'FitV':\n\t          case 'FitBV':\n\t            x = dest[2];\n\t            width = pageWidth;\n\t            height = pageHeight;\n\t            scale = 'page-height';\n\t            break;\n\t          case 'FitR':\n\t            x = dest[2];\n\t            y = dest[3];\n\t            width = dest[4] - x;\n\t            height = dest[5] - y;\n\t            var hPadding = this.removePageBorders ? 0 : SCROLLBAR_PADDING;\n\t            var vPadding = this.removePageBorders ? 0 : VERTICAL_PADDING;\n\t\n\t            widthScale = (this.container.clientWidth - hPadding) / width / CSS_UNITS;\n\t            heightScale = (this.container.clientHeight - vPadding) / height / CSS_UNITS;\n\t            scale = Math.min(Math.abs(widthScale), Math.abs(heightScale));\n\t            break;\n\t          default:\n\t            return;\n\t        }\n\t\n\t        if (scale && scale !== this._currentScale) {\n\t          this.currentScaleValue = scale;\n\t        } else if (this._currentScale === UNKNOWN_SCALE) {\n\t          this.currentScaleValue = DEFAULT_SCALE_VALUE;\n\t        }\n\t\n\t        if (scale === 'page-fit' && !dest[4]) {\n\t          scrollIntoView(pageView.div);\n\t          return;\n\t        }\n\t\n\t        var boundingRect = [pageView.viewport.convertToViewportPoint(x, y), pageView.viewport.convertToViewportPoint(x + width, y + height)];\n\t        var left = Math.min(boundingRect[0][0], boundingRect[1][0]);\n\t        var top = Math.min(boundingRect[0][1], boundingRect[1][1]);\n\t\n\t        scrollIntoView(pageView.div, { left: left, top: top });\n\t      },\n\t\n\t      _updateLocation: function _updateLocation(firstPage) {\n\t        var currentScale = this._currentScale;\n\t        var currentScaleValue = this._currentScaleValue;\n\t        var normalizedScaleValue = parseFloat(currentScaleValue) === currentScale ? Math.round(currentScale * 10000) / 100 : currentScaleValue;\n\t\n\t        var pageNumber = firstPage.id;\n\t        var pdfOpenParams = '#page=' + pageNumber;\n\t        pdfOpenParams += '&zoom=' + normalizedScaleValue;\n\t        var currentPageView = this._pages[pageNumber - 1];\n\t        var container = this.container;\n\t        var topLeft = currentPageView.getPagePoint(container.scrollLeft - firstPage.x, container.scrollTop - firstPage.y);\n\t        var intLeft = Math.round(topLeft[0]);\n\t        var intTop = Math.round(topLeft[1]);\n\t        pdfOpenParams += ',' + intLeft + ',' + intTop;\n\t\n\t        this._location = {\n\t          pageNumber: pageNumber,\n\t          scale: normalizedScaleValue,\n\t          top: intTop,\n\t          left: intLeft,\n\t          pdfOpenParams: pdfOpenParams\n\t        };\n\t      },\n\t\n\t      update: function PDFViewer_update() {\n\t        var visible = this._getVisiblePages();\n\t        var visiblePages = visible.views;\n\t        if (visiblePages.length === 0) {\n\t          return;\n\t        }\n\t\n\t        this.updateInProgress = true;\n\t\n\t        var suggestedCacheSize = Math.max(DEFAULT_CACHE_SIZE, 2 * visiblePages.length + 1);\n\t        this._buffer.resize(suggestedCacheSize);\n\t\n\t        this.renderingQueue.renderHighestPriority(visible);\n\t\n\t        var currentId = this._currentPageNumber;\n\t        var firstPage = visible.first;\n\t\n\t        for (var i = 0, ii = visiblePages.length, stillFullyVisible = false; i < ii; ++i) {\n\t          var page = visiblePages[i];\n\t\n\t          if (page.percent < 100) {\n\t            break;\n\t          }\n\t          if (page.id === currentId) {\n\t            stillFullyVisible = true;\n\t            break;\n\t          }\n\t        }\n\t\n\t        if (!stillFullyVisible) {\n\t          currentId = visiblePages[0].id;\n\t        }\n\t\n\t        if (!this.isInPresentationMode) {\n\t          this.currentPageNumber = currentId;\n\t        }\n\t\n\t        this._updateLocation(firstPage);\n\t\n\t        this.updateInProgress = false;\n\t\n\t        var event = document.createEvent('UIEvents');\n\t        event.initUIEvent('updateviewarea', true, true, window, 0);\n\t        event.location = this._location;\n\t        this.container.dispatchEvent(event);\n\t      },\n\t\n\t      containsElement: function containsElement(element) {\n\t        return this.container.contains(element);\n\t      },\n\t\n\t      focus: function focus() {\n\t        this.container.focus();\n\t      },\n\t\n\t      get isInPresentationMode() {\n\t        return this.presentationModeState === PresentationModeState.FULLSCREEN;\n\t      },\n\t\n\t      get isChangingPresentationMode() {\n\t        return this.presentationModeState === PresentationModeState.CHANGING;\n\t      },\n\t\n\t      get isHorizontalScrollbarEnabled() {\n\t        return this.isInPresentationMode ? false : this.container.scrollWidth > this.container.clientWidth;\n\t      },\n\t\n\t      _getVisiblePages: function _getVisiblePages() {\n\t        if (!this.isInPresentationMode) {\n\t          return getVisibleElements(this.container, this._pages, true);\n\t        } else {\n\t          // The algorithm in getVisibleElements doesn't work in all browsers and\n\t          // configurations when presentation mode is active.\n\t          var visible = [];\n\t          var currentPage = this._pages[this._currentPageNumber - 1];\n\t          visible.push({ id: currentPage.id, view: currentPage });\n\t          return { first: currentPage, last: currentPage, views: visible };\n\t        }\n\t      },\n\t\n\t      cleanup: function cleanup() {\n\t        for (var i = 0, ii = this._pages.length; i < ii; i++) {\n\t          if (this._pages[i] && this._pages[i].renderingState !== RenderingStates.FINISHED) {\n\t            this._pages[i].reset();\n\t          }\n\t        }\n\t      },\n\t\n\t      /**\n\t       * @param {PDFPageView} pageView\n\t       * @returns {PDFPage}\n\t       * @private\n\t       */\n\t      _ensurePdfPageLoaded: function _ensurePdfPageLoaded(pageView) {\n\t        if (pageView.pdfPage) {\n\t          return Promise.resolve(pageView.pdfPage);\n\t        }\n\t        var pageNumber = pageView.id;\n\t        if (this._pagesRequests[pageNumber]) {\n\t          return this._pagesRequests[pageNumber];\n\t        }\n\t        var promise = this.pdfDocument.getPage(pageNumber).then(function (pdfPage) {\n\t          pageView.setPdfPage(pdfPage);\n\t          this._pagesRequests[pageNumber] = null;\n\t          return pdfPage;\n\t        }.bind(this));\n\t        this._pagesRequests[pageNumber] = promise;\n\t        return promise;\n\t      },\n\t\n\t      forceRendering: function forceRendering(currentlyVisiblePages) {\n\t        var visiblePages = currentlyVisiblePages || this._getVisiblePages();\n\t        var pageView = this.renderingQueue.getHighestPriority(visiblePages, this._pages, this.scroll.down);\n\t        if (pageView) {\n\t          this._ensurePdfPageLoaded(pageView).then(function () {\n\t            this.renderingQueue.renderView(pageView);\n\t          }.bind(this));\n\t          return true;\n\t        }\n\t        return false;\n\t      },\n\t\n\t      getPageTextContent: function getPageTextContent(pageIndex) {\n\t        return this.pdfDocument.getPage(pageIndex + 1).then(function (page) {\n\t          return page.getTextContent({ normalizeWhitespace: true });\n\t        });\n\t      },\n\t\n\t      /**\n\t       * @param {HTMLDivElement} textLayerDiv\n\t       * @param {number} pageIndex\n\t       * @param {PageViewport} viewport\n\t       * @returns {TextLayerBuilder}\n\t       */\n\t      createTextLayerBuilder: function createTextLayerBuilder(textLayerDiv, pageIndex, viewport) {\n\t        return new TextLayerBuilder({\n\t          textLayerDiv: textLayerDiv,\n\t          pageIndex: pageIndex,\n\t          viewport: viewport,\n\t          findController: this.isInPresentationMode ? null : this.findController\n\t        });\n\t      },\n\t\n\t      /**\n\t       * @param {HTMLDivElement} pageDiv\n\t       * @param {PDFPage} pdfPage\n\t       * @returns {AnnotationLayerBuilder}\n\t       */\n\t      createAnnotationLayerBuilder: function createAnnotationLayerBuilder(pageDiv, pdfPage) {\n\t        return new AnnotationLayerBuilder({\n\t          pageDiv: pageDiv,\n\t          pdfPage: pdfPage,\n\t          linkService: this.linkService\n\t        });\n\t      },\n\t\n\t      setFindController: function setFindController(findController) {\n\t        this.findController = findController;\n\t      }\n\t    };\n\t\n\t    return PDFViewer;\n\t  }();\n\t\n\t  var SimpleLinkService = function SimpleLinkServiceClosure() {\n\t    function SimpleLinkService() {}\n\t\n\t    SimpleLinkService.prototype = {\n\t      /**\n\t       * @returns {number}\n\t       */\n\t      get page() {\n\t        return 0;\n\t      },\n\t      /**\n\t       * @param {number} value\n\t       */\n\t      set page(value) {},\n\t      /**\n\t       * @param dest - The PDF destination object.\n\t       */\n\t      navigateTo: function navigateTo(dest) {},\n\t      /**\n\t       * @param dest - The PDF destination object.\n\t       * @returns {string} The hyperlink to the PDF object.\n\t       */\n\t      getDestinationHash: function getDestinationHash(dest) {\n\t        return '#';\n\t      },\n\t      /**\n\t       * @param hash - The PDF parameters/hash.\n\t       * @returns {string} The hyperlink to the PDF object.\n\t       */\n\t      getAnchorUrl: function getAnchorUrl(hash) {\n\t        return '#';\n\t      },\n\t      /**\n\t       * @param {string} hash\n\t       */\n\t      setHash: function setHash(hash) {},\n\t      /**\n\t       * @param {string} action\n\t       */\n\t      executeNamedAction: function executeNamedAction(action) {},\n\t      /**\n\t       * @param {number} pageNum - page number.\n\t       * @param {Object} pageRef - reference to the page.\n\t       */\n\t      cachePageRef: function cachePageRef(pageNum, pageRef) {}\n\t    };\n\t    return SimpleLinkService;\n\t  }();\n\t\n\t  var PDFHistory = function () {\n\t    function PDFHistory(options) {\n\t      this.linkService = options.linkService;\n\t\n\t      this.initialized = false;\n\t      this.initialDestination = null;\n\t      this.initialBookmark = null;\n\t    }\n\t\n\t    PDFHistory.prototype = {\n\t      /**\n\t       * @param {string} fingerprint\n\t       * @param {IPDFLinkService} linkService\n\t       */\n\t      initialize: function pdfHistoryInitialize(fingerprint) {\n\t        this.initialized = true;\n\t        this.reInitialized = false;\n\t        this.allowHashChange = true;\n\t        this.historyUnlocked = true;\n\t        this.isViewerInPresentationMode = false;\n\t\n\t        this.previousHash = window.location.hash.substring(1);\n\t        this.currentBookmark = '';\n\t        this.currentPage = 0;\n\t        this.updatePreviousBookmark = false;\n\t        this.previousBookmark = '';\n\t        this.previousPage = 0;\n\t        this.nextHashParam = '';\n\t\n\t        this.fingerprint = fingerprint;\n\t        this.currentUid = this.uid = 0;\n\t        this.current = {};\n\t\n\t        var state = window.history.state;\n\t        if (this._isStateObjectDefined(state)) {\n\t          // This corresponds to navigating back to the document\n\t          // from another page in the browser history.\n\t          if (state.target.dest) {\n\t            this.initialDestination = state.target.dest;\n\t          } else {\n\t            this.initialBookmark = state.target.hash;\n\t          }\n\t          this.currentUid = state.uid;\n\t          this.uid = state.uid + 1;\n\t          this.current = state.target;\n\t        } else {\n\t          // This corresponds to the loading of a new document.\n\t          if (state && state.fingerprint && this.fingerprint !== state.fingerprint) {\n\t            // Reinitialize the browsing history when a new document\n\t            // is opened in the web viewer.\n\t            this.reInitialized = true;\n\t          }\n\t          this._pushOrReplaceState({ fingerprint: this.fingerprint }, true);\n\t        }\n\t\n\t        var self = this;\n\t        window.addEventListener('popstate', function pdfHistoryPopstate(evt) {\n\t          if (!self.historyUnlocked) {\n\t            return;\n\t          }\n\t          if (evt.state) {\n\t            // Move back/forward in the history.\n\t            self._goTo(evt.state);\n\t            return;\n\t          }\n\t\n\t          // If the state is not set, then the user tried to navigate to a\n\t          // different hash by manually editing the URL and pressing Enter, or by\n\t          // clicking on an in-page link (e.g. the \"current view\" link).\n\t          // Save the current view state to the browser history.\n\t\n\t          // Note: In Firefox, history.null could also be null after an in-page\n\t          // navigation to the same URL, and without dispatching the popstate\n\t          // event: https://bugzilla.mozilla.org/show_bug.cgi?id=1183881\n\t\n\t          if (self.uid === 0) {\n\t            // Replace the previous state if it was not explicitly set.\n\t            var previousParams = self.previousHash && self.currentBookmark && self.previousHash !== self.currentBookmark ? { hash: self.currentBookmark, page: self.currentPage } : { page: 1 };\n\t            replacePreviousHistoryState(previousParams, function () {\n\t              updateHistoryWithCurrentHash();\n\t            });\n\t          } else {\n\t            updateHistoryWithCurrentHash();\n\t          }\n\t        }, false);\n\t\n\t        function updateHistoryWithCurrentHash() {\n\t          self.previousHash = window.location.hash.slice(1);\n\t          self._pushToHistory({ hash: self.previousHash }, false, true);\n\t          self._updatePreviousBookmark();\n\t        }\n\t\n\t        function replacePreviousHistoryState(params, callback) {\n\t          // To modify the previous history entry, the following happens:\n\t          // 1. history.back()\n\t          // 2. _pushToHistory, which calls history.replaceState( ... )\n\t          // 3. history.forward()\n\t          // Because a navigation via the history API does not immediately update\n\t          // the history state, the popstate event is used for synchronization.\n\t          self.historyUnlocked = false;\n\t\n\t          // Suppress the hashchange event to avoid side effects caused by\n\t          // navigating back and forward.\n\t          self.allowHashChange = false;\n\t          window.addEventListener('popstate', rewriteHistoryAfterBack);\n\t          history.back();\n\t\n\t          function rewriteHistoryAfterBack() {\n\t            window.removeEventListener('popstate', rewriteHistoryAfterBack);\n\t            window.addEventListener('popstate', rewriteHistoryAfterForward);\n\t            self._pushToHistory(params, false, true);\n\t            history.forward();\n\t          }\n\t          function rewriteHistoryAfterForward() {\n\t            window.removeEventListener('popstate', rewriteHistoryAfterForward);\n\t            self.allowHashChange = true;\n\t            self.historyUnlocked = true;\n\t            callback();\n\t          }\n\t        }\n\t\n\t        function pdfHistoryBeforeUnload() {\n\t          var previousParams = self._getPreviousParams(null, true);\n\t          if (previousParams) {\n\t            var replacePrevious = !self.current.dest && self.current.hash !== self.previousHash;\n\t            self._pushToHistory(previousParams, false, replacePrevious);\n\t            self._updatePreviousBookmark();\n\t          }\n\t          // Remove the event listener when navigating away from the document,\n\t          // since 'beforeunload' prevents Firefox from caching the document.\n\t          window.removeEventListener('beforeunload', pdfHistoryBeforeUnload, false);\n\t        }\n\t\n\t        window.addEventListener('beforeunload', pdfHistoryBeforeUnload, false);\n\t\n\t        window.addEventListener('pageshow', function pdfHistoryPageShow(evt) {\n\t          // If the entire viewer (including the PDF file) is cached in\n\t          // the browser, we need to reattach the 'beforeunload' event listener\n\t          // since the 'DOMContentLoaded' event is not fired on 'pageshow'.\n\t          window.addEventListener('beforeunload', pdfHistoryBeforeUnload, false);\n\t        }, false);\n\t\n\t        window.addEventListener('presentationmodechanged', function (e) {\n\t          self.isViewerInPresentationMode = !!e.detail.active;\n\t        });\n\t      },\n\t\n\t      clearHistoryState: function pdfHistory_clearHistoryState() {\n\t        this._pushOrReplaceState(null, true);\n\t      },\n\t\n\t      _isStateObjectDefined: function pdfHistory_isStateObjectDefined(state) {\n\t        return state && state.uid >= 0 && state.fingerprint && this.fingerprint === state.fingerprint && state.target && state.target.hash ? true : false;\n\t      },\n\t\n\t      _pushOrReplaceState: function pdfHistory_pushOrReplaceState(stateObj, replace) {\n\t        if (replace) {\n\t          window.history.replaceState(stateObj, '');\n\t        } else {\n\t          window.history.pushState(stateObj, '');\n\t        }\n\t      },\n\t\n\t      get isHashChangeUnlocked() {\n\t        if (!this.initialized) {\n\t          return true;\n\t        }\n\t        return this.allowHashChange;\n\t      },\n\t\n\t      _updatePreviousBookmark: function pdfHistory_updatePreviousBookmark() {\n\t        if (this.updatePreviousBookmark && this.currentBookmark && this.currentPage) {\n\t          this.previousBookmark = this.currentBookmark;\n\t          this.previousPage = this.currentPage;\n\t          this.updatePreviousBookmark = false;\n\t        }\n\t      },\n\t\n\t      updateCurrentBookmark: function pdfHistoryUpdateCurrentBookmark(bookmark, pageNum) {\n\t        if (this.initialized) {\n\t          this.currentBookmark = bookmark.substring(1);\n\t          this.currentPage = pageNum | 0;\n\t          this._updatePreviousBookmark();\n\t        }\n\t      },\n\t\n\t      updateNextHashParam: function pdfHistoryUpdateNextHashParam(param) {\n\t        if (this.initialized) {\n\t          this.nextHashParam = param;\n\t        }\n\t      },\n\t\n\t      push: function pdfHistoryPush(params, isInitialBookmark) {\n\t        if (!(this.initialized && this.historyUnlocked)) {\n\t          return;\n\t        }\n\t        if (params.dest && !params.hash) {\n\t          params.hash = this.current.hash && this.current.dest && this.current.dest === params.dest ? this.current.hash : this.linkService.getDestinationHash(params.dest).split('#')[1];\n\t        }\n\t        if (params.page) {\n\t          params.page |= 0;\n\t        }\n\t        if (isInitialBookmark) {\n\t          var target = window.history.state.target;\n\t          if (!target) {\n\t            // Invoked when the user specifies an initial bookmark,\n\t            // thus setting initialBookmark, when the document is loaded.\n\t            this._pushToHistory(params, false);\n\t            this.previousHash = window.location.hash.substring(1);\n\t          }\n\t          this.updatePreviousBookmark = this.nextHashParam ? false : true;\n\t          if (target) {\n\t            // If the current document is reloaded,\n\t            // avoid creating duplicate entries in the history.\n\t            this._updatePreviousBookmark();\n\t          }\n\t          return;\n\t        }\n\t        if (this.nextHashParam) {\n\t          if (this.nextHashParam === params.hash) {\n\t            this.nextHashParam = null;\n\t            this.updatePreviousBookmark = true;\n\t            return;\n\t          } else {\n\t            this.nextHashParam = null;\n\t          }\n\t        }\n\t\n\t        if (params.hash) {\n\t          if (this.current.hash) {\n\t            if (this.current.hash !== params.hash) {\n\t              this._pushToHistory(params, true);\n\t            } else {\n\t              if (!this.current.page && params.page) {\n\t                this._pushToHistory(params, false, true);\n\t              }\n\t              this.updatePreviousBookmark = true;\n\t            }\n\t          } else {\n\t            this._pushToHistory(params, true);\n\t          }\n\t        } else if (this.current.page && params.page && this.current.page !== params.page) {\n\t          this._pushToHistory(params, true);\n\t        }\n\t      },\n\t\n\t      _getPreviousParams: function pdfHistory_getPreviousParams(onlyCheckPage, beforeUnload) {\n\t        if (!(this.currentBookmark && this.currentPage)) {\n\t          return null;\n\t        } else if (this.updatePreviousBookmark) {\n\t          this.updatePreviousBookmark = false;\n\t        }\n\t        if (this.uid > 0 && !(this.previousBookmark && this.previousPage)) {\n\t          // Prevent the history from getting stuck in the current state,\n\t          // effectively preventing the user from going back/forward in\n\t          // the history.\n\t          //\n\t          // This happens if the current position in the document didn't change\n\t          // when the history was previously updated. The reasons for this are\n\t          // either:\n\t          // 1. The current zoom value is such that the document does not need to,\n\t          //    or cannot, be scrolled to display the destination.\n\t          // 2. The previous destination is broken, and doesn't actally point to a\n\t          //    position within the document.\n\t          //    (This is either due to a bad PDF generator, or the user making a\n\t          //     mistake when entering a destination in the hash parameters.)\n\t          return null;\n\t        }\n\t        if (!this.current.dest && !onlyCheckPage || beforeUnload) {\n\t          if (this.previousBookmark === this.currentBookmark) {\n\t            return null;\n\t          }\n\t        } else if (this.current.page || onlyCheckPage) {\n\t          if (this.previousPage === this.currentPage) {\n\t            return null;\n\t          }\n\t        } else {\n\t          return null;\n\t        }\n\t        var params = { hash: this.currentBookmark, page: this.currentPage };\n\t        if (this.isViewerInPresentationMode) {\n\t          params.hash = null;\n\t        }\n\t        return params;\n\t      },\n\t\n\t      _stateObj: function pdfHistory_stateObj(params) {\n\t        return { fingerprint: this.fingerprint, uid: this.uid, target: params };\n\t      },\n\t\n\t      _pushToHistory: function pdfHistory_pushToHistory(params, addPrevious, overwrite) {\n\t        if (!this.initialized) {\n\t          return;\n\t        }\n\t        if (!params.hash && params.page) {\n\t          params.hash = 'page=' + params.page;\n\t        }\n\t        if (addPrevious && !overwrite) {\n\t          var previousParams = this._getPreviousParams();\n\t          if (previousParams) {\n\t            var replacePrevious = !this.current.dest && this.current.hash !== this.previousHash;\n\t            this._pushToHistory(previousParams, false, replacePrevious);\n\t          }\n\t        }\n\t        this._pushOrReplaceState(this._stateObj(params), overwrite || this.uid === 0);\n\t        this.currentUid = this.uid++;\n\t        this.current = params;\n\t        this.updatePreviousBookmark = true;\n\t      },\n\t\n\t      _goTo: function pdfHistory_goTo(state) {\n\t        if (!(this.initialized && this.historyUnlocked && this._isStateObjectDefined(state))) {\n\t          return;\n\t        }\n\t        if (!this.reInitialized && state.uid < this.currentUid) {\n\t          var previousParams = this._getPreviousParams(true);\n\t          if (previousParams) {\n\t            this._pushToHistory(this.current, false);\n\t            this._pushToHistory(previousParams, false);\n\t            this.currentUid = state.uid;\n\t            window.history.back();\n\t            return;\n\t          }\n\t        }\n\t        this.historyUnlocked = false;\n\t\n\t        if (state.target.dest) {\n\t          this.linkService.navigateTo(state.target.dest);\n\t        } else {\n\t          this.linkService.setHash(state.target.hash);\n\t        }\n\t        this.currentUid = state.uid;\n\t        if (state.uid > this.uid) {\n\t          this.uid = state.uid;\n\t        }\n\t        this.current = state.target;\n\t        this.updatePreviousBookmark = true;\n\t\n\t        var currentHash = window.location.hash.substring(1);\n\t        if (this.previousHash !== currentHash) {\n\t          this.allowHashChange = false;\n\t        }\n\t        this.previousHash = currentHash;\n\t\n\t        this.historyUnlocked = true;\n\t      },\n\t\n\t      back: function pdfHistoryBack() {\n\t        this.go(-1);\n\t      },\n\t\n\t      forward: function pdfHistoryForward() {\n\t        this.go(1);\n\t      },\n\t\n\t      go: function pdfHistoryGo(direction) {\n\t        if (this.initialized && this.historyUnlocked) {\n\t          var state = window.history.state;\n\t          if (direction === -1 && state && state.uid > 0) {\n\t            window.history.back();\n\t          } else if (direction === 1 && state && state.uid < this.uid - 1) {\n\t            window.history.forward();\n\t          }\n\t        }\n\t      }\n\t    };\n\t\n\t    return PDFHistory;\n\t  }();\n\t\n\t  PDFJS.PDFViewer = PDFViewer;\n\t  PDFJS.PDFPageView = PDFPageView;\n\t  PDFJS.PDFLinkService = PDFLinkService;\n\t  PDFJS.TextLayerBuilder = TextLayerBuilder;\n\t  PDFJS.DefaultTextLayerFactory = DefaultTextLayerFactory;\n\t  PDFJS.AnnotationLayerBuilder = AnnotationLayerBuilder;\n\t  PDFJS.DefaultAnnotationLayerFactory = DefaultAnnotationLayerFactory;\n\t  PDFJS.PDFHistory = PDFHistory;\n\t\n\t  PDFJS.getFileName = getFileName;\n\t  PDFJS.ProgressBar = ProgressBar;\n\t}).call(typeof window === 'undefined' ? undefined : window);\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** ../pamoja-platform/build/js/pdf-annotate.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap d7f69c445fdecb5e2645\n **/","import PDFJSAnnotate from './src/PDFJSAnnotate';\n\nexport default PDFJSAnnotate;\n\n\n\n/** WEBPACK FOOTER **\n ** ./index.js\n **/","import StoreAdapter from './adapter/StoreAdapter';\nimport LocalStoreAdapter from './adapter/LocalStoreAdapter';\nimport render from './render';\nimport UI from './UI';\nimport initColorPicker from '../shared/initColorPicker';\n\n// expose global PDFJS viewer\nconst PDFJS = require('../shared/pdf_viewer');\n\nexport default {\n\n  initColorPicker,\n\n  /**\n   * Abstract class that needs to be defined so PDFJSAnnotate\n   * knows how to communicate with your server.\n   */\n  StoreAdapter,\n\n  /**\n   * Implementation of StoreAdapter that stores annotation data to localStorage.\n   */\n  LocalStoreAdapter,\n\n  /**\n   * Abstract instance of StoreAdapter\n   */\n  __storeAdapter: new StoreAdapter(),\n\n  /**\n   * Getter for the underlying StoreAdapter property\n   *\n   * @return {StoreAdapter}\n   */\n  getStoreAdapter() {\n    return this.__storeAdapter;\n  },\n\n  /**\n   * Setter for the underlying StoreAdapter property\n   *\n   * @param {StoreAdapter} adapter The StoreAdapter implementation to be used.\n   */\n  setStoreAdapter(adapter) {\n    // TODO this throws an error when bundled\n    // if (!(adapter instanceof StoreAdapter)) {\n    //   throw new Error('adapter must be an instance of StoreAdapter');\n    // }\n\n    this.__storeAdapter = adapter;\n  },\n\n  /**\n   * UI is a helper for instrumenting UI interactions for creating,\n   * editing, and deleting annotations in the browser.\n   */\n  UI,\n\n  /**\n   * Render the annotations for a page in the PDF Document\n   *\n   * @param {SVGElement} svg The SVG element that annotations should be rendered to\n   * @param {PageViewport} viewport The PDFPage.getViewport data\n   * @param {Object} data The StoreAdapter.getAnnotations data\n   * @return {Promise}\n   */\n  render,\n\n  /**\n   * Convenience method for getting annotation data\n   *\n   * @alias StoreAdapter.getAnnotations\n   * @param {String} documentId The ID of the document\n   * @param {String} pageNumber The page number\n   * @return {Promise}\n   */\n  getAnnotations(documentId, pageNumber) {\n    return this.getStoreAdapter().getAnnotations(...arguments);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/PDFJSAnnotate.js\n **/","import abstractFunction from '../utils/abstractFunction';\nimport { fireEvent } from '../UI/event';\n\n// Adapter should never be invoked publicly\nexport default class StoreAdapter {\n  /**\n   * Create a new StoreAdapter instance\n   *\n   * @param {Object} [definition] The definition to use for overriding abstract methods\n   */\n  constructor(definition = {}) {\n    // Copy each function from definition if it is a function we know about\n    Object.keys(definition).forEach((key) => {\n      if (typeof definition[key] === 'function' &&\n          typeof this[key] === 'function') {\n        this[key] = definition[key];\n      }\n    });\n  }\n\n  /**\n   * Get all the annotations for a given document and page number.\n   *\n   * @param {String} documentId The ID for the document the annotations belong to\n   * @param {Number} pageNumber The number of the page the annotations belong to\n   * @return {Promise}\n   */\n  __getAnnotations(documentId, pageNumber) { abstractFunction('getAnnotations'); }\n  get getAnnotations() { return this.__getAnnotations; }\n  set getAnnotations(fn) {\n    this.__getAnnotations = function getAnnotations(documentId, pageNumber) {\n      return fn(...arguments).then((annotations) => {\n        // TODO may be best to have this happen on the server\n        if (annotations.annotations) {\n          annotations.annotations.forEach((a) => {\n            a.documentId = documentId;\n          });\n        }\n        return annotations;\n      });\n    };\n  }\n\n  /**\n   * Get the definition for a specific annotation.\n   *\n   * @param {String} documentId The ID for the document the annotation belongs to\n   * @param {String} annotationId The ID for the annotation\n   * @return {Promise}\n   */\n  getAnnotation(documentId, annotationId) { abstractFunction('getAnnotation'); }\n\n  /**\n   * Add an annotation\n   *\n   * @param {String} documentId The ID for the document to add the annotation to\n   * @param {String} pageNumber The page number to add the annotation to\n   * @param {Object} annotation The definition for the new annotation\n   * @return {Promise}\n   */\n  __addAnnotation(documentId, pageNumber, annotation) { abstractFunction('addAnnotation'); }\n  get addAnnotation() { return this.__addAnnotation; }\n  set addAnnotation(fn) {\n    this.__addAnnotation = function addAnnotation(documentId, pageNumber, annotation) {\n      return fn(...arguments).then((annotation) => {\n        fireEvent('annotation:add', documentId, pageNumber, annotation);\n        return annotation;\n      });\n    };\n  }\n\n  /**\n   * Edit an annotation\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} pageNumber the page number of the annotation\n   * @param {Object} annotation The definition of the modified annotation\n   * @return {Promise}\n   */\n  __editAnnotation(documentId, pageNumber, annotation) { abstractFunction('editAnnotation'); }\n  get editAnnotation() { return this.__editAnnotation; }\n  set editAnnotation(fn) {\n    this.__editAnnotation = function editAnnotation(documentId, annotationId, annotation) {\n      return fn(...arguments).then((annotation) => {\n        fireEvent('annotation:edit', documentId, annotationId, annotation);\n        return annotation;\n      });\n    };\n  }\n\n  /**\n   * Delete an annotation\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} annotationId The ID for the annotation\n   * @return {Promise}\n   */\n  __deleteAnnotation(documentId, annotationId) { abstractFunction('deleteAnnotation'); }\n  get deleteAnnotation() { return this.__deleteAnnotation; }\n  set deleteAnnotation(fn) {\n    this.__deleteAnnotation = function deleteAnnotation(documentId, annotationId) {\n      return fn(...arguments).then((success) => {\n        if (success) {\n          fireEvent('annotation:delete', documentId, annotationId);\n        }\n        return success;\n      });\n    };\n  }\n\n  /**\n   * Get all the comments for an annotation\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} annotationId The ID for the annotation\n   * @return {Promise}\n   */\n  getComments(documentId, annotationId) { abstractFunction('getComments'); }\n\n  /**\n   * Add a new comment\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} annotationId The ID for the annotation\n   * @param {Object} content The definition of the comment\n   * @return {Promise}\n   */\n  __addComment(documentId, annotationId, content) { abstractFunction('addComment'); }\n  get addComment() { return this.__addComment; }\n  set addComment(fn) {\n    this.__addComment = function addComment(documentId, annotationId, content) {\n      return fn(...arguments).then((comment) => {\n        fireEvent('comment:add', documentId, annotationId, comment);\n        return comment;\n      });\n    };\n  }\n\n  /**\n   * Delete a comment\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} commentId The ID for the comment\n   * @return {Promise}\n   */\n  __deleteComment(documentId, commentId) { abstractFunction('deleteComment'); }\n  get deleteComment() { return this.__deleteComment; }\n  set deleteComment(fn) {\n    this.__deleteComment = function deleteComment(documentId, commentId) {\n      return fn(...arguments).then((success) => {\n        if (success) {\n          fireEvent('comment:delete', documentId, commentId);\n        }\n        return success;\n      });\n    };\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/adapter/StoreAdapter.js\n **/","/**\n * Throw an Error for an abstract function that hasn't been implemented.\n *\n * @param {String} name The name of the abstract function\n */\nexport default function abstractFunction(name) {\n  throw new Error(name + ' is not implemented');\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/abstractFunction.js\n **/","import EventEmitter from 'events';\nimport {\n  findAnnotationAtPoint,\n  findSVGAtPoint\n} from './utils';\n\nconst emitter = new EventEmitter;\n\nlet clickNode;\n\n/**\n * Handle document.click event\n *\n * @param {Event} e The DOM event to be handled\n */\ndocument.addEventListener('click', function handleDocumentClick(e) {\n  if (!findSVGAtPoint(e.clientX, e.clientY)) { return; }\n\n  let target = findAnnotationAtPoint(e.clientX, e.clientY);\n\n  // Emit annotation:blur if clickNode is no longer clicked\n  if (clickNode && clickNode !== target) {\n    emitter.emit('annotation:blur', clickNode, e);\n  }\n\n  // Emit annotation:click if target was clicked\n  if (target) {\n    emitter.emit('annotation:click', target, e);\n  }\n\n  clickNode = target;\n});\n\n// let mouseOverNode;\n// document.addEventListener('mousemove', function handleDocumentMousemove(e) {\n//   let target = findAnnotationAtPoint(e.clientX, e.clientY);\n//\n//   // Emit annotation:mouseout if target was mouseout'd\n//   if (mouseOverNode && !target) {\n//     emitter.emit('annotation:mouseout', mouseOverNode);\n//   }\n//\n//   // Emit annotation:mouseover if target was mouseover'd\n//   if (target && mouseOverNode !== target) {\n//     emitter.emit('annotation:mouseover', target);\n//   }\n//\n//   mouseOverNode = target;\n// });\n\nexport function fireEvent() { emitter.emit(...arguments); };\nexport function addEventListener() { emitter.on(...arguments); };\nexport function removeEventListener() { emitter.removeListener(...arguments); };\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/event.js\n **/","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/events/events.js\n ** module id = 5\n ** module chunks = 0\n **/","import createStyleSheet from 'create-stylesheet';\n\nexport const BORDER_COLOR = '#00BFFF';\n\nconst userSelectStyleSheet = createStyleSheet({\n  body: {\n    '-webkit-user-select': 'none',\n       '-moz-user-select': 'none',\n        '-ms-user-select': 'none',\n            'user-select': 'none'\n  }\n});\nuserSelectStyleSheet.setAttribute('data-pdf-annotate-user-select', 'true');\n\n/**\n * Find the SVGElement that contains all the annotations for a page\n *\n * @param {Element} node An annotation within that container\n * @return {SVGElement} The container SVG or null if it can't be found\n */\nexport function findSVGContainer(node) {\n  let parentNode = node;\n\n  while ((parentNode = parentNode.parentNode) &&\n          parentNode !== document) {\n    if (parentNode.nodeName.toUpperCase() === 'SVG' &&\n        parentNode.getAttribute('data-pdf-annotate-container') === 'true') {\n      return parentNode;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Find an SVGElement container at a given point\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @return {SVGElement} The container SVG or null if one can't be found\n */\nexport function findSVGAtPoint(x, y) {\n  let elements = document.querySelectorAll('svg[data-pdf-annotate-container=\"true\"]');\n\n  for (let i=0, l=elements.length; i<l; i++) {\n    let el = elements[i];\n    let rect = el.getBoundingClientRect();\n\n    if (pointIntersectsRect(x, y, rect)) {\n\n      return el;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Find an Element that represents an annotation at a given point\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @return {Element} The annotation element or null if one can't be found\n */\nexport function findAnnotationAtPoint(x, y) {\n  let svg = findSVGAtPoint(x, y);\n  if (!svg) { return; }\n  let elements = svg.querySelectorAll('[data-pdf-annotate-type]');\n\n  // Find a target element within SVG\n  for (let i=0, l=elements.length; i<l; i++) {\n    let el = elements[i];\n    if (pointIntersectsRect(x, y, getOffsetAnnotationRect(el))) {   \n      return el;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Determine if a point intersects a rect\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Object} rect The points of a rect (likely from getBoundingClientRect)\n * @return {Boolean} True if a collision occurs, otherwise false\n */\nexport function pointIntersectsRect(x, y, rect) {\n  return y >= rect.top && y <= rect.bottom && x >= rect.left && x <= rect.right;\n}\n\n/**\n * Get the rect of an annotation element accounting for offset.\n *\n * @param {Element} el The element to get the rect of\n * @return {Object} The dimensions of the element\n */\nexport function getOffsetAnnotationRect(el) {\n  let rect = getAnnotationRect(el);\n  let { offsetLeft, offsetTop } = getOffset(el);\n  return {\n    top: rect.top + offsetTop,\n    left: rect.left + offsetLeft,\n    right: rect.right + offsetLeft,\n    bottom: rect.bottom + offsetTop\n  };\n}\n\n/**\n * Get the rect of an annotation element.\n *\n * @param {Element} el The element to get the rect of\n * @return {Object} The dimensions of the element\n */\nexport function getAnnotationRect(el) {\n  let h = 0, w = 0, x = 0, y = 0;\n  let rect = el.getBoundingClientRect();\n  // TODO this should be calculated somehow\n  const LINE_OFFSET = 16;\n\n  switch (el.nodeName.toLowerCase()) {\n    case 'path':\n    let minX, maxX, minY, maxY;\n\n    el.getAttribute('d').replace(/Z/, '').split('M').splice(1).forEach((p) => {\n      var s = p.split(' ').map(i => parseInt(i, 10));\n\n      if (typeof minX === 'undefined' || s[0] < minX) { minX = s[0]; }\n      if (typeof maxX === 'undefined' || s[2] > maxX) { maxX = s[2]; }\n      if (typeof minY === 'undefined' || s[1] < minY) { minY = s[1]; }\n      if (typeof maxY === 'undefined' || s[3] > maxY) { maxY = s[3]; }\n    });\n\n    h = maxY - minY;\n    w = maxX - minX;\n    x = minX;\n    y = minY;\n    break;\n\n    case 'line':\n    h = parseInt(el.getAttribute('y2'), 10) - parseInt(el.getAttribute('y1'), 10);\n    w = parseInt(el.getAttribute('x2'), 10) - parseInt(el.getAttribute('x1'), 10);\n    x = parseInt(el.getAttribute('x1'), 10);\n    y = parseInt(el.getAttribute('y1'), 10);\n\n    if (h === 0) {\n      h += LINE_OFFSET;\n      y -= (LINE_OFFSET / 2);\n    }\n    break;\n\n    case 'text':\n    h = rect.height;\n    w = rect.width;\n    x = parseInt(el.getAttribute('x'), 10);\n    y = parseInt(el.getAttribute('y'), 10) - h;\n    break;\n\n    case 'g':\n    let { offsetLeft, offsetTop } = getOffset(el);\n    h = rect.height;\n    w = rect.width;\n    x = rect.left - offsetLeft;\n    y = rect.top - offsetTop;\n\n    if (el.getAttribute('data-pdf-annotate-type') === 'strikeout') {\n      h += LINE_OFFSET;\n      y -= (LINE_OFFSET / 2);\n    }\n    break;\n\n    case 'rect':\n    case 'svg':\n    h = parseInt(el.getAttribute('height'), 10);\n    w = parseInt(el.getAttribute('width'), 10);\n    x = parseInt(el.getAttribute('x'), 10);\n    y = parseInt(el.getAttribute('y'), 10);\n    break;\n  }\n\n  // Result provides same properties as getBoundingClientRect\n  let result = {\n    top: y,\n    left: x,\n    width: w,\n    height: h,\n    right: x + w,\n    bottom: y + h\n  };\n\n  // For the case of nested SVG (point annotations) and grouped\n  // lines or rects no adjustment needs to be made for scale.\n  // I assume that the scale is already being handled\n  // natively by virtue of the `transform` attribute.\n  if (!['svg', 'g'].includes(el.nodeName.toLowerCase())) {\n    result = scaleUp(findSVGAtPoint(rect.left, rect.top), result);\n  }\n\n  return result;\n}\n\n/**\n * Adjust scale from normalized scale (100%) to rendered scale.\n *\n * @param {SVGElement} svg The SVG to gather metadata from\n * @param {Object} rect A map of numeric values to scale\n * @return {Object} A copy of `rect` with values scaled up\n */\nexport function scaleUp(svg, rect) {\n  let result = {};\n  let { viewport } = getMetadata(svg);\n\n  Object.keys(rect).forEach((key) => {\n    result[key] = rect[key] * viewport.scale;\n  });\n\n  return result;\n}\n\n/**\n * Adjust scale from rendered scale to a normalized scale (100%).\n *\n * @param {SVGElement} svg The SVG to gather metadata from\n * @param {Object} rect A map of numeric values to scale\n * @return {Object} A copy of `rect` with values scaled down\n */\nexport function scaleDown(svg, rect) {\n  let result = {};\n  let { viewport } = getMetadata(svg);\n\n  Object.keys(rect).forEach((key) => {\n    result[key] = rect[key] / viewport.scale;\n  });\n\n  return result;\n}\n\n/**\n * Get the scroll position of an element, accounting for parent elements\n *\n * @param {Element} el The element to get the scroll position for\n * @return {Object} The scrollTop and scrollLeft position\n */\nexport function getScroll(el) {\n  let scrollTop = 0;\n  let scrollLeft = 0;\n  let parentNode = el;\n\n  while ((parentNode = parentNode.parentNode) &&\n          parentNode !== document) {\n    scrollTop += parentNode.scrollTop;\n    scrollLeft += parentNode.scrollLeft;\n  }\n\n  return { scrollTop, scrollLeft };\n}\n\n/**\n * Get the offset position of an element, accounting for parent elements\n *\n * @param {Element} el The element to get the offset position for\n * @return {Object} The offsetTop and offsetLeft position\n */\nexport function getOffset(el) {\n  let parentNode = el;\n\n  while ((parentNode = parentNode.parentNode) &&\n          parentNode !== document) {\n    if (parentNode.nodeName.toUpperCase() === 'SVG') {\n      break;\n    }\n  }\n\n  let rect = parentNode.getBoundingClientRect();\n\n  return { offsetLeft: rect.left, offsetTop: rect.top };\n}\n\n/**\n * Disable user ability to select text on page\n */\nexport function disableUserSelect() {\n  if (!userSelectStyleSheet.parentNode) {\n    document.head.appendChild(userSelectStyleSheet);\n  }\n}\n\n\n/**\n * Enable user ability to select text on page\n */\nexport function enableUserSelect() {\n  if (userSelectStyleSheet.parentNode) {\n    userSelectStyleSheet.parentNode.removeChild(userSelectStyleSheet);\n  }\n}\n\n/**\n * Get the metadata for a SVG container\n *\n * @param {SVGElement} svg The SVG container to get metadata for\n */\nexport function getMetadata(svg) {\n  return {\n    documentId: svg.getAttribute('data-pdf-annotate-document'),\n    pageNumber: parseInt(svg.getAttribute('data-pdf-annotate-page'), 10),\n    viewport: JSON.parse(svg.getAttribute('data-pdf-annotate-viewport'))\n  };\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/utils.js\n **/","module.exports = function createStyleSheet(blocks) {\n  var style = document.createElement('style');\n  var text = Object.keys(blocks).map(function (selector) {\n    return processRuleSet(selector, blocks[selector]);\n  }).join('\\n');\n  \n  style.setAttribute('type', 'text/css');\n  style.appendChild(document.createTextNode(text));\n\n  return style;\n}\n\nfunction processRuleSet(selector, block) {\n  return selector + ' {\\n' + processDeclarationBlock(block) + '\\n}';\n}\n\nfunction processDeclarationBlock(block) {\n  return Object.keys(block).map(function (prop) {\n    return processDeclaration(prop, block[prop]);\n  }).join('\\n');\n}\n\nfunction processDeclaration(prop, value) {\n  if (!isNaN(value) && value != 0) {\n    value = value + 'px';\n  }\n\n  return hyphenate(prop) + ': ' + value + ';';\n}\n\nfunction hyphenate(prop) {\n  return prop.replace(/[A-Z]/g, function (match) {\n    return '-' + match.toLowerCase();\n  });\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/create-stylesheet/index.js\n ** module id = 7\n ** module chunks = 0\n **/","import uuid from '../utils/uuid';\nimport StoreAdapter from './StoreAdapter';\n\n// StoreAdapter for working with localStorage\n// This is ideal for testing, examples, and prototyping\nexport default class LocalStoreAdapter extends StoreAdapter {\n  constructor() {\n    super({\n      getAnnotations(documentId, pageNumber) {\n        return new Promise((resolve, reject) => {\n          let annotations = getAnnotations(documentId).filter((i) => {\n            return i.page === pageNumber && i.class === 'Annotation';\n          });\n\n          resolve({\n            documentId,\n            pageNumber,\n            annotations\n          });\n        });\n      },\n\n      getAnnotation(documentId, annotationId) {\n        return Promise.resolve(getAnnotations(documentId)[findAnnotation(documentId, annotationId)]);\n      },\n\n      addAnnotation(documentId, pageNumber, annotation) {\n        return new Promise((resolve, reject) => {\n          annotation.class = 'Annotation';\n          annotation.uuid = uuid();\n          annotation.page = pageNumber;\n\n          let annotations = getAnnotations(documentId);\n          annotations.push(annotation);\n          updateAnnotations(documentId, annotations);\n\n          resolve(annotation);\n        });\n      },\n\n      editAnnotation(documentId, annotationId, annotation) {\n        return new Promise((resolve, reject) => {\n          let annotations = getAnnotations(documentId);\n          annotations[findAnnotation(documentId, annotationId)] = annotation;\n          updateAnnotations(documentId, annotations);\n\n          resolve(annotation);\n        });\n      },\n\n      deleteAnnotation(documentId, annotationId) {\n        return new Promise((resolve, reject) => {\n          let index = findAnnotation(documentId, annotationId);\n          if (index > -1) {\n            let annotations = getAnnotations(documentId);\n            annotations.splice(index, 1);\n            updateAnnotations(documentId, annotations);\n          }\n\n          resolve(true);\n        });\n      },\n\n      getComments(documentId, annotationId) {\n        return new Promise((resolve, reject) => {\n          resolve(getAnnotations(documentId).filter((i) => {\n            return i.class === 'Comment' && parseInt(i.annotation) === parseInt(annotationId);\n          }));\n        });\n      },\n\n      addComment(documentId, annotationId, content) {\n        return new Promise((resolve, reject) => {\n          let comment = {\n            class: 'Comment',\n            uuid: uuid(),\n            annotation: annotationId,\n            content: content\n          };\n\n          let annotations = getAnnotations(documentId);\n          annotations.push(comment);\n          updateAnnotations(documentId, annotations);\n\n          resolve(comment);\n        });\n      },\n\n      deleteComment(documentId, commentId) {\n        return new Promise((resolve, reject) => {\n          getAnnotations(documentId);\n          let index = -1;\n          let annotations = getAnnotations(documentId);\n          for (let i=0, l=annotations.length; i<l; i++) {\n            if (annotations[i].uuid === commentId) {\n              index = i;\n              break;\n            }\n          }\n\n          if (index > -1) {\n            annotations.splice(index, 1);\n            updateAnnotations(documentId, annotations);\n          }\n\n          resolve(true);\n        });\n      }\n    });\n  }\n}\n\nfunction getAnnotations(documentId) {\n  return JSON.parse(localStorage.getItem(`${documentId}/annotations`)) || [];\n}\n\nfunction updateAnnotations(documentId, annotations) {\n  localStorage.setItem(`${documentId}/annotations`, JSON.stringify(annotations));\n}\n\nfunction findAnnotation(documentId, annotationId) {\n  let index = -1;\n  let annotations = getAnnotations(documentId);\n  for (let i=0, l=annotations.length; i<l; i++) {\n    if (annotations[i].uuid === annotationId) {\n      index = i;\n      break;\n    }\n  }\n  return index;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/adapter/LocalStoreAdapter.js\n **/","const REGEXP = /[xy]/g\nconst PATTERN = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx';\n\nfunction replacement(c) {\n  let r = Math.random()*16|0;\n  let v = c == 'x' ? r : (r&0x3|0x8);\n  return v.toString(16);\n}\n\n/**\n * Generate a univierally unique identifier\n *\n * @return {String}\n */\nexport default function uuid() {\n  return PATTERN.replace(REGEXP, replacement);\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/uuid.js\n **/","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport appendChild from './appendChild';\nimport renderScreenReaderHints from '../a11y/renderScreenReaderHints';\n\n/**\n * Render the response from PDFJSAnnotate.getStoreAdapter().getAnnotations to SVG\n *\n * @param {SVGElement} svg The SVG element to render the annotations to\n * @param {Object} viewport The page viewport data\n * @param {Object} data The response from PDFJSAnnotate.getStoreAdapter().getAnnotations\n * @return {Promise} Settled once rendering has completed\n *  A settled Promise will be either:\n *    - fulfilled: SVGElement\n *    - rejected: Error\n */\nexport default function render(svg, viewport, data) {\n  return new Promise((resolve, reject) => {\n    // Reset the content of the SVG\n    svg.innerHTML = ''; \n    svg.setAttribute('data-pdf-annotate-container', true);\n    svg.setAttribute('data-pdf-annotate-viewport', JSON.stringify(viewport));\n    svg.removeAttribute('data-pdf-annotate-document');\n    svg.removeAttribute('data-pdf-annotate-page');\n\n    // If there's no data nothing can be done\n    if (!data) {\n      return resolve(svg);\n    }\n\n    svg.setAttribute('data-pdf-annotate-document', data.documentId);\n    svg.setAttribute('data-pdf-annotate-page', data.pageNumber);\n  \n    // Make sure annotations is an array\n    if (!Array.isArray(data.annotations) || data.annotations.length === 0) {\n      return resolve(svg);\n    }\n\n    // Append annotation to svg\n    data.annotations.forEach((a) => {\n      appendChild(svg, a, viewport);\n    });\n\n    resolve(svg);\n  });\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/render/index.js\n **/","import objectAssign from 'object-assign';\nimport renderLine from './renderLine';\nimport renderPath from './renderPath';\nimport renderPoint from './renderPoint';\nimport renderRect from './renderRect';\nimport renderText from './renderText';\n\nconst isFirefox = /firefox/i.test(navigator.userAgent);\n\n/**\n * Get the x/y translation to be used for transforming the annotations\n * based on the rotation of the viewport.\n *\n * @param {Object} viewport The viewport data from the page\n * @return {Object}\n */\nfunction getTranslation(viewport) {\n  let x;\n  let y;\n\n  // Modulus 360 on the rotation so that we only\n  // have to worry about four possible values.\n  switch(viewport.rotation % 360) {\n    case 0:\n      x = y = 0;\n      break;\n    case 90:\n      x = 0;\n      y = (viewport.width / viewport.scale) * -1;\n      break;\n    case 180:\n      x = (viewport.width / viewport.scale) * -1;\n      y = (viewport.height / viewport.scale) * -1;\n      break;\n    case 270:\n      x = (viewport.height / viewport.scale) * -1;\n      y = 0;\n      break;\n  }\n\n  return { x, y };\n}\n\n/**\n * Transform the rotation and scale of a node using SVG's native transform attribute.\n *\n * @param {Node} node The node to be transformed\n * @param {Object} viewport The page's viewport data\n * @return {Node}\n */\nfunction transform(node, viewport) {\n  let trans = getTranslation(viewport);\n\n  // Let SVG natively transform the element\n  //node.setAttribute('transform', `scale(${viewport.scale}) rotate(${viewport.rotation}) translate(${trans.x}, ${trans.y})`);\n  node.setAttribute('transform', `scale(${viewport.scale})`);\n\n  // Manually adjust x/y for nested SVG nodes\n  if (!isFirefox && node.nodeName.toLowerCase() === 'svg') {\n    node.setAttribute('x', parseInt(node.getAttribute('x'), 10) * viewport.scale);\n    node.setAttribute('y', parseInt(node.getAttribute('y'), 10) * viewport.scale);\n\n    let x = parseInt(node.getAttribute('x', 10));\n    let y = parseInt(node.getAttribute('y', 10));\n    let width = parseInt(node.getAttribute('width'), 10);\n    let height = parseInt(node.getAttribute('height'), 10);\n    let path = node.querySelector('path');\n    let svg = path.parentNode;\n   \n    // Scale width/height\n    [node, svg, path, node.querySelector('rect')].forEach((n) => {\n      n.setAttribute('width', parseInt(n.getAttribute('width'), 10) * viewport.scale);\n      n.setAttribute('height', parseInt(n.getAttribute('height'), 10) * viewport.scale);\n    });\n\n    // Transform path but keep scale at 100% since it will be handled natively\n    transform(path, objectAssign({}, viewport, { scale: 1 }));\n    \n    switch(viewport.rotation % 360) {\n      case 90:\n        node.setAttribute('x', viewport.width - y - width);\n        node.setAttribute('y', x);\n        svg.setAttribute('x', 1);\n        svg.setAttribute('y', 0);\n        break;\n      case 180:\n        node.setAttribute('x', viewport.width - x - width);\n        node.setAttribute('y', viewport.height - y - height);\n        svg.setAttribute('y', 2);\n        break;\n      case 270:\n        node.setAttribute('x', y);\n        node.setAttribute('y', viewport.height - x - height);\n        svg.setAttribute('x', -1);\n        svg.setAttribute('y', 0);\n        break;\n    }\n  }\n\n  return node;\n}\n\n/**\n * Append an annotation as a child of an SVG.\n *\n * @param {SVGElement} svg The SVG element to append the annotation to\n * @param {Object} annotation The annotation definition to render and append\n * @param {Object} viewport The page's viewport data\n * @return {SVGElement} A node that was created and appended by this function\n */\nexport default function appendChild(svg, annotation, viewport) {\n  if (!viewport) {\n    viewport = JSON.parse(svg.getAttribute('data-pdf-annotate-viewport'));\n  }\n  \n  let child;\n  switch (annotation.type) {\n    case 'area':\n    case 'highlight':\n      child = renderRect(annotation);\n      break;\n    case 'strikeout':\n      child = renderLine(annotation);\n      break;\n    case 'point':\n      child = renderPoint(annotation);\n      break;\n    case 'textbox':\n      child = renderText(annotation);\n      break;\n    case 'drawing':\n      child = renderPath(annotation);\n      break;\n  }\n\n  // If no type was provided for an annotation it will result in node being null.\n  // Skip appending/transforming if node doesn't exist.\n  if (child) {\n    // Set attributes\n    child.setAttribute('data-pdf-annotate-id', annotation.uuid);\n    child.setAttribute('data-pdf-annotate-type', annotation.type);\n    child.setAttribute('aria-hidden', true);\n\n    svg.appendChild(transform(child, viewport));\n  }\n\n  return child;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/render/appendChild.js\n **/","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/object-assign/index.js\n ** module id = 12\n ** module chunks = 0\n **/","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGLineElements from an annotation definition.\n * This is used for anntations of type `strikeout`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGGElement} A group of all lines to be rendered\n */\nexport default function renderLine(a) {\n  let group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n  setAttributes(group, {\n    stroke: normalizeColor(a.color || '#f00'),\n    strokeWidth: 1\n  });\n\n  a.rectangles.forEach((r) => {\n    let line = document.createElementNS('http://www.w3.org/2000/svg', 'line');\n\n    setAttributes(line, {\n      x1: r.x,\n      y1: r.y,\n      x2: r.x + r.width,\n      y2: r.y,\n    });\n\n    group.appendChild(line);\n  });\n\n  return group;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/render/renderLine.js\n **/","const UPPER_REGEX = /[A-Z]/g;\n\n// Don't convert these attributes from camelCase to hyphenated-attributes\nconst BLACKLIST = [\n  'viewBox'\n];\n\nlet keyCase = (key) => {\n  if (BLACKLIST.indexOf(key) === -1) {\n    key = key.replace(UPPER_REGEX, match => '-' + match.toLowerCase());\n  }\n  return key;\n}\n\n/**\n * Set attributes for a node from a map\n *\n * @param {Node} node The node to set attributes on\n * @param {Object} attributes The map of key/value pairs to use for attributes\n */\nexport default function setAttributes(node, attributes) {\n  Object.keys(attributes).forEach((key) => {\n    node.setAttribute(keyCase(key), attributes[key]);\n  });\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/setAttributes.js\n **/","const REGEX_HASHLESS_HEX = /^([a-f0-9]{6}|[a-f0-9]{3})$/i;\n\n/**\n * Normalize a color value\n *\n * @param {String} color The color to normalize\n * @return {String}\n */\nexport default function normalizeColor(color) {\n  if (REGEX_HASHLESS_HEX.test(color)) {\n    color = `#${color}`;\n  }\n  return color;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils/normalizeColor.js\n **/","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGPathElement from an annotation definition.\n * This is used for anntations of type `drawing`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGPathElement} The path to be rendered\n */\nexport default function renderPath(a) {\n  let d = [];\n  let path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n  \n  for (let i=0, l=a.lines.length; i<l; i++) {\n    var p1 = a.lines[i];\n    var p2 = a.lines[i+1];\n    if (p2) {\n      d.push(`M${p1[0]} ${p1[1]} ${p2[0]} ${p2[1]}`);\n    }\n  }\n  \n  setAttributes(path, {\n    d: `${d.join(' ')}Z`,\n    stroke: normalizeColor(a.color || '#000'),\n    strokeWidth: a.width || 1,\n    fill: 'none'\n  });\n\n  return path;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/render/renderPath.js\n **/","import setAttributes from '../utils/setAttributes';\n\nconst SIZE = 25;\nconst D = 'M499.968 214.336q-113.832 0 -212.877 38.781t-157.356 104.625 -58.311 142.29q0 62.496 39.897 119.133t112.437 97.929l48.546 27.9 -15.066 53.568q-13.392 50.778 -39.06 95.976 84.816 -35.154 153.45 -95.418l23.994 -21.204 31.806 3.348q38.502 4.464 72.54 4.464 113.832 0 212.877 -38.781t157.356 -104.625 58.311 -142.29 -58.311 -142.29 -157.356 -104.625 -212.877 -38.781z';\n\n/**\n * Create SVGElement from an annotation definition.\n * This is used for anntations of type `comment`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGElement} A svg to be rendered\n */\nexport default function renderPoint(a) {\n  let outerSVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n  let innerSVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n  let rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n  let path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n\n  setAttributes(outerSVG,  {\n    width: SIZE,\n    height: SIZE,\n    x: a.x,\n    y: a.y\n  });\n\n  setAttributes(innerSVG, {\n    width: SIZE,\n    height: SIZE,\n    x: 0,\n    y: (SIZE * 0.05) * -1,\n    viewBox: '0 0 1000 1000'\n  });\n\n  setAttributes(rect, {\n    width: SIZE,\n    height: SIZE,\n    stroke: '#000',\n    fill: '#ff0'\n  });\n\n  setAttributes(path, {\n    d: D,\n    strokeWidth: 50,\n    stroke: '#000',\n    fill: '#fff'\n  });\n\n  innerSVG.appendChild(path);\n  outerSVG.appendChild(rect);\n  outerSVG.appendChild(innerSVG);\n\n  return outerSVG;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/render/renderPoint.js\n **/","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGRectElements from an annotation definition.\n * This is used for anntations of type `area` and `highlight`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGGElement|SVGRectElement} A group of all rects to be rendered\n */\nexport default function renderRect(a) {\n  if (a.type === 'highlight') {\n    let group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n    setAttributes(group, {\n      fill: normalizeColor(a.color || '#ff0'),\n      fillOpacity: 0.2\n    });\n    \n    a.rectangles.forEach((r) => {\n      group.appendChild(createRect(r));\n    });\n\n    return group;\n  } else {\n    let rect = createRect(a);\n    setAttributes(rect, {\n      stroke: normalizeColor(a.color || '#f00'),\n      fill: 'none'\n    });\n\n    return rect;\n  }\n}\n\nfunction createRect(r) {\n  let rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n\n  setAttributes(rect, {\n    x: r.x,\n    y: r.y,\n    width: r.width,\n    height: r.height\n  });\n\n  return rect;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/render/renderRect.js\n **/","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGTextElement from an annotation definition.\n * This is used for anntations of type `textbox`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGTextElement} A text to be rendered\n */\nexport default function renderText(a) {\n  var text = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n\n  setAttributes(text, {\n    x: a.x,\n    y: a.y + parseInt(a.size, 10),\n    fill: normalizeColor(a.color || '#000'),\n    fontSize: a.size\n  });\n  text.innerHTML = a.content;\n\n  return text;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/render/renderText.js\n **/","import insertScreenReaderHint from './insertScreenReaderHint';\nimport initEventHandlers from './initEventHandlers';\n\n// TODO This is not the right place for this to live\ninitEventHandlers();\n\n/**\n * Insert hints into the DOM for screen readers.\n *\n * @param {Array} annotations The annotations that hints are inserted for\n */\nexport default function renderScreenReaderHints(annotations) {\n  annotations = Array.isArray(annotations) ? annotations : [];\n\n  // Insert hints for each type\n  Object.keys(SORT_TYPES).forEach((type) => {\n    let sortBy = SORT_TYPES[type];\n    annotations\n      .filter((a) => a.type === type)\n      .sort(sortBy)\n      .forEach((a, i) => insertScreenReaderHint(a, i + 1));\n  });\n}\n\n// Sort annotations first by y, then by x.\n// This allows hints to be injected in the order they appear,\n// which makes numbering them easier.\nfunction sortByPoint(a, b) {\n  if (a.y < b.y) {\n    return a.x - b.x;\n  } else {\n    return 1;\n  }\n}\n\n// Sort annotation by it's first rectangle\nfunction sortByRectPoint(a, b) {\n  return sortByPoint(a.rectangles[0], b.rectangles[0]);\n}\n\n// Sort annotation by it's first line\nfunction sortByLinePoint(a, b) {\n  let lineA = a.lines[0];\n  let lineB = b.lines[0];\n  return sortByPoint(\n    {x: lineA[0], y: lineA[1]},\n    {x: lineB[0], y: lineB[1]}\n  );\n}\n\n// Arrange supported types and associated sort methods\nconst SORT_TYPES = {\n  'highlight': sortByRectPoint,\n  'strikeout': sortByRectPoint,\n  'drawing': sortByLinePoint,\n  'textbox': sortByPoint,\n  'point': sortByPoint,\n  'area': sortByPoint\n};\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/a11y/renderScreenReaderHints.js\n **/","import createScreenReaderOnly from './createScreenReaderOnly';\nimport insertElementWithinChildren from './insertElementWithinChildren';\nimport insertElementWithinElement from './insertElementWithinElement';\nimport renderScreenReaderComments from './renderScreenReaderComments';\n\n// Annotation types that support comments\nconst COMMENT_TYPES = ['highlight', 'point', 'area', 'drawing', 'strikeout'];\n\n/**\n * Insert a hint into the DOM for screen readers for a specific annotation.\n *\n * @param {Object} annotation The annotation to insert a hint for\n * @param {Number} num The number of the annotation out of all annotations of the same type\n */\nexport default function insertScreenReaderHint(annotation, num = 0) {\n  switch (annotation.type) {\n    case 'highlight':\n    case 'strikeout':\n      let rects = annotation.rectangles;\n      let first = rects[0];\n      let last = rects[rects.length - 1];\n\n      insertElementWithinElement(\n        createScreenReaderOnly(`Begin ${annotation.type} annotation ${num}`, annotation.uuid),\n        first.x, first.y, annotation.page, true\n      );\n\n      insertElementWithinElement(\n        createScreenReaderOnly(`End ${annotation.type} annotation ${num}`, `${annotation.uuid}-end`),\n        last.x + last.width, last.y, annotation.page, false\n      );\n      break;\n\n    case 'textbox':\n    case 'point':\n      let text = annotation.type === 'textbox' ? ` (content: ${annotation.content})` : '';\n\n      insertElementWithinChildren(\n        createScreenReaderOnly(`${annotation.type} annotation ${num}${text}`, annotation.uuid),\n        annotation.x, annotation.y, annotation.page\n      );\n      break;\n\n    case 'drawing':\n    case 'area':\n      let x = typeof annotation.x !== 'undefined' ? annotation.x : annotation.lines[0][0];\n      let y = typeof annotation.y !== 'undefined' ? annotation.y : annotation.lines[0][1];\n\n      insertElementWithinChildren(\n        createScreenReaderOnly(`Unlabeled drawing`, annotation.uuid),\n        x, y, annotation.page\n      );\n      break;\n  }\n\n  // Include comments in screen reader hint\n  if (COMMENT_TYPES.includes(annotation.type)) {\n    renderScreenReaderComments(annotation.documentId, annotation.uuid);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/a11y/insertScreenReaderHint.js\n **/","/**\n * Create a node that is only visible to screen readers\n *\n * @param {String} content The text content that should be read by screen reader\n * @param {String} [annotationId] The ID of the annotation assocaited\n * @return {Element} An Element that is only visible to screen readers\n */\nexport default function createScreenReaderOnly(content, annotationId) {\n  let node = document.createElement('div');\n  let text = document.createTextNode(content);\n  node.appendChild(text);\n  node.setAttribute('id', `pdf-annotate-screenreader-${annotationId}`);\n  node.style.position = 'absolute';\n  node.style.left = '-10000px';\n  node.style.top = 'auto';\n  node.style.width = '1px';\n  node.style.height = '1px';\n  node.style.overflow = 'hidden';\n  return node;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/a11y/createScreenReaderOnly.js\n **/","import insertElementWithinElement from './insertElementWithinElement';\nimport { pointIntersectsRect } from '../UI/utils';\nimport { scaleUp } from '../UI/utils'; \n\n/**\n * Insert an element at a point within the document.\n * This algorithm will try to insert between elements if possible.\n * It will however use `insertElementWithinElement` if it is more accurate.\n *\n * @param {Element} el The element to be inserted\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Number} pageNumber The page number to limit elements to\n * @return {Boolean} True if element was able to be inserted, otherwise false\n */\nexport default function insertElementWithinChildren(el, x, y, pageNumber) {\n  // Try and use most accurate method of inserting within an element\n  if (insertElementWithinElement(el, x, y, pageNumber, true)) {\n    return true;\n  }\n\n  // Fall back to inserting between elements\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\n  let rect = svg.getBoundingClientRect();\n  let nodes = [...svg.parentNode.querySelectorAll('.textLayer > div')];\n\n  y = scaleUp(svg, {y}).y + rect.top;\n  x = scaleUp(svg, {x}).x + rect.left;\n\n  // Find the best node to insert before\n  for (let i=0, l=nodes.length; i<l; i++) {\n    let n = nodes[i];\n    let r = n.getBoundingClientRect();\n    if (y <= r.top) {\n      n.parentNode.insertBefore(el, n);\n      return true;\n    }\n  }\n\n  // If all else fails try to append to the bottom\n  let textLayer = svg.parentNode.querySelector('.textLayer');\n  if (textLayer) {\n    let textRect = textLayer.getBoundingClientRect();\n    if (pointIntersectsRect(x, y, textRect)) {\n      textLayer.appendChild(el);\n      return true;\n    }\n  }\n\n  return false;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/a11y/insertElementWithinChildren.js\n **/","import {\n  pointIntersectsRect,\n  scaleUp,\n  scaleDown\n} from '../UI/utils'; \n\n/**\n * Insert an element at a point within the document.\n * This algorithm will only insert within an element amidst it's text content.\n *\n * @param {Element} el The element to be inserted\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Number} pageNumber The page number to limit elements to\n * @param {Boolean} insertBefore Whether the element is to be inserted before or after x\n * @return {Boolean} True if element was able to be inserted, otherwise false\n */\nexport default function insertElementWithinElement(el, x, y, pageNumber, insertBefore) {\n  const OFFSET_ADJUST = 2;\n\n  // If inserting before adjust `x` by looking for element a few px to the right\n  // Otherwise adjust a few px to the left\n  // This is to allow a little tolerance by searching within the box, instead\n  // of getting a false negative by testing right on the border.\n  x = Math.max(x + (OFFSET_ADJUST * (insertBefore ? 1 : -1)), 0);\n\n  let node = textLayerElementFromPoint(x, y + OFFSET_ADJUST, pageNumber);\n  if (!node) {\n    return false;\n  }\n  \n  // Now that node has been found inverse the adjustment for `x`.\n  // This is done to accomodate tolerance by cutting off on the outside of the\n  // text boundary, instead of missing a character by cutting off within.\n  x = x + (OFFSET_ADJUST * (insertBefore ? -1 : 1));\n\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\n  let left = scaleDown(svg, {left: node.getBoundingClientRect().left}).left - svg.getBoundingClientRect().left;\n  let temp = node.cloneNode(true);\n  let head = temp.innerHTML.split('');\n  let tail = [];\n\n  // Insert temp off screen\n  temp.style.position = 'absolute';\n  temp.style.top = '-10000px';\n  temp.style.left = '-10000px';\n  document.body.appendChild(temp);\n\n  while (head.length) {\n    // Don't insert within HTML tags\n    if (head[head.length - 1] === '>') {\n      while(head.length) {\n        tail.unshift(head.pop());\n        if (tail[0] === '<') {\n          break;\n        }\n      }\n    }\n    \n    // Check if width of temp based on current head value satisfies x\n    temp.innerHTML = head.join('');\n    let width = scaleDown(svg, {width: temp.getBoundingClientRect().width}).width;\n    if (left + width <= x) {\n      break;\n    }\n    tail.unshift(head.pop());\n  }\n  \n  // Update original node with new markup, including element to be inserted\n  node.innerHTML = head.join('') + el.outerHTML + tail.join('');\n  temp.parentNode.removeChild(temp);\n\n  return true;\n}\n\n/**\n * Get a text layer element at a given point on a page\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Number} pageNumber The page to limit elements to\n * @return {Element} First text layer element found at the point\n */\nfunction textLayerElementFromPoint(x, y, pageNumber) {\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\n  let rect = svg.getBoundingClientRect();\n  y = scaleUp(svg, {y}).y + rect.top;\n  x = scaleUp(svg, {x}).x + rect.left;\n  return [...svg.parentNode.querySelectorAll('.textLayer [data-canvas-width]')].filter((el) => {\n    return pointIntersectsRect(x, y, el.getBoundingClientRect());\n  })[0];\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/a11y/insertElementWithinElement.js\n **/","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport insertScreenReaderComment from './insertScreenReaderComment';\n\n/**\n * Insert the comments into the DOM to be available by screen reader\n *\n * Example output:\n *   <div class=\"screenReaderOnly\">\n *    <div>Begin highlight 1</div>\n *    <ol aria-label=\"Comments\">\n *      <li>Foo</li>\n *      <li>Bar</li>\n *      <li>Baz</li>\n *      <li>Qux</li>\n *    </ol>\n *  </div>\n *  <div>Some highlighted text goes here...</div>\n *  <div class=\"screenReaderOnly\">End highlight 1</div>\n *\n * NOTE: `screenReaderOnly` is not a real class, just used for brevity\n *\n * @param {String} documentId The ID of the document\n * @param {String} annotationId The ID of the annotation\n * @param {Array} [comments] Optionally preloaded comments to be rendered\n * @return {Promise}\n */\nexport default function renderScreenReaderComments(documentId, annotationId, comments) {\n  let promise;\n\n  if (Array.isArray(comments)) {\n    promise = Promise.resolve(comments);\n  } else {\n    promise = PDFJSAnnotate.getStoreAdapter().getComments(documentId, annotationId);\n  }\n\n  return promise.then((comments) => {\n    // Node needs to be found by querying DOM as it may have been inserted as innerHTML\n    // leaving `screenReaderNode` as an invalid reference (see `insertElementWithinElement`).\n    let node = document.getElementById(`pdf-annotate-screenreader-${annotationId}`);\n    if (node) { \n      let list = document.createElement('ol');\n      list.setAttribute('id', `pdf-annotate-screenreader-comment-list-${annotationId}`);\n      list.setAttribute('aria-label', 'Comments');\n      node.appendChild(list);\n      comments.forEach(insertScreenReaderComment);\n    }\n  });\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/a11y/renderScreenReaderComments.js\n **/","/**\n * Insert a comment into the DOM to be available by screen reader\n *\n * @param {Object} comment The comment to be inserted\n */\nexport default function insertScreenReaderComment(comment) {\n  if (!comment) {\n    return;\n  }\n\n  let list = document.querySelector(`#pdf-annotate-screenreader-${comment.annotation} ol`);\n  if (list) {\n    let item = document.createElement('li');\n    item.setAttribute('id', `pdf-annotate-screenreader-comment-${comment.uuid}`);\n    item.appendChild(document.createTextNode(`${comment.content}`));\n    list.appendChild(item);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/a11y/insertScreenReaderComment.js\n **/","import insertScreenReaderHint from './insertScreenReaderHint';\nimport renderScreenReaderHints from './renderScreenReaderHints';\nimport insertScreenReaderComment from './insertScreenReaderComment';\nimport renderScreenReaderComments from './renderScreenReaderComments';\nimport { addEventListener } from '../UI/event';\nimport PDFJSAnnotate from '../PDFJSAnnotate';\n\n/**\n * Initialize the event handlers for keeping screen reader hints synced with data\n */\nexport default function initEventHandlers() {\n  addEventListener('annotation:add', (documentId, pageNumber, annotation) => {\n    reorderAnnotationsByType(documentId, pageNumber, annotation.type);\n  });\n  addEventListener('annotation:edit', (documentId, annotationId, annotation) => {\n    reorderAnnotationsByType(documentId, annotation.page, annotation.type);\n  });\n  addEventListener('annotation:delete', removeAnnotation);\n  addEventListener('comment:add', insertComment);\n  addEventListener('comment:delete', removeComment);\n}\n\n/**\n * Reorder the annotation numbers by annotation type\n *\n * @param {String} documentId The ID of the document\n * @param {Number} pageNumber The page number of the annotations\n * @param {Strig} type The annotation type\n */\nfunction reorderAnnotationsByType(documentId, pageNumber, type) {\n  PDFJSAnnotate.getStoreAdapter().getAnnotations(documentId, pageNumber)\n    .then((annotations) => {\n      return annotations.annotations.filter((a) => {\n        return a.type === type;\n      });\n    })\n    .then((annotations) => {\n      annotations.forEach((a) => {\n        removeAnnotation(documentId, a.uuid);\n      });\n\n      return annotations;\n    })\n    .then(renderScreenReaderHints);\n}\n\n/**\n * Remove the screen reader hint for an annotation\n *\n * @param {String} documentId The ID of the document\n * @param {String} annotationId The Id of the annotation\n */\nfunction removeAnnotation(documentId, annotationId) {\n  removeElementById(`pdf-annotate-screenreader-${annotationId}`);\n  removeElementById(`pdf-annotate-screenreader-${annotationId}-end`);\n}\n\n/**\n * Insert a screen reader hint for a comment\n *\n * @param {String} documentId The ID of the document\n * @param {String} annotationId The ID of tha assocated annotation\n * @param {Object} comment The comment to insert a hint for\n */\nfunction insertComment(documentId, annotationId, comment) {\n  let list = document.querySelector(`pdf-annotate-screenreader-comment-list-${annotationId}`);\n  let promise;\n\n  if (!list) {\n    promise = renderScreenReaderComments(documentId, annotationId, []).then(() => {\n      list = document.querySelector(`pdf-annotate-screenreader-comment-list-${annotationId}`);\n      return true;\n    });\n  } else {\n    promise = Promise.resolve(true);\n  }\n\n  promise.then(() => {\n    insertScreenReaderComment(comment);\n  });\n}\n\n/**\n * Remove a screen reader hint for a comment\n *\n * @param {String} documentId The ID of the document\n * @param {String} commentId The ID of the comment\n */\nfunction removeComment(documentId, commentId) {\n  removeElementById(`pdf-annotate-screenreader-comment-${commentId}`);\n}\n\n/**\n * Remove an element from the DOM by it's ID if it exists\n *\n * @param {String} elementID The ID of the element to be removed\n */\nfunction removeElementById(elementId) {\n  let el = document.getElementById(elementId);\n  if (el) {\n    el.parentNode.removeChild(el);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/a11y/initEventHandlers.js\n **/","import { addEventListener, removeEventListener, fireEvent } from './event';\nimport { disableEdit, enableEdit, setCanEdit } from './edit';\nimport { disablePen, enablePen, setPen } from './pen';\nimport { disablePoint, enablePoint } from './point';\nimport { disableRect, enableRect } from './rect';\nimport { disableText, enableText, setText } from './text';\nimport { createPage, renderPage } from './page';\n\nexport default {\n  addEventListener, removeEventListener, fireEvent,\n  disableEdit, enableEdit, setCanEdit,\n  disablePen, enablePen, setPen,\n  disablePoint, enablePoint,\n  disableRect, enableRect,\n  disableText, enableText, setText,\n  createPage, renderPage\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/index.js\n **/","import PDFJSAnnotate from '../PDFJSAnnotate';\n\nimport appendChild from '../render/appendChild';\nimport {\n  addEventListener,\n  removeEventListener\n} from './event';\nimport {\n  BORDER_COLOR,\n  disableUserSelect,\n  enableUserSelect,\n  findSVGContainer,\n  findSVGAtPoint,\n  getAnnotationRect,\n  getMetadata,\n  scaleDown,\n  scaleUp\n} from './utils';\n\nlet _enabled = false;\nlet _canEdit = true;\nlet isDragging = false, overlay;\nlet dragOffsetX, dragOffsetY, dragStartX, dragStartY;\nconst OVERLAY_BORDER_SIZE = 3;\n\n/**\n * Create an overlay for editing an annotation.\n *\n * @param {Element} target The annotation element to apply overlay for\n */\nfunction createEditOverlay(target) {\n\n  if(!target || !target.parentNode) {\n    return;\n  }\n\n  // check if we are clicking on same Annotation, and if yes, exit early\n  if(overlay) {\n\n    var overlayId = overlay.getAttribute('data-target-id');\n    var targetId = target.getAttribute('data-pdf-annotate-id');\n\n    if (overlayId === targetId) {\n      return;\n    }\n  }\n\n  destroyEditOverlay();\n\n  overlay = document.createElement('div');\n  let anchor = document.createElement('a');\n  let parentNode = findSVGContainer(target).parentNode;\n  let id = target.getAttribute('data-pdf-annotate-id');\n  let rect = getAnnotationRect(target);\n  let styleLeft = rect.left - OVERLAY_BORDER_SIZE;\n  let styleTop = rect.top - OVERLAY_BORDER_SIZE;\n  \n  overlay.setAttribute('id', 'pdf-annotate-edit-overlay');\n  overlay.setAttribute('data-target-id', id);\n  overlay.style.boxSizing = 'content-box';\n  overlay.style.position = 'absolute';\n  overlay.style.top = `${styleTop}px`;\n  overlay.style.left = `${styleLeft}px`;\n  overlay.style.width = `${rect.width}px`;\n  overlay.style.height = `${rect.height}px`;\n  overlay.style.border = `${OVERLAY_BORDER_SIZE}px solid ${BORDER_COLOR}`;\n  overlay.style.borderRadius = `${OVERLAY_BORDER_SIZE}px`;\n\n  if (_canEdit) {\n    anchor.innerHTML = '';\n    anchor.setAttribute('href', 'javascript://');\n    anchor.style.background = '#fff';\n    anchor.style.borderRadius = '20px';\n    anchor.style.border = '1px solid #bbb';\n    anchor.style.color = '#bbb';\n    anchor.style.fontSize = '16px';\n    anchor.style.padding = '2px';\n    anchor.style.textAlign = 'center';\n    anchor.style.textDecoration = 'none';\n    anchor.style.position = 'absolute';\n    anchor.style.top = '-13px';\n    anchor.style.right = '-13px';\n    anchor.style.width = '25px';\n    anchor.style.height = '25px';\n    \n    overlay.appendChild(anchor);\n    \n    document.addEventListener('click', handleDocumentClick);\n    document.addEventListener('keyup', handleDocumentKeyup);\n    document.addEventListener('mousedown', handleDocumentMousedown);\n    anchor.addEventListener('click', deleteAnnotation);\n    anchor.addEventListener('mouseover', () => {\n      anchor.style.color = '#35A4DC';\n      anchor.style.borderColor = '#999';\n      anchor.style.boxShadow = '0 1px 1px #ccc';\n    });\n    anchor.addEventListener('mouseout', () => {\n      anchor.style.color = '#bbb';\n      anchor.style.borderColor = '#bbb';\n      anchor.style.boxShadow = '';\n    });\n    overlay.addEventListener('mouseover', () => {\n      if (!isDragging) { anchor.style.display = ''; }\n    });\n    overlay.addEventListener('mouseout', () => {\n      anchor.style.display = 'none';\n    });\n  }\n\n  parentNode.appendChild(overlay);\n}\n\n/**\n * Destroy the edit overlay if it exists.\n */\nfunction destroyEditOverlay() {\n\n  if (overlay && overlay.parentNode) {\n    overlay.parentNode.removeChild(overlay);\n  }\n  overlay = null;\n\n  document.removeEventListener('click', handleDocumentClick);\n  document.removeEventListener('keyup', handleDocumentKeyup);\n  document.removeEventListener('mousedown', handleDocumentMousedown);\n  document.removeEventListener('mousemove', handleDocumentMousemove);\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n  enableUserSelect();\n}\n\n/**\n * Delete currently selected annotation\n */\nfunction deleteAnnotation() {\n  if (!overlay) { return; }\n\n  let annotationId = overlay.getAttribute('data-target-id');\n  let nodes = document.querySelectorAll(`[data-pdf-annotate-id=\"${annotationId}\"]`);\n  let svg = overlay.parentNode.querySelector('svg.annotationLayer');\n  let { documentId } = getMetadata(svg);\n\n  [...nodes].forEach((n) => {\n    n.parentNode.removeChild(n);\n  });\n  \n  PDFJSAnnotate.getStoreAdapter().deleteAnnotation(documentId, annotationId);\n\n  destroyEditOverlay();\n}\n\n/**\n * Handle document.click event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentClick(e) {\n  if (!findSVGAtPoint(e.clientX, e.clientY)) { return; }\n\n  // Remove current overlay\n  let overlay = document.getElementById('pdf-annotate-edit-overlay');\n  if (overlay) {\n    if (isDragging || e.target === overlay) {\n      return;\n    }\n\n    destroyEditOverlay();\n  }\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentKeyup(e) {\n  if (overlay && e.keyCode === 46 &&\n      e.target.nodeName.toLowerCase() !== 'textarea' &&\n      e.target.nodeName.toLowerCase() !== 'input') {\n    deleteAnnotation();\n  }\n}\n\n/**\n * Handle document.mousedown event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentMousedown(e) {\n  if (e.target !== overlay) { return; }\n\n  // Highlight and strikeout annotations are bound to text within the document.\n  // It doesn't make sense to allow repositioning these types of annotations.\n  let annotationId = overlay.getAttribute('data-target-id');\n  let target = document.querySelector(`[data-pdf-annotate-id=\"${annotationId}\"]`);\n  let type = target.getAttribute('data-pdf-annotate-type');\n\n  if (type === 'highlight' || type === 'strikeout') { return; }\n\n  isDragging = true;\n  dragOffsetX = e.clientX;\n  dragOffsetY = e.clientY;\n  dragStartX = overlay.offsetLeft;\n  dragStartY = overlay.offsetTop;\n\n  overlay.style.background = 'rgba(255, 255, 255, 0.7)';\n  overlay.style.cursor = 'move';\n  overlay.querySelector('a').style.display = 'none';\n\n  document.addEventListener('mousemove', handleDocumentMousemove);\n  document.addEventListener('mouseup', handleDocumentMouseup);\n  disableUserSelect();\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentMousemove(e) {\n  let annotationId = overlay.getAttribute('data-target-id');\n  let parentNode = overlay.parentNode;\n  let rect = parentNode.getBoundingClientRect();\n  let y = (dragStartY + (e.clientY - dragOffsetY));\n  let x = (dragStartX + (e.clientX - dragOffsetX));\n  let minY = 0;\n  let maxY = rect.height;\n  let minX = 0;\n  let maxX = rect.width;\n\n  if (y > minY && y + overlay.offsetHeight < maxY) {\n    overlay.style.top = `${y}px`;\n  }\n\n  if (x > minX && x + overlay.offsetWidth < maxX) {\n    overlay.style.left = `${x}px`;\n  }\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentMouseup(e) {\n  let annotationId = overlay.getAttribute('data-target-id');\n  let target = document.querySelectorAll(`[data-pdf-annotate-id=\"${annotationId}\"]`);\n  let type = target[0].getAttribute('data-pdf-annotate-type');\n  let svg = overlay.parentNode.querySelector('svg.annotationLayer');\n  let { documentId } = getMetadata(svg);\n  \n  overlay.querySelector('a').style.display = '';\n\n  function getDelta(propX, propY) {\n    return calcDelta(parseInt(target[0].getAttribute(propX), 10), parseInt(target[0].getAttribute(propY), 10));\n  }\n\n  function calcDelta(x, y) {\n    return {\n      deltaX: OVERLAY_BORDER_SIZE + scaleDown(svg, {x: overlay.offsetLeft }).x - x,\n      deltaY: OVERLAY_BORDER_SIZE + scaleDown(svg, {y: overlay.offsetTop }).y - y\n    };\n  }\n\n  PDFJSAnnotate.getStoreAdapter().getAnnotation(documentId, annotationId).then((annotation) => {\n    \n    // exit early if those are not present (happens with Spammy clicking)\n    if(!target || !svg || !target[0] || !target[0].parentNode) {\n      return;\n    }\n\n    if (['area', 'highlight', 'point', 'textbox', 'strikeout'].includes(type)) {\n      let { deltaX, deltaY } = getDelta('x', 'y');\n      [...target].forEach((t, i) => {\n        if (deltaY !== 0) {\n          let modelY = parseInt(t.getAttribute('y'), 10) + deltaY;\n          let viewY = modelY;\n\n          if (type === 'textbox') {\n            viewY += annotation.size;\n          }\n\n          if (type === 'point') {\n            viewY = scaleUp(svg, { viewY }).viewY;\n          }\n\n          t.setAttribute('y', viewY);\n          if (annotation.rectangles) {\n            annotation.rectangles[i].y = modelY;\n          } else if (annotation.y) {\n            annotation.y = modelY;\n          }\n        }\n        if (deltaX !== 0) {\n          let modelX = parseInt(t.getAttribute('x'), 10) + deltaX;\n          let viewX = modelX;\n\n          if (type === 'point') {\n            viewX = scaleUp(svg, { viewX }).viewX;\n          }\n\n          t.setAttribute('x', viewX);\n          if (annotation.rectangles) {\n            annotation.rectangles[i].x = modelX;\n          } else if (annotation.x) {\n            annotation.x = modelX;\n          }\n        }\n\n        if(deltaX !== 0 || deltaY !== 0) {\n          PDFJSAnnotate.getStoreAdapter().editAnnotation(documentId, annotationId, annotation);\n        }\n      });\n    // } else if (type === 'strikeout') {\n    //   let { deltaX, deltaY } = getDelta('x1', 'y1');\n    //   [...target].forEach(target, (t, i) => {\n    //     if (deltaY !== 0) {\n    //       t.setAttribute('y1', parseInt(t.getAttribute('y1'), 10) + deltaY);\n    //       t.setAttribute('y2', parseInt(t.getAttribute('y2'), 10) + deltaY);\n    //       annotation.rectangles[i].y = parseInt(t.getAttribute('y1'), 10);\n    //     }\n    //     if (deltaX !== 0) {\n    //       t.setAttribute('x1', parseInt(t.getAttribute('x1'), 10) + deltaX);\n    //       t.setAttribute('x2', parseInt(t.getAttribute('x2'), 10) + deltaX);\n    //       annotation.rectangles[i].x = parseInt(t.getAttribute('x1'), 10);\n    //     }\n    //   });\n    } else if (type === 'drawing') {\n      let rect = scaleDown(svg, getAnnotationRect(target[0]));\n      let [originX, originY] = annotation.lines[0];\n      let { deltaX, deltaY } = calcDelta(originX, originY);\n\n      // origin isn't necessarily at 0/0 in relation to overlay x/y\n      // adjust the difference between overlay and drawing coords\n      deltaY += (originY - rect.top);\n      deltaX += (originX - rect.left);\n\n      annotation.lines.forEach((line, i) => {\n        let [x, y] = annotation.lines[i];\n        annotation.lines[i][0] = x + deltaX;\n        annotation.lines[i][1] = y + deltaY;\n      });\n\n      target[0].parentNode.removeChild(target[0]);\n      appendChild(svg, annotation);\n\n      if(deltaX !== 0 || deltaY !== 0) {\n        PDFJSAnnotate.getStoreAdapter().editAnnotation(documentId, annotationId, annotation);\n      }\n    }\n  });\n\n  setTimeout(() => {\n    isDragging = false;\n  }, 0);\n\n  overlay.style.background = '';\n  overlay.style.cursor = '';\n\n  document.removeEventListener('mousemove', handleDocumentMousemove);\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n  enableUserSelect();\n}\n\n/**\n * Handle annotation.click event\n *\n * @param {Element} e The annotation element that was clicked\n */\nfunction handleAnnotationClick(target) {\n  createEditOverlay(target);\n}\n\n/**\n * Added to disable movement and deletion of annotations while still\n * allowing selection\n */\nexport function setCanEdit(value) {\n  _canEdit = value;\n}\n\n/**\n * Enable edit mode behavior.\n */\nexport function enableEdit () {\n  if (_enabled) { return; }\n\n  _enabled = true;\n  addEventListener('annotation:click', handleAnnotationClick);\n};\n\n/**\n * Disable edit mode behavior.\n */\nexport function disableEdit () {\n  destroyEditOverlay();\n\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  removeEventListener('annotation:click', handleAnnotationClick);\n};\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/edit.js\n **/","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport appendChild from '../render/appendChild';\nimport {\n  disableUserSelect,\n  enableUserSelect,\n  findSVGAtPoint,\n  getMetadata,\n  scaleDown\n} from './utils';\n\nlet _enabled = false;\nlet _penSize;\nlet _penColor;\nlet path;\nlet lines;\n\n/**\n * Handle document.mousedown event\n */\nfunction handleDocumentMousedown() {\n  path = null;\n  lines = [];\n\n  document.addEventListener('mousemove', handleDocumentMousemove);\n  document.addEventListener('mouseup', handleDocumentMouseup);\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to be handled\n */\nfunction handleDocumentMouseup(e) {\n  let svg;\n  if (lines.length > 1 && (svg = findSVGAtPoint(e.clientX, e.clientY))) {\n    let { documentId, pageNumber } = getMetadata(svg);\n\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, {\n        type: 'drawing',\n        width: _penSize,\n        color: _penColor,\n        lines\n      }\n    ).then((annotation) => {\n      if (path) {\n        svg.removeChild(path);\n      }\n\n      appendChild(svg, annotation);\n    });\n  }\n\n  document.removeEventListener('mousemove', handleDocumentMousemove);\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {Event} e The DOM event to be handled\n */\nfunction handleDocumentMousemove(e) {\n  savePoint(e.clientX, e.clientY);\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {Event} e The DOM event to be handled\n */\nfunction handleDocumentKeyup(e) {\n  // Cancel rect if Esc is pressed\n  if (e.keyCode === 27) {\n    lines = null;\n    path.parentNode.removeChild(path);\n    document.removeEventListener('mousemove', handleDocumentMousemove);\n    document.removeEventListener('mouseup', handleDocumentMouseup);\n  }\n}\n\n/**\n * Save a point to the line being drawn.\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n */\nfunction savePoint(x, y) {\n  let svg = findSVGAtPoint(x, y);\n  if (!svg) {\n    return;\n  }\n\n  let rect = svg.getBoundingClientRect();\n  let point = scaleDown(svg, {\n    x: x - rect.left,\n    y: y - rect.top\n  });\n\n  lines.push([point.x, point.y]);\n\n  if (lines.length <= 1) {\n    return;\n  }\n\n  if (path) {\n    svg.removeChild(path);\n  }\n\n  path = appendChild(svg, {\n    type: 'drawing',\n    color: _penColor,\n    width: _penSize,\n    lines\n  });\n}\n\n/**\n * Set the attributes of the pen.\n *\n * @param {Number} penSize The size of the lines drawn by the pen\n * @param {String} penColor The color of the lines drawn by the pen\n */\nexport function setPen(penSize = 1, penColor = '000000') {\n  _penSize = parseInt(penSize, 10);\n  _penColor = penColor;\n}\n\n/**\n * Enable the pen behavior\n */\nexport function enablePen() {\n  if (_enabled) { return; }\n\n  _enabled = true;\n  document.addEventListener('mousedown', handleDocumentMousedown);\n  document.addEventListener('keyup', handleDocumentKeyup);\n  disableUserSelect();\n}\n\n/**\n * Disable the pen behavior\n */\nexport function disablePen() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mousedown', handleDocumentMousedown);\n  document.removeEventListener('keyup', handleDocumentKeyup);\n  enableUserSelect();\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/pen.js\n **/","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport appendChild from '../render/appendChild';\nimport {\n  BORDER_COLOR,\n  findSVGAtPoint,\n  getMetadata,\n  scaleDown\n} from './utils';\n\nlet _enabled = false;\nlet input;\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} The DOM event to be handled\n */\nfunction handleDocumentMouseup(e) {\n  if (input || !findSVGAtPoint(e.clientX, e.clientY)) {\n    return\n  }\n  \n  input = document.createElement('input');\n  input.setAttribute('id', 'pdf-annotate-point-input');\n  input.setAttribute('placeholder', 'Enter comment');\n  input.style.border = `3px solid ${BORDER_COLOR}`;\n  input.style.borderRadius = '3px';\n  input.style.position = 'absolute';\n  input.style.top = `${e.clientY}px`;\n  input.style.left = `${e.clientX}px`;\n\n  input.addEventListener('blur', handleInputBlur);\n  input.addEventListener('keyup', handleInputKeyup);\n\n  document.body.appendChild(input);\n  input.focus();\n}\n\n/**\n * Handle input.blur event\n */\nfunction handleInputBlur() {\n  savePoint();\n}\n\n/**\n * Handle input.keyup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleInputKeyup(e) {\n  if (e.keyCode === 27) {\n    closeInput();\n  } else if (e.keyCode === 13) {\n    savePoint();\n  }\n}\n\n/**\n * Save a new point annotation from input\n */\nfunction savePoint() {\n  if (input.value.trim().length > 0) {\n    let clientX = parseInt(input.style.left, 10);\n    let clientY = parseInt(input.style.top, 10);\n    let content = input.value.trim();\n    let svg = findSVGAtPoint(clientX, clientY);\n    if (!svg) {\n      return;\n    }\n\n    let rect = svg.getBoundingClientRect();\n    let { documentId, pageNumber } = getMetadata(svg);\n    let annotation = Object.assign({\n        type: 'point'\n      }, scaleDown(svg, {\n        x: clientX - rect.left,\n        y: clientY - rect.top\n      })\n    );\n\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n      .then((annotation) => {\n        PDFJSAnnotate.getStoreAdapter().addComment(\n          documentId,\n          annotation.uuid,\n          content\n        );\n\n        appendChild(svg, annotation);\n      });\n  }\n\n  closeInput();\n}\n\n/**\n * Close the input element\n */\nfunction closeInput() {\n  input.removeEventListener('blur', handleInputBlur);\n  input.removeEventListener('keyup', handleInputKeyup);\n  document.body.removeChild(input);\n  input = null;\n}\n\n/**\n * Enable point annotation behavior\n */\nexport function enablePoint() {\n  if (_enabled) { return; }\n\n  _enabled = true;\n  document.addEventListener('mouseup', handleDocumentMouseup);\n}\n\n/**\n * Disable point annotation behavior\n */\nexport function disablePoint() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/point.js\n **/","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport appendChild from '../render/appendChild';\nimport {\n  BORDER_COLOR,\n  disableUserSelect,\n  enableUserSelect,\n  findSVGAtPoint,\n  getMetadata,\n  getOffset,\n  scaleDown,\n  scaleUp\n} from './utils';\n\nlet _enabled = false;\nlet _type;\nlet overlay;\nlet originY;\nlet originX;\n\n/**\n * Get the current window selection as rects\n *\n * @return {Array} An Array of rects\n */\nfunction getSelectionRects() {\n  try {\n    let selection = window.getSelection();\n    let range = selection.getRangeAt(0);\n    let rects = range.getClientRects();\n\n    if (rects.length > 0 &&\n        rects[0].width > 0 &&\n        rects[0].height > 0) {\n      return rects;\n    }\n  } catch (e) {}\n  \n  return null;\n}\n\n/**\n * Handle document.mousedown event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMousedown(e) {\n  let svg;\n  if (_type !== 'area' || !(svg = findSVGAtPoint(e.clientX, e.clientY))) {\n    return;\n  }\n\n  let rect = svg.getBoundingClientRect();\n  originY = e.clientY;\n  originX = e.clientX;\n\n  overlay = document.createElement('div');\n  overlay.style.position = 'absolute';\n  overlay.style.top = `${originY - rect.top}px`;\n  overlay.style.left = `${originX - rect.left}px`;\n  overlay.style.border = `3px solid ${BORDER_COLOR}`;\n  overlay.style.borderRadius = '3px';\n  svg.parentNode.appendChild(overlay);\n  \n  document.addEventListener('mousemove', handleDocumentMousemove);\n  disableUserSelect();\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMousemove(e) {\n  let svg = overlay.parentNode.querySelector('svg.annotationLayer');\n  let rect = svg.getBoundingClientRect();\n\n  if (originX + (e.clientX - originX) < rect.right) {\n    overlay.style.width = `${e.clientX - originX}px`;\n  }\n\n  if (originY + (e.clientY - originY) < rect.bottom) {\n    overlay.style.height = `${e.clientY - originY}px`;\n  }\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMouseup(e) {\n  let rects;\n\n  // TODO: Pamoja: temp fix (mrbrdo) - fix problem if creating highlight annotation and then clicking arrow icon (would duplicate annotation because of this function call)\n  if (!findSVGAtPoint(e.clientX, e.clientY)) {\n    return;\n  }\n    \n  if (_type !== 'area' && (rects = getSelectionRects())) {\n    let svg = findSVGAtPoint(rects[0].left, rects[0].top);\n    saveRect(_type, [...rects].map((r) => {\n      return {\n        top: r.top,\n        left: r.left,\n        width: r.width,\n        height: r.height\n      };\n    }));\n  } else if (_type === 'area' && overlay) {\n    let svg = overlay.parentNode.querySelector('svg.annotationLayer');\n    let rect = svg.getBoundingClientRect();\n    saveRect(_type, [{\n      top: parseInt(overlay.style.top, 10) + rect.top,\n      left: parseInt(overlay.style.left, 10) + rect.left,\n      width: parseInt(overlay.style.width, 10),\n      height: parseInt(overlay.style.height, 10)\n    }]);\n\n    overlay.parentNode.removeChild(overlay);\n    overlay = null;\n\n    document.removeEventListener('mousemove', handleDocumentMousemove);\n    enableUserSelect();\n  }\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentKeyup(e) {\n  // Cancel rect if Esc is pressed\n  if (e.keyCode === 27) {\n    let selection = window.getSelection();\n    selection.removeAllRanges();\n    if (overlay && overlay.parentNode) {\n      overlay.parentNode.removeChild(overlay);\n      overlay = null;\n      document.removeEventListener('mousemove', handleDocumentMousemove);\n    }\n  }\n}\n\n/**\n * Save a rect annotation\n *\n * @param {String} type The type of rect (area, highlight, strikeout)\n * @param {Array} rects The rects to use for annotation\n * @param {String} color The color of the rects\n */\nfunction saveRect(type, rects, color) {\n  let svg = findSVGAtPoint(rects[0].left, rects[0].top);\n  let node;\n  let annotation;\n\n  if (!svg) {\n    return;\n  }\n\n  let boundingRect = svg.getBoundingClientRect();\n\n  if (!color) {\n    if (type === 'highlight') {\n      color = 'FFFF00';\n    } else if (type === 'strikeout') {\n      color = 'FF0000';\n    }\n  }\n\n  // Initialize the annotation\n  annotation = {\n    type,\n    color,\n    rectangles: [...rects].map((r) => {\n      let offset = 0;\n\n      if (type === 'strikeout') {\n        offset = r.height / 2;\n      }\n\n      return scaleDown(svg, {\n        y: (r.top + offset) - boundingRect.top,\n        x: r.left - boundingRect.left,\n        width: r.width,\n        height: r.height\n      });\n    }).filter((r) => r.width > 0 && r.height > 0 && r.x > -1 && r.y > -1)\n  };\n  \n  // Short circuit if no rectangles exist\n  if (annotation.rectangles.length === 0) {\n    return;\n  }\n\n  // Special treatment for area as it only supports a single rect\n  if (type === 'area') {\n    let rect = annotation.rectangles[0];\n    delete annotation.rectangles;\n    annotation.x = rect.x;\n    annotation.y = rect.y;\n    annotation.width = rect.width;\n    annotation.height = rect.height;\n  }\n\n  let { documentId, pageNumber } = getMetadata(svg);\n\n  // Add the annotation\n  PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n    .then((annotation) => {\n      appendChild(svg, annotation);\n    });\n}\n\n/**\n * Enable rect behavior\n */\nexport function enableRect(type) {\n  _type = type;\n  \n  if (_enabled) { return; }\n\n  _enabled = true;\n  document.addEventListener('mouseup', handleDocumentMouseup);\n  document.addEventListener('mousedown', handleDocumentMousedown);\n  document.addEventListener('keyup', handleDocumentKeyup);\n}\n\n/**\n * Disable rect behavior\n */\nexport function disableRect() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n  document.removeEventListener('mousedown', handleDocumentMousedown);\n  document.removeEventListener('keyup', handleDocumentKeyup);\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/rect.js\n **/","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport appendChild from '../render/appendChild';\nimport {\n  BORDER_COLOR,\n  findSVGAtPoint,\n  getMetadata,\n  scaleDown\n} from './utils';\n\nlet _enabled = false;\nlet input;\nlet _textSize;\nlet _textColor;\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMouseup(e) {\n  if (input || !findSVGAtPoint(e.clientX, e.clientY)) {\n    return;\n  }\n\n  input = document.createElement('input');\n  input.setAttribute('id', 'pdf-annotate-text-input');\n  input.setAttribute('placeholder', 'Enter text');\n  input.style.border = `3px solid ${BORDER_COLOR}`;\n  input.style.borderRadius = '3px';\n  input.style.position = 'absolute';\n  input.style.top = `${e.clientY}px`;\n  input.style.left = `${e.clientX}px`;\n  input.style.fontSize = `${_textSize}px`;\n\n  input.addEventListener('blur', handleInputBlur);\n  input.addEventListener('keyup', handleInputKeyup);\n\n  document.body.appendChild(input);\n  input.focus();\n}\n\n/**\n * Handle input.blur event\n */\nfunction handleInputBlur() {\n  saveText();\n}\n\n/**\n * Handle input.keyup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleInputKeyup(e) {\n  if (e.keyCode === 27) {\n    closeInput();\n  } else if (e.keyCode === 13) {\n    saveText();\n  }\n}\n\n/**\n * Save a text annotation from input\n */\nfunction saveText() {\n  if (input.value.trim().length > 0) {\n    let clientX = parseInt(input.style.left, 10);\n    let clientY = parseInt(input.style.top, 10);\n    let svg = findSVGAtPoint(clientX, clientY);\n    if (!svg) {\n      return;\n    }\n\n    let { documentId, pageNumber } = getMetadata(svg);\n    let rect = svg.getBoundingClientRect();\n    let annotation = Object.assign({\n        type: 'textbox',\n        size: _textSize,\n        color: _textColor,\n        content: input.value.trim()\n      }, scaleDown(svg, {\n        x: clientX - rect.left,\n        y: clientY -  rect.top,\n        width: input.offsetWidth,\n        height: input.offsetHeight\n      })\n    );\n\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n      .then((annotation) => {\n        appendChild(svg, annotation);\n      });\n  }\n  \n  closeInput();\n}\n\n/**\n * Close the input\n */\nfunction closeInput() {\n  if (input) {\n    input.removeEventListener('blur', handleInputBlur);\n    input.removeEventListener('keyup', handleInputKeyup);\n    document.body.removeChild(input);\n    input = null;\n  }\n}\n\n/**\n * Set the text attributes\n *\n * @param {Number} textSize The size of the text\n * @param {String} textColor The color of the text\n */\nexport function setText(textSize = 12, textColor = '000000') {\n  _textSize = parseInt(textSize, 10);\n  _textColor = textColor;\n}\n\n\n/**\n * Enable text behavior\n */\nexport function enableText() {\n  if (_enabled) { return; }\n\n  _enabled = true;\n  document.addEventListener('mouseup', handleDocumentMouseup);\n}\n\n\n/**\n * Disable text behavior\n */\nexport function disableText() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/text.js\n **/","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport renderScreenReaderHints from '../a11y/renderScreenReaderHints';\n\n// Template for creating a new page\nconst PAGE_TEMPLATE = `\n  <div style=\"visibility: hidden;\" class=\"page\" data-loaded=\"false\">\n    <div class=\"canvasWrapper\">\n      <canvas></canvas>\n    </div>\n    <svg class=\"annotationLayer\"></svg>\n    <div class=\"textLayer\"></div>\n  </div>\n`;\n\n/**\n * Create a new page to be appended to the DOM.\n *\n * @param {Number} pageNumber The page number that is being created\n * @return {HTMLElement}\n */\nexport function createPage(pageNumber) {\n  let temp = document.createElement('div');\n  temp.innerHTML = PAGE_TEMPLATE;\n\n  let page = temp.children[0];\n  let canvas = page.querySelector('canvas');\n\n  page.setAttribute('id', `pageContainer${pageNumber}`);\n  page.setAttribute('data-page-number', pageNumber);\n\n  canvas.mozOpaque = true;\n  canvas.setAttribute('id', `page${pageNumber}`);\n\n  return page;\n}\n\n/**\n * Render a page that has already been created.\n *\n * @param {Number} pageNumber The page number to be rendered\n * @param {Object} renderOptions The options for rendering\n * @return {Promise} Settled once rendering has completed\n *  A settled Promise will be either:\n *    - fulfilled: [pdfPage, annotations]\n *    - rejected: Error\n */\nexport function renderPage(pageNumber, renderOptions) {\n  let {\n    documentId,\n    pdfDocument,\n    scale,\n    rotate\n  } = renderOptions;\n\n  // Load the page and annotations\n  return Promise.all([\n    pdfDocument.getPage(pageNumber),\n    PDFJSAnnotate.getAnnotations(documentId, pageNumber)\n  ]).then(([pdfPage, annotations]) => {\n    let page = document.getElementById(`pageContainer${pageNumber}`);\n    let svg = page.querySelector('.annotationLayer');\n    let canvas = page.querySelector('.canvasWrapper canvas');\n    let canvasContext = canvas.getContext('2d', {alpha: false});\n    let viewport = pdfPage.getViewport(scale, rotate);\n    let transform = scalePage(pageNumber, viewport, canvasContext);\n\n    // Render the page\n    return Promise.all([\n      pdfPage.render({ canvasContext, viewport, transform }),\n      PDFJSAnnotate.render(svg, viewport, annotations)\n    ]).then(() => {\n      // Text content is needed for a11y, but is also necessary for creating\n      // highlight and strikeout annotations which require selecting text.\n      return pdfPage.getTextContent({normalizeWhitespace: true}).then((textContent) => {\n        return new Promise((resolve, reject) => {\n          // Render text layer for a11y of text content\n          let textLayer = page.querySelector(`.textLayer`);\n          let textLayerFactory = new PDFJS.DefaultTextLayerFactory();\n          let textLayerBuilder = textLayerFactory.createTextLayerBuilder(textLayer, pageNumber -1, viewport);\n          textLayerBuilder.setTextContent(textContent);\n          textLayerBuilder.render();\n\n          // Enable a11y for annotations\n          // Timeout is needed to wait for `textLayerBuilder.render`\n          setTimeout(() => {\n            try {\n              renderScreenReaderHints(annotations.annotations);\n              resolve();\n            } catch (e) {\n              reject(e);\n            }\n          });\n        });\n      });\n    }).then(() => {\n      // Indicate that the page was loaded\n      page.setAttribute('data-loaded', 'true');\n\n      return [pdfPage, annotations];\n    });\n  });\n}\n\n/**\n * Scale the elements of a page.\n *\n * @param {Number} pageNumber The page number to be scaled\n * @param {Object} viewport The viewport of the PDF page (see pdfPage.getViewport(scale, rotate))\n * @param {Object} context The canvas context that the PDF page is rendered to\n * @return {Array} The transform data for rendering the PDF page\n */\nfunction scalePage(pageNumber, viewport, context) {\n  let page = document.getElementById(`pageContainer${pageNumber}`);\n  let canvas = page.querySelector('.canvasWrapper canvas');\n  let svg = page.querySelector('.annotationLayer');\n  let wrapper = page.querySelector('.canvasWrapper');\n  let textLayer = page.querySelector('.textLayer');\n  let outputScale = getOutputScale(context);\n  let transform = !outputScale.scaled ? null : [outputScale.sx, 0, 0, outputScale.sy, 0, 0];\n  let sfx = approximateFraction(outputScale.sx);\n  let sfy = approximateFraction(outputScale.sy);\n\n  // Adjust width/height for scale\n  page.style.visibility = '';\n  canvas.width = roundToDivide(viewport.width * outputScale.sx, sfx[0]);\n  canvas.height = roundToDivide(viewport.height * outputScale.sy, sfy[0]);\n  canvas.style.width = roundToDivide(viewport.width, sfx[1]) + 'px';\n  canvas.style.height = roundToDivide(viewport.height, sfx[1]) + 'px';\n  svg.setAttribute('width', viewport.width);\n  svg.setAttribute('height', viewport.height);\n  svg.style.width = `${viewport.width}px`;\n  svg.style.height = `${viewport.height}px`;\n  page.style.width = `${viewport.width}px`;\n  page.style.height = `${viewport.height}px`;\n  wrapper.style.width = `${viewport.width}px`;\n  wrapper.style.height = `${viewport.height}px`;\n  textLayer.style.width = `${viewport.width}px`;\n  textLayer.style.height = `${viewport.height}px`;\n\n  return transform;\n}\n\n/**\n * The following methods are taken from mozilla/pdf.js and as such fall under\n * the Apache License (http://www.apache.org/licenses/).\n *\n * Original source can be found at mozilla/pdf.js:\n * https://github.com/mozilla/pdf.js/blob/master/web/ui_utils.js\n */\n\n/**\n * Approximates a float number as a fraction using Farey sequence (max order\n * of 8).\n *\n * @param {Number} x Positive float number\n * @return {Array} Estimated fraction: the first array item is a numerator,\n *                 the second one is a denominator.\n */\nfunction approximateFraction(x) {\n  // Fast path for int numbers or their inversions.\n  if (Math.floor(x) === x) {\n    return [x, 1];\n  }\n\n  const xinv = 1 / x;\n  const limit = 8;\n  if (xinv > limit) {\n    return [1, limit];\n  } else if (Math.floor(xinv) === xinv) {\n    return [1, xinv];\n  }\n\n  const x_ = x > 1 ? xinv : x;\n  \n  // a/b and c/d are neighbours in Farey sequence.\n  let a = 0, b = 1, c = 1, d = 1;\n  \n  // Limit search to order 8.\n  while (true) {\n    // Generating next term in sequence (order of q).\n    let p = a + c, q = b + d;\n    if (q > limit) {\n      break;\n    }\n    if (x_ <= p / q) {\n      c = p; d = q;\n    } else {\n      a = p; b = q;\n    }\n  }\n\n  // Select closest of neighbours to x.\n  if (x_ - a / b < c / d - x_) {\n    return x_ === x ? [a, b] : [b, a];\n  } else {\n    return x_ === x ? [c, d] : [d, c];\n  }\n}\n\nfunction getOutputScale(ctx) {\n  let devicePixelRatio = window.devicePixelRatio || 1;\n  let backingStoreRatio = ctx.webkitBackingStorePixelRatio ||\n                          ctx.mozBackingStorePixelRatio ||\n                          ctx.msBackingStorePixelRatio ||\n                          ctx.oBackingStorePixelRatio ||\n                          ctx.backingStorePixelRatio || 1;\n  let pixelRatio = devicePixelRatio / backingStoreRatio;\n  return {\n    sx: pixelRatio,\n    sy: pixelRatio,\n    scaled: pixelRatio !== 1\n  };\n}\n\nfunction roundToDivide(x, div) {\n  let r = x % div;\n  return r === 0 ? x : Math.round(x - r + div);\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/UI/page.js\n **/","// Color picker component\nconst COLORS = [\n  {hex: '#000000', name: 'Black'},\n  {hex: '#EF4437', name: 'Red'},\n  {hex: '#E71F63', name: 'Pink'},\n  {hex: '#8F3E97', name: 'Purple'},\n  {hex: '#65499D', name: 'Deep Purple'},\n  {hex: '#4554A4', name: 'Indigo'},\n  {hex: '#2083C5', name: 'Blue'},\n  {hex: '#35A4DC', name: 'Light Blue'},\n  {hex: '#09BCD3', name: 'Cyan'},\n  {hex: '#009688', name: 'Teal'},\n  {hex: '#43A047', name: 'Green'},\n  {hex: '#8BC34A', name: 'Light Green'},\n  {hex: '#FDC010', name: 'Yellow'},\n  {hex: '#F8971C', name: 'Orange'},\n  {hex: '#F0592B', name: 'Deep Orange'},\n  {hex: '#F06291', name: 'Light Pink'}\n];\n\nexport default function initColorPicker(el, value, onChange) {\n  function setColor(value, fireOnChange = true) {\n    currentValue = value;\n    a.setAttribute('data-color', value);\n    a.style.background = value;\n    if (fireOnChange && typeof onChange === 'function') {\n      onChange(value);\n    }\n    closePicker();\n  }\n\n  function togglePicker() {\n    if (isPickerOpen) {\n      closePicker();\n    } else {\n      openPicker();\n    }\n  }\n\n  function closePicker() {\n    document.removeEventListener('keyup', handleDocumentKeyup);\n    if (picker && picker.parentNode) {\n      picker.parentNode.removeChild(picker);\n    }\n    isPickerOpen = false;\n    a.focus();\n  }\n\n  function openPicker() {\n    if (!picker) {\n      picker = document.createElement('div');\n      picker.style.background = '#fff';\n      picker.style.border = '1px solid #ccc';\n      picker.style.padding = '2px';\n      picker.style.position = 'absolute';\n      picker.style.width = '122px';\n      el.style.position = 'relative';\n\n      COLORS.map(createColorOption).forEach((c) => {\n        c.style.margin = '2px';\n        c.onclick = function () { setColor(c.getAttribute('data-color')); };\n        picker.appendChild(c);\n      });\n    }\n\n    document.addEventListener('keyup', handleDocumentKeyup);\n    el.appendChild(picker);\n    isPickerOpen = true;\n  }\n\n  function createColorOption(color) {\n    let e = document.createElement('a');\n    e.className = 'color';\n    e.setAttribute('href', 'javascript://');\n    e.setAttribute('title', color.name);\n    e.setAttribute('data-color', color.hex);\n    e.style.background = color.hex;\n    return e;\n  }\n\n  function handleDocumentKeyup(e) {\n    if (e.keyCode === 27) {\n      closePicker();\n    }\n  }\n\n  let picker;\n  let isPickerOpen = false;\n  let currentValue;\n  let a = createColorOption({hex: value});\n  a.onclick = togglePicker;\n  el.appendChild(a);\n  setColor(value, false);\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./shared/initColorPicker.js\n **/","/* Copyright 2014 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/*jshint globalstrict: false */\n/* globals PDFJS, PDFViewer, PDFPageView, TextLayerBuilder, PDFLinkService,\n           DefaultTextLayerFactory, AnnotationLayerBuilder, PDFHistory,\n           DefaultAnnotationLayerFactory, getFileName, ProgressBar */\n\n// Initializing PDFJS global object (if still undefined)\nif (typeof PDFJS === 'undefined') {\n  (typeof window !== 'undefined' ? window : this).PDFJS = {};\n}\n\n(function pdfViewerWrapper() {\n  'use strict';\n\n\nvar CSS_UNITS = 96.0 / 72.0;\nvar DEFAULT_SCALE_VALUE = 'auto';\nvar DEFAULT_SCALE = 1.0;\nvar UNKNOWN_SCALE = 0;\nvar MAX_AUTO_SCALE = 1.25;\nvar SCROLLBAR_PADDING = 40;\nvar VERTICAL_PADDING = 5;\n\nfunction getFileName(url) {\n  var anchor = url.indexOf('#');\n  var query = url.indexOf('?');\n  var end = Math.min(\n    anchor > 0 ? anchor : url.length,\n    query > 0 ? query : url.length);\n  return url.substring(url.lastIndexOf('/', end) + 1, end);\n}\n\n/**\n * Returns scale factor for the canvas. It makes sense for the HiDPI displays.\n * @return {Object} The object with horizontal (sx) and vertical (sy)\n                    scales. The scaled property is set to false if scaling is\n                    not required, true otherwise.\n */\nfunction getOutputScale(ctx) {\n  var devicePixelRatio = window.devicePixelRatio || 1;\n  var backingStoreRatio = ctx.webkitBackingStorePixelRatio ||\n                          ctx.mozBackingStorePixelRatio ||\n                          ctx.msBackingStorePixelRatio ||\n                          ctx.oBackingStorePixelRatio ||\n                          ctx.backingStorePixelRatio || 1;\n  var pixelRatio = devicePixelRatio / backingStoreRatio;\n  return {\n    sx: pixelRatio,\n    sy: pixelRatio,\n    scaled: pixelRatio !== 1\n  };\n}\n\n/**\n * Scrolls specified element into view of its parent.\n * @param {Object} element - The element to be visible.\n * @param {Object} spot - An object with optional top and left properties,\n *   specifying the offset from the top left edge.\n * @param {boolean} skipOverflowHiddenElements - Ignore elements that have\n *   the CSS rule `overflow: hidden;` set. The default is false.\n */\nfunction scrollIntoView(element, spot, skipOverflowHiddenElements) {\n  // Assuming offsetParent is available (it's not available when viewer is in\n  // hidden iframe or object). We have to scroll: if the offsetParent is not set\n  // producing the error. See also animationStartedClosure.\n  var parent = element.offsetParent;\n  if (!parent) {\n    console.error('offsetParent is not set -- cannot scroll');\n    return;\n  }\n  var checkOverflow = skipOverflowHiddenElements || false;\n  var offsetY = element.offsetTop + element.clientTop;\n  var offsetX = element.offsetLeft + element.clientLeft;\n  while (parent.clientHeight === parent.scrollHeight ||\n         (checkOverflow && getComputedStyle(parent).overflow === 'hidden')) {\n    if (parent.dataset._scaleY) {\n      offsetY /= parent.dataset._scaleY;\n      offsetX /= parent.dataset._scaleX;\n    }\n    offsetY += parent.offsetTop;\n    offsetX += parent.offsetLeft;\n    parent = parent.offsetParent;\n    if (!parent) {\n      return; // no need to scroll\n    }\n  }\n  if (spot) {\n    if (spot.top !== undefined) {\n      offsetY += spot.top;\n    }\n    if (spot.left !== undefined) {\n      offsetX += spot.left;\n      parent.scrollLeft = offsetX;\n    }\n  }\n  parent.scrollTop = offsetY;\n}\n\n/**\n * Helper function to start monitoring the scroll event and converting them into\n * PDF.js friendly one: with scroll debounce and scroll direction.\n */\nfunction watchScroll(viewAreaElement, callback) {\n  var debounceScroll = function debounceScroll(evt) {\n    if (rAF) {\n      return;\n    }\n    // schedule an invocation of scroll for next animation frame.\n    rAF = window.requestAnimationFrame(function viewAreaElementScrolled() {\n      rAF = null;\n\n      var currentY = viewAreaElement.scrollTop;\n      var lastY = state.lastY;\n      if (currentY !== lastY) {\n        state.down = currentY > lastY;\n      }\n      state.lastY = currentY;\n      callback(state);\n    });\n  };\n\n  var state = {\n    down: true,\n    lastY: viewAreaElement.scrollTop,\n    _eventHandler: debounceScroll\n  };\n\n  var rAF = null;\n  viewAreaElement.addEventListener('scroll', debounceScroll, true);\n  return state;\n}\n\n/**\n * Helper function to parse query string (e.g. ?param1=value&parm2=...).\n */\nfunction parseQueryString(query) {\n  var parts = query.split('&');\n  var params = {};\n  for (var i = 0, ii = parts.length; i < ii; ++i) {\n    var param = parts[i].split('=');\n    var key = param[0].toLowerCase();\n    var value = param.length > 1 ? param[1] : null;\n    params[decodeURIComponent(key)] = decodeURIComponent(value);\n  }\n  return params;\n}\n\n/**\n * Use binary search to find the index of the first item in a given array which\n * passes a given condition. The items are expected to be sorted in the sense\n * that if the condition is true for one item in the array, then it is also true\n * for all following items.\n *\n * @returns {Number} Index of the first array element to pass the test,\n *                   or |items.length| if no such element exists.\n */\nfunction binarySearchFirstItem(items, condition) {\n  var minIndex = 0;\n  var maxIndex = items.length - 1;\n\n  if (items.length === 0 || !condition(items[maxIndex])) {\n    return items.length;\n  }\n  if (condition(items[minIndex])) {\n    return minIndex;\n  }\n\n  while (minIndex < maxIndex) {\n    var currentIndex = (minIndex + maxIndex) >> 1;\n    var currentItem = items[currentIndex];\n    if (condition(currentItem)) {\n      maxIndex = currentIndex;\n    } else {\n      minIndex = currentIndex + 1;\n    }\n  }\n  return minIndex; /* === maxIndex */\n}\n\n/**\n *  Approximates float number as a fraction using Farey sequence (max order\n *  of 8).\n *  @param {number} x - Positive float number.\n *  @returns {Array} Estimated fraction: the first array item is a numerator,\n *                   the second one is a denominator.\n */\nfunction approximateFraction(x) {\n  // Fast paths for int numbers or their inversions.\n  if (Math.floor(x) === x) {\n    return [x, 1];\n  }\n  var xinv = 1 / x;\n  var limit = 8;\n  if (xinv > limit) {\n    return [1, limit];\n  } else  if (Math.floor(xinv) === xinv) {\n    return [1, xinv];\n  }\n\n  var x_ = x > 1 ? xinv : x;\n  // a/b and c/d are neighbours in Farey sequence.\n  var a = 0, b = 1, c = 1, d = 1;\n  // Limiting search to order 8.\n  while (true) {\n    // Generating next term in sequence (order of q).\n    var p = a + c, q = b + d;\n    if (q > limit) {\n      break;\n    }\n    if (x_ <= p / q) {\n      c = p; d = q;\n    } else {\n      a = p; b = q;\n    }\n  }\n  // Select closest of the neighbours to x.\n  if (x_ - a / b < c / d - x_) {\n    return x_ === x ? [a, b] : [b, a];\n  } else {\n    return x_ === x ? [c, d] : [d, c];\n  }\n}\n\nfunction roundToDivide(x, div) {\n  var r = x % div;\n  return r === 0 ? x : Math.round(x - r + div);\n}\n\n/**\n * Generic helper to find out what elements are visible within a scroll pane.\n */\nfunction getVisibleElements(scrollEl, views, sortByVisibility) {\n  var top = scrollEl.scrollTop, bottom = top + scrollEl.clientHeight;\n  var left = scrollEl.scrollLeft, right = left + scrollEl.clientWidth;\n\n  function isElementBottomBelowViewTop(view) {\n    var element = view.div;\n    var elementBottom =\n      element.offsetTop + element.clientTop + element.clientHeight;\n    return elementBottom > top;\n  }\n\n  var visible = [], view, element;\n  var currentHeight, viewHeight, hiddenHeight, percentHeight;\n  var currentWidth, viewWidth;\n  var firstVisibleElementInd = (views.length === 0) ? 0 :\n    binarySearchFirstItem(views, isElementBottomBelowViewTop);\n\n  for (var i = firstVisibleElementInd, ii = views.length; i < ii; i++) {\n    view = views[i];\n    element = view.div;\n    currentHeight = element.offsetTop + element.clientTop;\n    viewHeight = element.clientHeight;\n\n    if (currentHeight > bottom) {\n      break;\n    }\n\n    currentWidth = element.offsetLeft + element.clientLeft;\n    viewWidth = element.clientWidth;\n    if (currentWidth + viewWidth < left || currentWidth > right) {\n      continue;\n    }\n    hiddenHeight = Math.max(0, top - currentHeight) +\n      Math.max(0, currentHeight + viewHeight - bottom);\n    percentHeight = ((viewHeight - hiddenHeight) * 100 / viewHeight) | 0;\n\n    visible.push({\n      id: view.id,\n      x: currentWidth,\n      y: currentHeight,\n      view: view,\n      percent: percentHeight\n    });\n  }\n\n  var first = visible[0];\n  var last = visible[visible.length - 1];\n\n  if (sortByVisibility) {\n    visible.sort(function(a, b) {\n      var pc = a.percent - b.percent;\n      if (Math.abs(pc) > 0.001) {\n        return -pc;\n      }\n      return a.id - b.id; // ensure stability\n    });\n  }\n  return {first: first, last: last, views: visible};\n}\n\n/**\n * Event handler to suppress context menu.\n */\nfunction noContextMenuHandler(e) {\n  e.preventDefault();\n}\n\n/**\n * Returns the filename or guessed filename from the url (see issue 3455).\n * url {String} The original PDF location.\n * @return {String} Guessed PDF file name.\n */\nfunction getPDFFileNameFromURL(url) {\n  var reURI = /^(?:([^:]+:)?\\/\\/[^\\/]+)?([^?#]*)(\\?[^#]*)?(#.*)?$/;\n  //            SCHEME      HOST         1.PATH  2.QUERY   3.REF\n  // Pattern to get last matching NAME.pdf\n  var reFilename = /[^\\/?#=]+\\.pdf\\b(?!.*\\.pdf\\b)/i;\n  var splitURI = reURI.exec(url);\n  var suggestedFilename = reFilename.exec(splitURI[1]) ||\n                           reFilename.exec(splitURI[2]) ||\n                           reFilename.exec(splitURI[3]);\n  if (suggestedFilename) {\n    suggestedFilename = suggestedFilename[0];\n    if (suggestedFilename.indexOf('%') !== -1) {\n      // URL-encoded %2Fpath%2Fto%2Ffile.pdf should be file.pdf\n      try {\n        suggestedFilename =\n          reFilename.exec(decodeURIComponent(suggestedFilename))[0];\n      } catch(e) { // Possible (extremely rare) errors:\n        // URIError \"Malformed URI\", e.g. for \"%AA.pdf\"\n        // TypeError \"null has no properties\", e.g. for \"%2F.pdf\"\n      }\n    }\n  }\n  return suggestedFilename || 'document.pdf';\n}\n\nvar ProgressBar = (function ProgressBarClosure() {\n\n  function clamp(v, min, max) {\n    return Math.min(Math.max(v, min), max);\n  }\n\n  function ProgressBar(id, opts) {\n    this.visible = true;\n\n    // Fetch the sub-elements for later.\n    this.div = document.querySelector(id + ' .progress');\n\n    // Get the loading bar element, so it can be resized to fit the viewer.\n    this.bar = this.div.parentNode;\n\n    // Get options, with sensible defaults.\n    this.height = opts.height || 100;\n    this.width = opts.width || 100;\n    this.units = opts.units || '%';\n\n    // Initialize heights.\n    this.div.style.height = this.height + this.units;\n    this.percent = 0;\n  }\n\n  ProgressBar.prototype = {\n\n    updateBar: function ProgressBar_updateBar() {\n      if (this._indeterminate) {\n        this.div.classList.add('indeterminate');\n        this.div.style.width = this.width + this.units;\n        return;\n      }\n\n      this.div.classList.remove('indeterminate');\n      var progressSize = this.width * this._percent / 100;\n      this.div.style.width = progressSize + this.units;\n    },\n\n    get percent() {\n      return this._percent;\n    },\n\n    set percent(val) {\n      this._indeterminate = isNaN(val);\n      this._percent = clamp(val, 0, 100);\n      this.updateBar();\n    },\n\n    setWidth: function ProgressBar_setWidth(viewer) {\n      if (viewer) {\n        var container = viewer.parentNode;\n        var scrollbarWidth = container.offsetWidth - viewer.offsetWidth;\n        if (scrollbarWidth > 0) {\n          this.bar.setAttribute('style', 'width: calc(100% - ' +\n                                         scrollbarWidth + 'px);');\n        }\n      }\n    },\n\n    hide: function ProgressBar_hide() {\n      if (!this.visible) {\n        return;\n      }\n      this.visible = false;\n      this.bar.classList.add('hidden');\n      document.body.classList.remove('loadingInProgress');\n    },\n\n    show: function ProgressBar_show() {\n      if (this.visible) {\n        return;\n      }\n      this.visible = true;\n      document.body.classList.add('loadingInProgress');\n      this.bar.classList.remove('hidden');\n    }\n  };\n\n  return ProgressBar;\n})();\n\n\n/**\n * Performs navigation functions inside PDF, such as opening specified page,\n * or destination.\n * @class\n * @implements {IPDFLinkService}\n */\nvar PDFLinkService = (function () {\n  /**\n   * @constructs PDFLinkService\n   */\n  function PDFLinkService() {\n    this.baseUrl = null;\n    this.pdfDocument = null;\n    this.pdfViewer = null;\n    this.pdfHistory = null;\n\n    this._pagesRefCache = null;\n  }\n\n  PDFLinkService.prototype = {\n    setDocument: function PDFLinkService_setDocument(pdfDocument, baseUrl) {\n      this.baseUrl = baseUrl;\n      this.pdfDocument = pdfDocument;\n      this._pagesRefCache = Object.create(null);\n    },\n\n    setViewer: function PDFLinkService_setViewer(pdfViewer) {\n      this.pdfViewer = pdfViewer;\n    },\n\n    setHistory: function PDFLinkService_setHistory(pdfHistory) {\n      this.pdfHistory = pdfHistory;\n    },\n\n    /**\n     * @returns {number}\n     */\n    get pagesCount() {\n      return this.pdfDocument.numPages;\n    },\n\n    /**\n     * @returns {number}\n     */\n    get page() {\n      return this.pdfViewer.currentPageNumber;\n    },\n\n    /**\n     * @param {number} value\n     */\n    set page(value) {\n      this.pdfViewer.currentPageNumber = value;\n    },\n\n    /**\n     * @param dest - The PDF destination object.\n     */\n    navigateTo: function PDFLinkService_navigateTo(dest) {\n      var destString = '';\n      var self = this;\n\n      var goToDestination = function(destRef) {\n        // dest array looks like that: <page-ref> </XYZ|FitXXX> <args..>\n        var pageNumber = destRef instanceof Object ?\n          self._pagesRefCache[destRef.num + ' ' + destRef.gen + ' R'] :\n          (destRef + 1);\n        if (pageNumber) {\n          if (pageNumber > self.pagesCount) {\n            pageNumber = self.pagesCount;\n          }\n          self.pdfViewer.scrollPageIntoView(pageNumber, dest);\n\n          if (self.pdfHistory) {\n            // Update the browsing history.\n            self.pdfHistory.push({\n              dest: dest,\n              hash: destString,\n              page: pageNumber\n            });\n          }\n        } else {\n          self.pdfDocument.getPageIndex(destRef).then(function (pageIndex) {\n            var pageNum = pageIndex + 1;\n            var cacheKey = destRef.num + ' ' + destRef.gen + ' R';\n            self._pagesRefCache[cacheKey] = pageNum;\n            goToDestination(destRef);\n          });\n        }\n      };\n\n      var destinationPromise;\n      if (typeof dest === 'string') {\n        destString = dest;\n        destinationPromise = this.pdfDocument.getDestination(dest);\n      } else {\n        destinationPromise = Promise.resolve(dest);\n      }\n      destinationPromise.then(function(destination) {\n        dest = destination;\n        if (!(destination instanceof Array)) {\n          return; // invalid destination\n        }\n        goToDestination(destination[0]);\n      });\n    },\n\n    /**\n     * @param dest - The PDF destination object.\n     * @returns {string} The hyperlink to the PDF object.\n     */\n    getDestinationHash: function PDFLinkService_getDestinationHash(dest) {\n      if (typeof dest === 'string') {\n        return this.getAnchorUrl('#' + escape(dest));\n      }\n      if (dest instanceof Array) {\n        var destRef = dest[0]; // see navigateTo method for dest format\n        var pageNumber = destRef instanceof Object ?\n          this._pagesRefCache[destRef.num + ' ' + destRef.gen + ' R'] :\n          (destRef + 1);\n        if (pageNumber) {\n          var pdfOpenParams = this.getAnchorUrl('#page=' + pageNumber);\n          var destKind = dest[1];\n          if (typeof destKind === 'object' && 'name' in destKind &&\n              destKind.name === 'XYZ') {\n            var scale = (dest[4] || this.pdfViewer.currentScaleValue);\n            var scaleNumber = parseFloat(scale);\n            if (scaleNumber) {\n              scale = scaleNumber * 100;\n            }\n            pdfOpenParams += '&zoom=' + scale;\n            if (dest[2] || dest[3]) {\n              pdfOpenParams += ',' + (dest[2] || 0) + ',' + (dest[3] || 0);\n            }\n          }\n          return pdfOpenParams;\n        }\n      }\n      return this.getAnchorUrl('');\n    },\n\n    /**\n     * Prefix the full url on anchor links to make sure that links are resolved\n     * relative to the current URL instead of the one defined in <base href>.\n     * @param {String} anchor The anchor hash, including the #.\n     * @returns {string} The hyperlink to the PDF object.\n     */\n    getAnchorUrl: function PDFLinkService_getAnchorUrl(anchor) {\n      return (this.baseUrl || '') + anchor;\n    },\n\n    /**\n     * @param {string} hash\n     */\n    setHash: function PDFLinkService_setHash(hash) {\n      if (hash.indexOf('=') >= 0) {\n        var params = parseQueryString(hash);\n        // borrowing syntax from \"Parameters for Opening PDF Files\"\n        if ('nameddest' in params) {\n          if (this.pdfHistory) {\n            this.pdfHistory.updateNextHashParam(params.nameddest);\n          }\n          this.navigateTo(params.nameddest);\n          return;\n        }\n        var pageNumber, dest;\n        if ('page' in params) {\n          pageNumber = (params.page | 0) || 1;\n        }\n        if ('zoom' in params) {\n          // Build the destination array.\n          var zoomArgs = params.zoom.split(','); // scale,left,top\n          var zoomArg = zoomArgs[0];\n          var zoomArgNumber = parseFloat(zoomArg);\n\n          if (zoomArg.indexOf('Fit') === -1) {\n            // If the zoomArg is a number, it has to get divided by 100. If it's\n            // a string, it should stay as it is.\n            dest = [null, { name: 'XYZ' },\n                    zoomArgs.length > 1 ? (zoomArgs[1] | 0) : null,\n                    zoomArgs.length > 2 ? (zoomArgs[2] | 0) : null,\n                    (zoomArgNumber ? zoomArgNumber / 100 : zoomArg)];\n          } else {\n            if (zoomArg === 'Fit' || zoomArg === 'FitB') {\n              dest = [null, { name: zoomArg }];\n            } else if ((zoomArg === 'FitH' || zoomArg === 'FitBH') ||\n                       (zoomArg === 'FitV' || zoomArg === 'FitBV')) {\n              dest = [null, { name: zoomArg },\n                      zoomArgs.length > 1 ? (zoomArgs[1] | 0) : null];\n            } else if (zoomArg === 'FitR') {\n              if (zoomArgs.length !== 5) {\n                console.error('PDFLinkService_setHash: ' +\n                              'Not enough parameters for \\'FitR\\'.');\n              } else {\n                dest = [null, { name: zoomArg },\n                        (zoomArgs[1] | 0), (zoomArgs[2] | 0),\n                        (zoomArgs[3] | 0), (zoomArgs[4] | 0)];\n              }\n            } else {\n              console.error('PDFLinkService_setHash: \\'' + zoomArg +\n                            '\\' is not a valid zoom value.');\n            }\n          }\n        }\n        if (dest) {\n          this.pdfViewer.scrollPageIntoView(pageNumber || this.page, dest);\n        } else if (pageNumber) {\n          this.page = pageNumber; // simple page\n        }\n        if ('pagemode' in params) {\n          var event = document.createEvent('CustomEvent');\n          event.initCustomEvent('pagemode', true, true, {\n            mode: params.pagemode,\n          });\n          this.pdfViewer.container.dispatchEvent(event);\n        }\n      } else if (/^\\d+$/.test(hash)) { // page number\n        this.page = hash;\n      } else { // named destination\n        if (this.pdfHistory) {\n          this.pdfHistory.updateNextHashParam(unescape(hash));\n        }\n        this.navigateTo(unescape(hash));\n      }\n    },\n\n    /**\n     * @param {string} action\n     */\n    executeNamedAction: function PDFLinkService_executeNamedAction(action) {\n      // See PDF reference, table 8.45 - Named action\n      switch (action) {\n        case 'GoBack':\n          if (this.pdfHistory) {\n            this.pdfHistory.back();\n          }\n          break;\n\n        case 'GoForward':\n          if (this.pdfHistory) {\n            this.pdfHistory.forward();\n          }\n          break;\n\n        case 'NextPage':\n          this.page++;\n          break;\n\n        case 'PrevPage':\n          this.page--;\n          break;\n\n        case 'LastPage':\n          this.page = this.pagesCount;\n          break;\n\n        case 'FirstPage':\n          this.page = 1;\n          break;\n\n        default:\n          break; // No action according to spec\n      }\n\n      var event = document.createEvent('CustomEvent');\n      event.initCustomEvent('namedaction', true, true, {\n        action: action\n      });\n      this.pdfViewer.container.dispatchEvent(event);\n    },\n\n    /**\n     * @param {number} pageNum - page number.\n     * @param {Object} pageRef - reference to the page.\n     */\n    cachePageRef: function PDFLinkService_cachePageRef(pageNum, pageRef) {\n      var refStr = pageRef.num + ' ' + pageRef.gen + ' R';\n      this._pagesRefCache[refStr] = pageNum;\n    }\n  };\n\n  return PDFLinkService;\n})();\n\n\nvar PresentationModeState = {\n  UNKNOWN: 0,\n  NORMAL: 1,\n  CHANGING: 2,\n  FULLSCREEN: 3,\n};\n\nvar IGNORE_CURRENT_POSITION_ON_ZOOM = false;\nvar DEFAULT_CACHE_SIZE = 10;\n\n\nvar CLEANUP_TIMEOUT = 30000;\n\nvar RenderingStates = {\n  INITIAL: 0,\n  RUNNING: 1,\n  PAUSED: 2,\n  FINISHED: 3\n};\n\n/**\n * Controls rendering of the views for pages and thumbnails.\n * @class\n */\nvar PDFRenderingQueue = (function PDFRenderingQueueClosure() {\n  /**\n   * @constructs\n   */\n  function PDFRenderingQueue() {\n    this.pdfViewer = null;\n    this.pdfThumbnailViewer = null;\n    this.onIdle = null;\n\n    this.highestPriorityPage = null;\n    this.idleTimeout = null;\n    this.printing = false;\n    this.isThumbnailViewEnabled = false;\n  }\n\n  PDFRenderingQueue.prototype = /** @lends PDFRenderingQueue.prototype */ {\n    /**\n     * @param {PDFViewer} pdfViewer\n     */\n    setViewer: function PDFRenderingQueue_setViewer(pdfViewer) {\n      this.pdfViewer = pdfViewer;\n    },\n\n    /**\n     * @param {PDFThumbnailViewer} pdfThumbnailViewer\n     */\n    setThumbnailViewer:\n        function PDFRenderingQueue_setThumbnailViewer(pdfThumbnailViewer) {\n      this.pdfThumbnailViewer = pdfThumbnailViewer;\n    },\n\n    /**\n     * @param {IRenderableView} view\n     * @returns {boolean}\n     */\n    isHighestPriority: function PDFRenderingQueue_isHighestPriority(view) {\n      return this.highestPriorityPage === view.renderingId;\n    },\n\n    renderHighestPriority: function\n        PDFRenderingQueue_renderHighestPriority(currentlyVisiblePages) {\n      if (this.idleTimeout) {\n        clearTimeout(this.idleTimeout);\n        this.idleTimeout = null;\n      }\n\n      // Pages have a higher priority than thumbnails, so check them first.\n      if (this.pdfViewer.forceRendering(currentlyVisiblePages)) {\n        return;\n      }\n      // No pages needed rendering so check thumbnails.\n      if (this.pdfThumbnailViewer && this.isThumbnailViewEnabled) {\n        if (this.pdfThumbnailViewer.forceRendering()) {\n          return;\n        }\n      }\n\n      if (this.printing) {\n        // If printing is currently ongoing do not reschedule cleanup.\n        return;\n      }\n\n      if (this.onIdle) {\n        this.idleTimeout = setTimeout(this.onIdle.bind(this), CLEANUP_TIMEOUT);\n      }\n    },\n\n    getHighestPriority: function\n        PDFRenderingQueue_getHighestPriority(visible, views, scrolledDown) {\n      // The state has changed figure out which page has the highest priority to\n      // render next (if any).\n      // Priority:\n      // 1 visible pages\n      // 2 if last scrolled down page after the visible pages\n      // 2 if last scrolled up page before the visible pages\n      var visibleViews = visible.views;\n\n      var numVisible = visibleViews.length;\n      if (numVisible === 0) {\n        return false;\n      }\n      for (var i = 0; i < numVisible; ++i) {\n        var view = visibleViews[i].view;\n        if (!this.isViewFinished(view)) {\n          return view;\n        }\n      }\n\n      // All the visible views have rendered, try to render next/previous pages.\n      if (scrolledDown) {\n        var nextPageIndex = visible.last.id;\n        // ID's start at 1 so no need to add 1.\n        if (views[nextPageIndex] &&\n            !this.isViewFinished(views[nextPageIndex])) {\n          return views[nextPageIndex];\n        }\n      } else {\n        var previousPageIndex = visible.first.id - 2;\n        if (views[previousPageIndex] &&\n          !this.isViewFinished(views[previousPageIndex])) {\n          return views[previousPageIndex];\n        }\n      }\n      // Everything that needs to be rendered has been.\n      return null;\n    },\n\n    /**\n     * @param {IRenderableView} view\n     * @returns {boolean}\n     */\n    isViewFinished: function PDFRenderingQueue_isViewFinished(view) {\n      return view.renderingState === RenderingStates.FINISHED;\n    },\n\n    /**\n     * Render a page or thumbnail view. This calls the appropriate function\n     * based on the views state. If the view is already rendered it will return\n     * false.\n     * @param {IRenderableView} view\n     */\n    renderView: function PDFRenderingQueue_renderView(view) {\n      var state = view.renderingState;\n      switch (state) {\n        case RenderingStates.FINISHED:\n          return false;\n        case RenderingStates.PAUSED:\n          this.highestPriorityPage = view.renderingId;\n          view.resume();\n          break;\n        case RenderingStates.RUNNING:\n          this.highestPriorityPage = view.renderingId;\n          break;\n        case RenderingStates.INITIAL:\n          this.highestPriorityPage = view.renderingId;\n          var continueRendering = function () {\n            this.renderHighestPriority();\n          }.bind(this);\n          view.draw().then(continueRendering, continueRendering);\n          break;\n      }\n      return true;\n    },\n  };\n\n  return PDFRenderingQueue;\n})();\n\n\nvar TEXT_LAYER_RENDER_DELAY = 200; // ms\n\n/**\n * @typedef {Object} PDFPageViewOptions\n * @property {HTMLDivElement} container - The viewer element.\n * @property {number} id - The page unique ID (normally its number).\n * @property {number} scale - The page scale display.\n * @property {PageViewport} defaultViewport - The page viewport.\n * @property {PDFRenderingQueue} renderingQueue - The rendering queue object.\n * @property {IPDFTextLayerFactory} textLayerFactory\n * @property {IPDFAnnotationLayerFactory} annotationLayerFactory\n */\n\n/**\n * @class\n * @implements {IRenderableView}\n */\nvar PDFPageView = (function PDFPageViewClosure() {\n  /**\n   * @constructs PDFPageView\n   * @param {PDFPageViewOptions} options\n   */\n  function PDFPageView(options) {\n    var container = options.container;\n    var id = options.id;\n    var scale = options.scale;\n    var defaultViewport = options.defaultViewport;\n    var renderingQueue = options.renderingQueue;\n    var textLayerFactory = options.textLayerFactory;\n    var annotationLayerFactory = options.annotationLayerFactory;\n\n    this.id = id;\n    this.renderingId = 'page' + id;\n\n    this.rotation = 0;\n    this.scale = scale || DEFAULT_SCALE;\n    this.viewport = defaultViewport;\n    this.pdfPageRotate = defaultViewport.rotation;\n    this.hasRestrictedScaling = false;\n\n    this.renderingQueue = renderingQueue;\n    this.textLayerFactory = textLayerFactory;\n    this.annotationLayerFactory = annotationLayerFactory;\n\n    this.renderingState = RenderingStates.INITIAL;\n    this.resume = null;\n\n    this.onBeforeDraw = null;\n    this.onAfterDraw = null;\n\n    this.textLayer = null;\n\n    this.zoomLayer = null;\n\n    this.annotationLayer = null;\n\n    var div = document.createElement('div');\n    div.id = 'pageContainer' + this.id;\n    div.className = 'page';\n    div.style.width = Math.floor(this.viewport.width) + 'px';\n    div.style.height = Math.floor(this.viewport.height) + 'px';\n    div.setAttribute('data-page-number', this.id);\n    this.div = div;\n\n    container.appendChild(div);\n  }\n\n  PDFPageView.prototype = {\n    setPdfPage: function PDFPageView_setPdfPage(pdfPage) {\n      this.pdfPage = pdfPage;\n      this.pdfPageRotate = pdfPage.rotate;\n      var totalRotation = (this.rotation + this.pdfPageRotate) % 360;\n      this.viewport = pdfPage.getViewport(this.scale * CSS_UNITS,\n                                          totalRotation);\n      this.stats = pdfPage.stats;\n      this.reset();\n    },\n\n    destroy: function PDFPageView_destroy() {\n      this.zoomLayer = null;\n      this.reset();\n      if (this.pdfPage) {\n        this.pdfPage.cleanup();\n      }\n    },\n\n    reset: function PDFPageView_reset(keepZoomLayer, keepAnnotations) {\n      if (this.renderTask) {\n        this.renderTask.cancel();\n      }\n      this.resume = null;\n      this.renderingState = RenderingStates.INITIAL;\n\n      var div = this.div;\n      div.style.width = Math.floor(this.viewport.width) + 'px';\n      div.style.height = Math.floor(this.viewport.height) + 'px';\n\n      var childNodes = div.childNodes;\n      var currentZoomLayerNode = (keepZoomLayer && this.zoomLayer) || null;\n      var currentAnnotationNode = (keepAnnotations && this.annotationLayer &&\n                                   this.annotationLayer.div) || null;\n      for (var i = childNodes.length - 1; i >= 0; i--) {\n        var node = childNodes[i];\n        if (currentZoomLayerNode === node || currentAnnotationNode === node) {\n          continue;\n        }\n        div.removeChild(node);\n      }\n      div.removeAttribute('data-loaded');\n\n      if (currentAnnotationNode) {\n        // Hide annotationLayer until all elements are resized\n        // so they are not displayed on the already-resized page\n        this.annotationLayer.hide();\n      } else {\n        this.annotationLayer = null;\n      }\n\n      if (this.canvas && !currentZoomLayerNode) {\n        // Zeroing the width and height causes Firefox to release graphics\n        // resources immediately, which can greatly reduce memory consumption.\n        this.canvas.width = 0;\n        this.canvas.height = 0;\n        delete this.canvas;\n      }\n\n      this.loadingIconDiv = document.createElement('div');\n      this.loadingIconDiv.className = 'loadingIcon';\n      div.appendChild(this.loadingIconDiv);\n    },\n\n    update: function PDFPageView_update(scale, rotation) {\n      this.scale = scale || this.scale;\n\n      if (typeof rotation !== 'undefined') {\n        this.rotation = rotation;\n      }\n\n      var totalRotation = (this.rotation + this.pdfPageRotate) % 360;\n      this.viewport = this.viewport.clone({\n        scale: this.scale * CSS_UNITS,\n        rotation: totalRotation\n      });\n\n      var isScalingRestricted = false;\n      if (this.canvas && PDFJS.maxCanvasPixels > 0) {\n        var outputScale = this.outputScale;\n        var pixelsInViewport = this.viewport.width * this.viewport.height;\n        var maxScale = Math.sqrt(PDFJS.maxCanvasPixels / pixelsInViewport);\n        if (((Math.floor(this.viewport.width) * outputScale.sx) | 0) *\n            ((Math.floor(this.viewport.height) * outputScale.sy) | 0) >\n            PDFJS.maxCanvasPixels) {\n          isScalingRestricted = true;\n        }\n      }\n\n      if (this.canvas) {\n        if (PDFJS.useOnlyCssZoom ||\n            (this.hasRestrictedScaling && isScalingRestricted)) {\n          this.cssTransform(this.canvas, true);\n\n          var event = document.createEvent('CustomEvent');\n          event.initCustomEvent('pagerendered', true, true, {\n            pageNumber: this.id,\n            cssTransform: true,\n          });\n          this.div.dispatchEvent(event);\n\n          return;\n        }\n        if (!this.zoomLayer) {\n          this.zoomLayer = this.canvas.parentNode;\n          this.zoomLayer.style.position = 'absolute';\n        }\n      }\n      if (this.zoomLayer) {\n        this.cssTransform(this.zoomLayer.firstChild);\n      }\n      this.reset(/* keepZoomLayer = */ true, /* keepAnnotations = */ true);\n    },\n\n    /**\n     * Called when moved in the parent's container.\n     */\n    updatePosition: function PDFPageView_updatePosition() {\n      if (this.textLayer) {\n        this.textLayer.render(TEXT_LAYER_RENDER_DELAY);\n      }\n    },\n\n    cssTransform: function PDFPageView_transform(canvas, redrawAnnotations) {\n      var CustomStyle = PDFJS.CustomStyle;\n\n      // Scale canvas, canvas wrapper, and page container.\n      var width = this.viewport.width;\n      var height = this.viewport.height;\n      var div = this.div;\n      canvas.style.width = canvas.parentNode.style.width = div.style.width =\n        Math.floor(width) + 'px';\n      canvas.style.height = canvas.parentNode.style.height = div.style.height =\n        Math.floor(height) + 'px';\n      // The canvas may have been originally rotated, rotate relative to that.\n      var relativeRotation = this.viewport.rotation - canvas._viewport.rotation;\n      var absRotation = Math.abs(relativeRotation);\n      var scaleX = 1, scaleY = 1;\n      if (absRotation === 90 || absRotation === 270) {\n        // Scale x and y because of the rotation.\n        scaleX = height / width;\n        scaleY = width / height;\n      }\n      var cssTransform = 'rotate(' + relativeRotation + 'deg) ' +\n        'scale(' + scaleX + ',' + scaleY + ')';\n      CustomStyle.setProp('transform', canvas, cssTransform);\n\n      if (this.textLayer) {\n        // Rotating the text layer is more complicated since the divs inside the\n        // the text layer are rotated.\n        // TODO: This could probably be simplified by drawing the text layer in\n        // one orientation then rotating overall.\n        var textLayerViewport = this.textLayer.viewport;\n        var textRelativeRotation = this.viewport.rotation -\n          textLayerViewport.rotation;\n        var textAbsRotation = Math.abs(textRelativeRotation);\n        var scale = width / textLayerViewport.width;\n        if (textAbsRotation === 90 || textAbsRotation === 270) {\n          scale = width / textLayerViewport.height;\n        }\n        var textLayerDiv = this.textLayer.textLayerDiv;\n        var transX, transY;\n        switch (textAbsRotation) {\n          case 0:\n            transX = transY = 0;\n            break;\n          case 90:\n            transX = 0;\n            transY = '-' + textLayerDiv.style.height;\n            break;\n          case 180:\n            transX = '-' + textLayerDiv.style.width;\n            transY = '-' + textLayerDiv.style.height;\n            break;\n          case 270:\n            transX = '-' + textLayerDiv.style.width;\n            transY = 0;\n            break;\n          default:\n            console.error('Bad rotation value.');\n            break;\n        }\n        CustomStyle.setProp('transform', textLayerDiv,\n            'rotate(' + textAbsRotation + 'deg) ' +\n            'scale(' + scale + ', ' + scale + ') ' +\n            'translate(' + transX + ', ' + transY + ')');\n        CustomStyle.setProp('transformOrigin', textLayerDiv, '0% 0%');\n      }\n\n      if (redrawAnnotations && this.annotationLayer) {\n        this.annotationLayer.render(this.viewport, 'display');\n      }\n    },\n\n    get width() {\n      return this.viewport.width;\n    },\n\n    get height() {\n      return this.viewport.height;\n    },\n\n    getPagePoint: function PDFPageView_getPagePoint(x, y) {\n      return this.viewport.convertToPdfPoint(x, y);\n    },\n\n    draw: function PDFPageView_draw() {\n      if (this.renderingState !== RenderingStates.INITIAL) {\n        console.error('Must be in new state before drawing');\n      }\n\n      this.renderingState = RenderingStates.RUNNING;\n\n      var pdfPage = this.pdfPage;\n      var viewport = this.viewport;\n      var div = this.div;\n      // Wrap the canvas so if it has a css transform for highdpi the overflow\n      // will be hidden in FF.\n      var canvasWrapper = document.createElement('div');\n      canvasWrapper.style.width = div.style.width;\n      canvasWrapper.style.height = div.style.height;\n      canvasWrapper.classList.add('canvasWrapper');\n\n      var canvas = document.createElement('canvas');\n      canvas.id = 'page' + this.id;\n      // Keep the canvas hidden until the first draw callback, or until drawing\n      // is complete when `!this.renderingQueue`, to prevent black flickering.\n      canvas.setAttribute('hidden', 'hidden');\n      var isCanvasHidden = true;\n\n      canvasWrapper.appendChild(canvas);\n      if (this.annotationLayer && this.annotationLayer.div) {\n        // annotationLayer needs to stay on top\n        div.insertBefore(canvasWrapper, this.annotationLayer.div);\n      } else {\n        div.appendChild(canvasWrapper);\n      }\n      this.canvas = canvas;\n\n      var ctx = canvas.getContext('2d', {alpha: false});\n      var outputScale = getOutputScale(ctx);\n      this.outputScale = outputScale;\n\n      if (PDFJS.useOnlyCssZoom) {\n        var actualSizeViewport = viewport.clone({scale: CSS_UNITS});\n        // Use a scale that will make the canvas be the original intended size\n        // of the page.\n        outputScale.sx *= actualSizeViewport.width / viewport.width;\n        outputScale.sy *= actualSizeViewport.height / viewport.height;\n        outputScale.scaled = true;\n      }\n\n      if (PDFJS.maxCanvasPixels > 0) {\n        var pixelsInViewport = viewport.width * viewport.height;\n        var maxScale = Math.sqrt(PDFJS.maxCanvasPixels / pixelsInViewport);\n        if (outputScale.sx > maxScale || outputScale.sy > maxScale) {\n          outputScale.sx = maxScale;\n          outputScale.sy = maxScale;\n          outputScale.scaled = true;\n          this.hasRestrictedScaling = true;\n        } else {\n          this.hasRestrictedScaling = false;\n        }\n      }\n\n      var sfx = approximateFraction(outputScale.sx);\n      var sfy = approximateFraction(outputScale.sy);\n      canvas.width = roundToDivide(viewport.width * outputScale.sx, sfx[0]);\n      canvas.height = roundToDivide(viewport.height * outputScale.sy, sfy[0]);\n      canvas.style.width = roundToDivide(viewport.width, sfx[1]) + 'px';\n      canvas.style.height = roundToDivide(viewport.height, sfy[1]) + 'px';\n      // Add the viewport so it's known what it was originally drawn with.\n      canvas._viewport = viewport;\n\n      var textLayerDiv = null;\n      var textLayer = null;\n      if (this.textLayerFactory) {\n        textLayerDiv = document.createElement('div');\n        textLayerDiv.className = 'textLayer';\n        textLayerDiv.style.width = canvasWrapper.style.width;\n        textLayerDiv.style.height = canvasWrapper.style.height;\n        if (this.annotationLayer && this.annotationLayer.div) {\n          // annotationLayer needs to stay on top\n          div.insertBefore(textLayerDiv, this.annotationLayer.div);\n        } else {\n          div.appendChild(textLayerDiv);\n        }\n\n        textLayer = this.textLayerFactory.createTextLayerBuilder(textLayerDiv,\n                                                                 this.id - 1,\n                                                                 this.viewport);\n      }\n      this.textLayer = textLayer;\n\n      var resolveRenderPromise, rejectRenderPromise;\n      var promise = new Promise(function (resolve, reject) {\n        resolveRenderPromise = resolve;\n        rejectRenderPromise = reject;\n      });\n\n      // Rendering area\n\n      var self = this;\n      function pageViewDrawCallback(error) {\n        // The renderTask may have been replaced by a new one, so only remove\n        // the reference to the renderTask if it matches the one that is\n        // triggering this callback.\n        if (renderTask === self.renderTask) {\n          self.renderTask = null;\n        }\n\n        if (error === 'cancelled') {\n          rejectRenderPromise(error);\n          return;\n        }\n\n        self.renderingState = RenderingStates.FINISHED;\n\n        if (isCanvasHidden) {\n          self.canvas.removeAttribute('hidden');\n          isCanvasHidden = false;\n        }\n\n        if (self.loadingIconDiv) {\n          div.removeChild(self.loadingIconDiv);\n          delete self.loadingIconDiv;\n        }\n\n        if (self.zoomLayer) {\n          // Zeroing the width and height causes Firefox to release graphics\n          // resources immediately, which can greatly reduce memory consumption.\n          var zoomLayerCanvas = self.zoomLayer.firstChild;\n          zoomLayerCanvas.width = 0;\n          zoomLayerCanvas.height = 0;\n\n          div.removeChild(self.zoomLayer);\n          self.zoomLayer = null;\n        }\n\n        self.error = error;\n        self.stats = pdfPage.stats;\n        if (self.onAfterDraw) {\n          self.onAfterDraw();\n        }\n        var event = document.createEvent('CustomEvent');\n        event.initCustomEvent('pagerendered', true, true, {\n          pageNumber: self.id,\n          cssTransform: false,\n        });\n        div.dispatchEvent(event);\n\n        if (!error) {\n          resolveRenderPromise(undefined);\n        } else {\n          rejectRenderPromise(error);\n        }\n      }\n\n      var renderContinueCallback = null;\n      if (this.renderingQueue) {\n        renderContinueCallback = function renderContinueCallback(cont) {\n          if (!self.renderingQueue.isHighestPriority(self)) {\n            self.renderingState = RenderingStates.PAUSED;\n            self.resume = function resumeCallback() {\n              self.renderingState = RenderingStates.RUNNING;\n              cont();\n            };\n            return;\n          }\n          if (isCanvasHidden) {\n            self.canvas.removeAttribute('hidden');\n            isCanvasHidden = false;\n          }\n          cont();\n        };\n      }\n\n      var transform = !outputScale.scaled ? null :\n        [outputScale.sx, 0, 0, outputScale.sy, 0, 0];\n      var renderContext = {\n        canvasContext: ctx,\n        transform: transform,\n        viewport: this.viewport,\n        // intent: 'default', // === 'display'\n      };\n      var renderTask = this.renderTask = this.pdfPage.render(renderContext);\n      renderTask.onContinue = renderContinueCallback;\n\n      this.renderTask.promise.then(\n        function pdfPageRenderCallback() {\n          pageViewDrawCallback(null);\n          if (textLayer) {\n            self.pdfPage.getTextContent({ normalizeWhitespace: true }).then(\n              function textContentResolved(textContent) {\n                textLayer.setTextContent(textContent);\n                textLayer.render(TEXT_LAYER_RENDER_DELAY);\n              }\n            );\n          }\n        },\n        function pdfPageRenderError(error) {\n          pageViewDrawCallback(error);\n        }\n      );\n\n      if (this.annotationLayerFactory) {\n        if (!this.annotationLayer) {\n          this.annotationLayer = this.annotationLayerFactory.\n            createAnnotationLayerBuilder(div, this.pdfPage);\n        }\n        this.annotationLayer.render(this.viewport, 'display');\n      }\n      div.setAttribute('data-loaded', true);\n\n      if (self.onBeforeDraw) {\n        self.onBeforeDraw();\n      }\n      return promise;\n    },\n\n    beforePrint: function PDFPageView_beforePrint() {\n      var CustomStyle = PDFJS.CustomStyle;\n      var pdfPage = this.pdfPage;\n\n      var viewport = pdfPage.getViewport(1);\n      // Use the same hack we use for high dpi displays for printing to get\n      // better output until bug 811002 is fixed in FF.\n      var PRINT_OUTPUT_SCALE = 2;\n      var canvas = document.createElement('canvas');\n\n      // The logical size of the canvas.\n      canvas.width = Math.floor(viewport.width) * PRINT_OUTPUT_SCALE;\n      canvas.height = Math.floor(viewport.height) * PRINT_OUTPUT_SCALE;\n\n      // The rendered size of the canvas, relative to the size of canvasWrapper.\n      canvas.style.width = (PRINT_OUTPUT_SCALE * 100) + '%';\n      canvas.style.height = (PRINT_OUTPUT_SCALE * 100) + '%';\n\n      var cssScale = 'scale(' + (1 / PRINT_OUTPUT_SCALE) + ', ' +\n                                (1 / PRINT_OUTPUT_SCALE) + ')';\n      CustomStyle.setProp('transform' , canvas, cssScale);\n      CustomStyle.setProp('transformOrigin' , canvas, '0% 0%');\n\n      var printContainer = document.getElementById('printContainer');\n      var canvasWrapper = document.createElement('div');\n      canvasWrapper.style.width = viewport.width + 'pt';\n      canvasWrapper.style.height = viewport.height + 'pt';\n      canvasWrapper.appendChild(canvas);\n      printContainer.appendChild(canvasWrapper);\n\n      canvas.mozPrintCallback = function(obj) {\n        var ctx = obj.context;\n\n        ctx.save();\n        ctx.fillStyle = 'rgb(255, 255, 255)';\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\n        ctx.restore();\n        // Used by the mozCurrentTransform polyfill in src/display/canvas.js.\n        ctx._transformMatrix =\n          [PRINT_OUTPUT_SCALE, 0, 0, PRINT_OUTPUT_SCALE, 0, 0];\n        ctx.scale(PRINT_OUTPUT_SCALE, PRINT_OUTPUT_SCALE);\n\n        var renderContext = {\n          canvasContext: ctx,\n          viewport: viewport,\n          intent: 'print'\n        };\n\n        pdfPage.render(renderContext).promise.then(function() {\n          // Tell the printEngine that rendering this canvas/page has finished.\n          obj.done();\n        }, function(error) {\n          console.error(error);\n          // Tell the printEngine that rendering this canvas/page has failed.\n          // This will make the print proces stop.\n          if ('abort' in obj) {\n            obj.abort();\n          } else {\n            obj.done();\n          }\n        });\n      };\n    },\n  };\n\n  return PDFPageView;\n})();\n\n\n/**\n * @typedef {Object} TextLayerBuilderOptions\n * @property {HTMLDivElement} textLayerDiv - The text layer container.\n * @property {number} pageIndex - The page index.\n * @property {PageViewport} viewport - The viewport of the text layer.\n * @property {PDFFindController} findController\n */\n\n/**\n * TextLayerBuilder provides text-selection functionality for the PDF.\n * It does this by creating overlay divs over the PDF text. These divs\n * contain text that matches the PDF text they are overlaying. This object\n * also provides a way to highlight text that is being searched for.\n * @class\n */\nvar TextLayerBuilder = (function TextLayerBuilderClosure() {\n  function TextLayerBuilder(options) {\n    this.textLayerDiv = options.textLayerDiv;\n    this.renderingDone = false;\n    this.divContentDone = false;\n    this.pageIdx = options.pageIndex;\n    this.pageNumber = this.pageIdx + 1;\n    this.matches = [];\n    this.viewport = options.viewport;\n    this.textDivs = [];\n    this.findController = options.findController || null;\n    this.textLayerRenderTask = null;\n    this._bindMouse();\n  }\n\n  TextLayerBuilder.prototype = {\n    _finishRendering: function TextLayerBuilder_finishRendering() {\n      this.renderingDone = true;\n\n      var endOfContent = document.createElement('div');\n      endOfContent.className = 'endOfContent';\n      this.textLayerDiv.appendChild(endOfContent);\n\n      var event = document.createEvent('CustomEvent');\n      event.initCustomEvent('textlayerrendered', true, true, {\n        pageNumber: this.pageNumber\n      });\n      this.textLayerDiv.dispatchEvent(event);\n    },\n\n    /**\n     * Renders the text layer.\n     * @param {number} timeout (optional) if specified, the rendering waits\n     *   for specified amount of ms.\n     */\n    render: function TextLayerBuilder_render(timeout) {\n      if (!this.divContentDone || this.renderingDone) {\n        return;\n      }\n\n      if (this.textLayerRenderTask) {\n        this.textLayerRenderTask.cancel();\n        this.textLayerRenderTask = null;\n      }\n\n      this.textDivs = [];\n      var textLayerFrag = document.createDocumentFragment();\n      this.textLayerRenderTask = PDFJS.renderTextLayer({\n        textContent: this.textContent,\n        container: textLayerFrag,\n        viewport: this.viewport,\n        textDivs: this.textDivs,\n        timeout: timeout\n      });\n      this.textLayerRenderTask.promise.then(function () {\n        this.textLayerDiv.appendChild(textLayerFrag);\n        this._finishRendering();\n        this.updateMatches();\n      }.bind(this), function (reason) {\n        // canceled or failed to render text layer -- skipping errors\n      });\n    },\n\n    setTextContent: function TextLayerBuilder_setTextContent(textContent) {\n      if (this.textLayerRenderTask) {\n        this.textLayerRenderTask.cancel();\n        this.textLayerRenderTask = null;\n      }\n      this.textContent = textContent;\n      this.divContentDone = true;\n    },\n\n    convertMatches: function TextLayerBuilder_convertMatches(matches) {\n      var i = 0;\n      var iIndex = 0;\n      var bidiTexts = this.textContent.items;\n      var end = bidiTexts.length - 1;\n      var queryLen = (this.findController === null ?\n                      0 : this.findController.state.query.length);\n      var ret = [];\n\n      for (var m = 0, len = matches.length; m < len; m++) {\n        // Calculate the start position.\n        var matchIdx = matches[m];\n\n        // Loop over the divIdxs.\n        while (i !== end && matchIdx >= (iIndex + bidiTexts[i].str.length)) {\n          iIndex += bidiTexts[i].str.length;\n          i++;\n        }\n\n        if (i === bidiTexts.length) {\n          console.error('Could not find a matching mapping');\n        }\n\n        var match = {\n          begin: {\n            divIdx: i,\n            offset: matchIdx - iIndex\n          }\n        };\n\n        // Calculate the end position.\n        matchIdx += queryLen;\n\n        // Somewhat the same array as above, but use > instead of >= to get\n        // the end position right.\n        while (i !== end && matchIdx > (iIndex + bidiTexts[i].str.length)) {\n          iIndex += bidiTexts[i].str.length;\n          i++;\n        }\n\n        match.end = {\n          divIdx: i,\n          offset: matchIdx - iIndex\n        };\n        ret.push(match);\n      }\n\n      return ret;\n    },\n\n    renderMatches: function TextLayerBuilder_renderMatches(matches) {\n      // Early exit if there is nothing to render.\n      if (matches.length === 0) {\n        return;\n      }\n\n      var bidiTexts = this.textContent.items;\n      var textDivs = this.textDivs;\n      var prevEnd = null;\n      var pageIdx = this.pageIdx;\n      var isSelectedPage = (this.findController === null ?\n        false : (pageIdx === this.findController.selected.pageIdx));\n      var selectedMatchIdx = (this.findController === null ?\n                              -1 : this.findController.selected.matchIdx);\n      var highlightAll = (this.findController === null ?\n                          false : this.findController.state.highlightAll);\n      var infinity = {\n        divIdx: -1,\n        offset: undefined\n      };\n\n      function beginText(begin, className) {\n        var divIdx = begin.divIdx;\n        textDivs[divIdx].textContent = '';\n        appendTextToDiv(divIdx, 0, begin.offset, className);\n      }\n\n      function appendTextToDiv(divIdx, fromOffset, toOffset, className) {\n        var div = textDivs[divIdx];\n        var content = bidiTexts[divIdx].str.substring(fromOffset, toOffset);\n        var node = document.createTextNode(content);\n        if (className) {\n          var span = document.createElement('span');\n          span.className = className;\n          span.appendChild(node);\n          div.appendChild(span);\n          return;\n        }\n        div.appendChild(node);\n      }\n\n      var i0 = selectedMatchIdx, i1 = i0 + 1;\n      if (highlightAll) {\n        i0 = 0;\n        i1 = matches.length;\n      } else if (!isSelectedPage) {\n        // Not highlighting all and this isn't the selected page, so do nothing.\n        return;\n      }\n\n      for (var i = i0; i < i1; i++) {\n        var match = matches[i];\n        var begin = match.begin;\n        var end = match.end;\n        var isSelected = (isSelectedPage && i === selectedMatchIdx);\n        var highlightSuffix = (isSelected ? ' selected' : '');\n\n        if (this.findController) {\n          this.findController.updateMatchPosition(pageIdx, i, textDivs,\n                                                  begin.divIdx, end.divIdx);\n        }\n\n        // Match inside new div.\n        if (!prevEnd || begin.divIdx !== prevEnd.divIdx) {\n          // If there was a previous div, then add the text at the end.\n          if (prevEnd !== null) {\n            appendTextToDiv(prevEnd.divIdx, prevEnd.offset, infinity.offset);\n          }\n          // Clear the divs and set the content until the starting point.\n          beginText(begin);\n        } else {\n          appendTextToDiv(prevEnd.divIdx, prevEnd.offset, begin.offset);\n        }\n\n        if (begin.divIdx === end.divIdx) {\n          appendTextToDiv(begin.divIdx, begin.offset, end.offset,\n                          'highlight' + highlightSuffix);\n        } else {\n          appendTextToDiv(begin.divIdx, begin.offset, infinity.offset,\n                          'highlight begin' + highlightSuffix);\n          for (var n0 = begin.divIdx + 1, n1 = end.divIdx; n0 < n1; n0++) {\n            textDivs[n0].className = 'highlight middle' + highlightSuffix;\n          }\n          beginText(end, 'highlight end' + highlightSuffix);\n        }\n        prevEnd = end;\n      }\n\n      if (prevEnd) {\n        appendTextToDiv(prevEnd.divIdx, prevEnd.offset, infinity.offset);\n      }\n    },\n\n    updateMatches: function TextLayerBuilder_updateMatches() {\n      // Only show matches when all rendering is done.\n      if (!this.renderingDone) {\n        return;\n      }\n\n      // Clear all matches.\n      var matches = this.matches;\n      var textDivs = this.textDivs;\n      var bidiTexts = this.textContent.items;\n      var clearedUntilDivIdx = -1;\n\n      // Clear all current matches.\n      for (var i = 0, len = matches.length; i < len; i++) {\n        var match = matches[i];\n        var begin = Math.max(clearedUntilDivIdx, match.begin.divIdx);\n        for (var n = begin, end = match.end.divIdx; n <= end; n++) {\n          var div = textDivs[n];\n          div.textContent = bidiTexts[n].str;\n          div.className = '';\n        }\n        clearedUntilDivIdx = match.end.divIdx + 1;\n      }\n\n      if (this.findController === null || !this.findController.active) {\n        return;\n      }\n\n      // Convert the matches on the page controller into the match format\n      // used for the textLayer.\n      this.matches = this.convertMatches(this.findController === null ?\n        [] : (this.findController.pageMatches[this.pageIdx] || []));\n      this.renderMatches(this.matches);\n    },\n\n    /**\n     * Fixes text selection: adds additional div where mouse was clicked.\n     * This reduces flickering of the content if mouse slowly dragged down/up.\n     * @private\n     */\n    _bindMouse: function TextLayerBuilder_bindMouse() {\n      var div = this.textLayerDiv;\n      div.addEventListener('mousedown', function (e) {\n        var end = div.querySelector('.endOfContent');\n        if (!end) {\n          return;\n        }\n        // On non-Firefox browsers, the selection will feel better if the height\n        // of the endOfContent div will be adjusted to start at mouse click\n        // location -- this will avoid flickering when selections moves up.\n        // However it does not work when selection started on empty space.\n        var adjustTop = e.target !== div;\n        if (adjustTop) {\n          var divBounds = div.getBoundingClientRect();\n          var r = Math.max(0, (e.pageY - divBounds.top) / divBounds.height);\n          end.style.top = (r * 100).toFixed(2) + '%';\n        }\n        end.classList.add('active');\n      });\n      div.addEventListener('mouseup', function (e) {\n        var end = div.querySelector('.endOfContent');\n        if (!end) {\n          return;\n        }\n        end.style.top = '';\n        end.classList.remove('active');\n      });\n    },\n  };\n  return TextLayerBuilder;\n})();\n\n/**\n * @constructor\n * @implements IPDFTextLayerFactory\n */\nfunction DefaultTextLayerFactory() {}\nDefaultTextLayerFactory.prototype = {\n  /**\n   * @param {HTMLDivElement} textLayerDiv\n   * @param {number} pageIndex\n   * @param {PageViewport} viewport\n   * @returns {TextLayerBuilder}\n   */\n  createTextLayerBuilder: function (textLayerDiv, pageIndex, viewport) {\n    return new TextLayerBuilder({\n      textLayerDiv: textLayerDiv,\n      pageIndex: pageIndex,\n      viewport: viewport\n    });\n  }\n};\n\n\n/**\n * @typedef {Object} AnnotationLayerBuilderOptions\n * @property {HTMLDivElement} pageDiv\n * @property {PDFPage} pdfPage\n * @property {IPDFLinkService} linkService\n */\n\n/**\n * @class\n */\nvar AnnotationLayerBuilder = (function AnnotationLayerBuilderClosure() {\n  /**\n   * @param {AnnotationLayerBuilderOptions} options\n   * @constructs AnnotationLayerBuilder\n   */\n  function AnnotationLayerBuilder(options) {\n    this.pageDiv = options.pageDiv;\n    this.pdfPage = options.pdfPage;\n    this.linkService = options.linkService;\n\n    this.div = null;\n  }\n\n  AnnotationLayerBuilder.prototype =\n      /** @lends AnnotationLayerBuilder.prototype */ {\n\n    /**\n     * @param {PageViewport} viewport\n     * @param {string} intent (default value is 'display')\n     */\n    render: function AnnotationLayerBuilder_render(viewport, intent) {\n      var self = this;\n      var parameters = {\n        intent: (intent === undefined ? 'display' : intent),\n      };\n\n      this.pdfPage.getAnnotations(parameters).then(function (annotations) {\n        viewport = viewport.clone({ dontFlip: true });\n        parameters = {\n          viewport: viewport,\n          div: self.div,\n          annotations: annotations,\n          page: self.pdfPage,\n          linkService: self.linkService\n        };\n\n        if (self.div) {\n          // If an annotationLayer already exists, refresh its children's\n          // transformation matrices.\n          PDFJS.AnnotationLayer.update(parameters);\n        } else {\n          // Create an annotation layer div and render the annotations\n          // if there is at least one annotation.\n          if (annotations.length === 0) {\n            return;\n          }\n\n          self.div = document.createElement('div');\n          self.div.className = 'annotationLayer';\n          self.pageDiv.appendChild(self.div);\n          parameters.div = self.div;\n\n          PDFJS.AnnotationLayer.render(parameters);\n          if (typeof mozL10n !== 'undefined') {\n            mozL10n.translate(self.div);\n          }\n        }\n      });\n    },\n\n    hide: function AnnotationLayerBuilder_hide() {\n      if (!this.div) {\n        return;\n      }\n      this.div.setAttribute('hidden', 'true');\n    }\n  };\n\n  return AnnotationLayerBuilder;\n})();\n\n/**\n * @constructor\n * @implements IPDFAnnotationLayerFactory\n */\nfunction DefaultAnnotationLayerFactory() {}\nDefaultAnnotationLayerFactory.prototype = {\n  /**\n   * @param {HTMLDivElement} pageDiv\n   * @param {PDFPage} pdfPage\n   * @returns {AnnotationLayerBuilder}\n   */\n  createAnnotationLayerBuilder: function (pageDiv, pdfPage) {\n    return new AnnotationLayerBuilder({\n      pageDiv: pageDiv,\n      pdfPage: pdfPage,\n      linkService: new SimpleLinkService(),\n    });\n  }\n};\n\n\n/**\n * @typedef {Object} PDFViewerOptions\n * @property {HTMLDivElement} container - The container for the viewer element.\n * @property {HTMLDivElement} viewer - (optional) The viewer element.\n * @property {IPDFLinkService} linkService - The navigation/linking service.\n * @property {PDFRenderingQueue} renderingQueue - (optional) The rendering\n *   queue object.\n * @property {boolean} removePageBorders - (optional) Removes the border shadow\n *   around the pages. The default is false.\n */\n\n/**\n * Simple viewer control to display PDF content/pages.\n * @class\n * @implements {IRenderableView}\n */\nvar PDFViewer = (function pdfViewer() {\n  function PDFPageViewBuffer(size) {\n    var data = [];\n    this.push = function cachePush(view) {\n      var i = data.indexOf(view);\n      if (i >= 0) {\n        data.splice(i, 1);\n      }\n      data.push(view);\n      if (data.length > size) {\n        data.shift().destroy();\n      }\n    };\n    this.resize = function (newSize) {\n      size = newSize;\n      while (data.length > size) {\n        data.shift().destroy();\n      }\n    };\n  }\n\n  function isSameScale(oldScale, newScale) {\n    if (newScale === oldScale) {\n      return true;\n    }\n    if (Math.abs(newScale - oldScale) < 1e-15) {\n      // Prevent unnecessary re-rendering of all pages when the scale\n      // changes only because of limited numerical precision.\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * @constructs PDFViewer\n   * @param {PDFViewerOptions} options\n   */\n  function PDFViewer(options) {\n    this.container = options.container;\n    this.viewer = options.viewer || options.container.firstElementChild;\n    this.linkService = options.linkService || new SimpleLinkService();\n    this.removePageBorders = options.removePageBorders || false;\n\n    this.defaultRenderingQueue = !options.renderingQueue;\n    if (this.defaultRenderingQueue) {\n      // Custom rendering queue is not specified, using default one\n      this.renderingQueue = new PDFRenderingQueue();\n      this.renderingQueue.setViewer(this);\n    } else {\n      this.renderingQueue = options.renderingQueue;\n    }\n\n    this.scroll = watchScroll(this.container, this._scrollUpdate.bind(this));\n    this.updateInProgress = false;\n    this.presentationModeState = PresentationModeState.UNKNOWN;\n    this._resetView();\n\n    if (this.removePageBorders) {\n      this.viewer.classList.add('removePageBorders');\n    }\n  }\n\n  PDFViewer.prototype = /** @lends PDFViewer.prototype */{\n    get pagesCount() {\n      return this._pages.length;\n    },\n\n    getPageView: function (index) {\n      return this._pages[index];\n    },\n\n    get currentPageNumber() {\n      return this._currentPageNumber;\n    },\n\n    set currentPageNumber(val) {\n      if (!this.pdfDocument) {\n        this._currentPageNumber = val;\n        return;\n      }\n\n      var event = document.createEvent('UIEvents');\n      event.initUIEvent('pagechange', true, true, window, 0);\n      event.updateInProgress = this.updateInProgress;\n\n      if (!(0 < val && val <= this.pagesCount)) {\n        event.pageNumber = this._currentPageNumber;\n        event.previousPageNumber = val;\n        this.container.dispatchEvent(event);\n        return;\n      }\n\n      event.previousPageNumber = this._currentPageNumber;\n      this._currentPageNumber = val;\n      event.pageNumber = val;\n      this.container.dispatchEvent(event);\n\n      // Check if the caller is `PDFViewer_update`, to avoid breaking scrolling.\n      if (this.updateInProgress) {\n        return;\n      }\n      this.scrollPageIntoView(val);\n    },\n\n    /**\n     * @returns {number}\n     */\n    get currentScale() {\n      return this._currentScale !== UNKNOWN_SCALE ? this._currentScale :\n                                                    DEFAULT_SCALE;\n    },\n\n    /**\n     * @param {number} val - Scale of the pages in percents.\n     */\n    set currentScale(val) {\n      if (isNaN(val))  {\n        throw new Error('Invalid numeric scale');\n      }\n      if (!this.pdfDocument) {\n        this._currentScale = val;\n        this._currentScaleValue = val !== UNKNOWN_SCALE ? val.toString() : null;\n        return;\n      }\n      this._setScale(val, false);\n    },\n\n    /**\n     * @returns {string}\n     */\n    get currentScaleValue() {\n      return this._currentScaleValue;\n    },\n\n    /**\n     * @param val - The scale of the pages (in percent or predefined value).\n     */\n    set currentScaleValue(val) {\n      if (!this.pdfDocument) {\n        this._currentScale = isNaN(val) ? UNKNOWN_SCALE : val;\n        this._currentScaleValue = val;\n        return;\n      }\n      this._setScale(val, false);\n    },\n\n    /**\n     * @returns {number}\n     */\n    get pagesRotation() {\n      return this._pagesRotation;\n    },\n\n    /**\n     * @param {number} rotation - The rotation of the pages (0, 90, 180, 270).\n     */\n    set pagesRotation(rotation) {\n      this._pagesRotation = rotation;\n\n      for (var i = 0, l = this._pages.length; i < l; i++) {\n        var pageView = this._pages[i];\n        pageView.update(pageView.scale, rotation);\n      }\n\n      this._setScale(this._currentScaleValue, true);\n\n      if (this.defaultRenderingQueue) {\n        this.update();\n      }\n    },\n\n    /**\n     * @param pdfDocument {PDFDocument}\n     */\n    setDocument: function (pdfDocument) {\n      if (this.pdfDocument) {\n        this._resetView();\n      }\n\n      this.pdfDocument = pdfDocument;\n      if (!pdfDocument) {\n        return;\n      }\n\n      var pagesCount = pdfDocument.numPages;\n      var self = this;\n\n      var resolvePagesPromise;\n      var pagesPromise = new Promise(function (resolve) {\n        resolvePagesPromise = resolve;\n      });\n      this.pagesPromise = pagesPromise;\n      pagesPromise.then(function () {\n        var event = document.createEvent('CustomEvent');\n        event.initCustomEvent('pagesloaded', true, true, {\n          pagesCount: pagesCount\n        });\n        self.container.dispatchEvent(event);\n      });\n\n      var isOnePageRenderedResolved = false;\n      var resolveOnePageRendered = null;\n      var onePageRendered = new Promise(function (resolve) {\n        resolveOnePageRendered = resolve;\n      });\n      this.onePageRendered = onePageRendered;\n\n      var bindOnAfterAndBeforeDraw = function (pageView) {\n        pageView.onBeforeDraw = function pdfViewLoadOnBeforeDraw() {\n          // Add the page to the buffer at the start of drawing. That way it can\n          // be evicted from the buffer and destroyed even if we pause its\n          // rendering.\n          self._buffer.push(this);\n        };\n        // when page is painted, using the image as thumbnail base\n        pageView.onAfterDraw = function pdfViewLoadOnAfterDraw() {\n          if (!isOnePageRenderedResolved) {\n            isOnePageRenderedResolved = true;\n            resolveOnePageRendered();\n          }\n        };\n      };\n\n      var firstPagePromise = pdfDocument.getPage(1);\n      this.firstPagePromise = firstPagePromise;\n\n      // Fetch a single page so we can get a viewport that will be the default\n      // viewport for all pages\n      return firstPagePromise.then(function(pdfPage) {\n        var scale = this.currentScale;\n        var viewport = pdfPage.getViewport(scale * CSS_UNITS);\n        for (var pageNum = 1; pageNum <= pagesCount; ++pageNum) {\n          var textLayerFactory = null;\n          if (!PDFJS.disableTextLayer) {\n            textLayerFactory = this;\n          }\n          var pageView = new PDFPageView({\n            container: this.viewer,\n            id: pageNum,\n            scale: scale,\n            defaultViewport: viewport.clone(),\n            renderingQueue: this.renderingQueue,\n            textLayerFactory: textLayerFactory,\n            annotationLayerFactory: this\n          });\n          bindOnAfterAndBeforeDraw(pageView);\n          this._pages.push(pageView);\n        }\n\n        var linkService = this.linkService;\n\n        // Fetch all the pages since the viewport is needed before printing\n        // starts to create the correct size canvas. Wait until one page is\n        // rendered so we don't tie up too many resources early on.\n        onePageRendered.then(function () {\n          if (!PDFJS.disableAutoFetch) {\n            var getPagesLeft = pagesCount;\n            for (var pageNum = 1; pageNum <= pagesCount; ++pageNum) {\n              pdfDocument.getPage(pageNum).then(function (pageNum, pdfPage) {\n                var pageView = self._pages[pageNum - 1];\n                if (!pageView.pdfPage) {\n                  pageView.setPdfPage(pdfPage);\n                }\n                linkService.cachePageRef(pageNum, pdfPage.ref);\n                getPagesLeft--;\n                if (!getPagesLeft) {\n                  resolvePagesPromise();\n                }\n              }.bind(null, pageNum));\n            }\n          } else {\n            // XXX: Printing is semi-broken with auto fetch disabled.\n            resolvePagesPromise();\n          }\n        });\n\n        var event = document.createEvent('CustomEvent');\n        event.initCustomEvent('pagesinit', true, true, null);\n        self.container.dispatchEvent(event);\n\n        if (this.defaultRenderingQueue) {\n          this.update();\n        }\n\n        if (this.findController) {\n          this.findController.resolveFirstPage();\n        }\n      }.bind(this));\n    },\n\n    _resetView: function () {\n      this._pages = [];\n      this._currentPageNumber = 1;\n      this._currentScale = UNKNOWN_SCALE;\n      this._currentScaleValue = null;\n      this._buffer = new PDFPageViewBuffer(DEFAULT_CACHE_SIZE);\n      this._location = null;\n      this._pagesRotation = 0;\n      this._pagesRequests = [];\n\n      var container = this.viewer;\n      while (container.hasChildNodes()) {\n        container.removeChild(container.lastChild);\n      }\n    },\n\n    _scrollUpdate: function PDFViewer_scrollUpdate() {\n      if (this.pagesCount === 0) {\n        return;\n      }\n      this.update();\n      for (var i = 0, ii = this._pages.length; i < ii; i++) {\n        this._pages[i].updatePosition();\n      }\n    },\n\n    _setScaleDispatchEvent: function pdfViewer_setScaleDispatchEvent(\n        newScale, newValue, preset) {\n      var event = document.createEvent('UIEvents');\n      event.initUIEvent('scalechange', true, true, window, 0);\n      event.scale = newScale;\n      if (preset) {\n        event.presetValue = newValue;\n      }\n      this.container.dispatchEvent(event);\n    },\n\n    _setScaleUpdatePages: function pdfViewer_setScaleUpdatePages(\n        newScale, newValue, noScroll, preset) {\n      this._currentScaleValue = newValue;\n\n      if (isSameScale(this._currentScale, newScale)) {\n        if (preset) {\n          this._setScaleDispatchEvent(newScale, newValue, true);\n        }\n        return;\n      }\n\n      for (var i = 0, ii = this._pages.length; i < ii; i++) {\n        this._pages[i].update(newScale);\n      }\n      this._currentScale = newScale;\n\n      if (!noScroll) {\n        var page = this._currentPageNumber, dest;\n        if (this._location && !IGNORE_CURRENT_POSITION_ON_ZOOM &&\n            !(this.isInPresentationMode || this.isChangingPresentationMode)) {\n          page = this._location.pageNumber;\n          dest = [null, { name: 'XYZ' }, this._location.left,\n                  this._location.top, null];\n        }\n        this.scrollPageIntoView(page, dest);\n      }\n\n      this._setScaleDispatchEvent(newScale, newValue, preset);\n\n      if (this.defaultRenderingQueue) {\n        this.update();\n      }\n    },\n\n    _setScale: function pdfViewer_setScale(value, noScroll) {\n      var scale = parseFloat(value);\n\n      if (scale > 0) {\n        this._setScaleUpdatePages(scale, value, noScroll, false);\n      } else {\n        var currentPage = this._pages[this._currentPageNumber - 1];\n        if (!currentPage) {\n          return;\n        }\n        var hPadding = (this.isInPresentationMode || this.removePageBorders) ?\n          0 : SCROLLBAR_PADDING;\n        var vPadding = (this.isInPresentationMode || this.removePageBorders) ?\n          0 : VERTICAL_PADDING;\n        var pageWidthScale = (this.container.clientWidth - hPadding) /\n                             currentPage.width * currentPage.scale;\n        var pageHeightScale = (this.container.clientHeight - vPadding) /\n                              currentPage.height * currentPage.scale;\n        switch (value) {\n          case 'page-actual':\n            scale = 1;\n            break;\n          case 'page-width':\n            scale = pageWidthScale;\n            break;\n          case 'page-height':\n            scale = pageHeightScale;\n            break;\n          case 'page-fit':\n            scale = Math.min(pageWidthScale, pageHeightScale);\n            break;\n          case 'auto':\n            var isLandscape = (currentPage.width > currentPage.height);\n            // For pages in landscape mode, fit the page height to the viewer\n            // *unless* the page would thus become too wide to fit horizontally.\n            var horizontalScale = isLandscape ?\n              Math.min(pageHeightScale, pageWidthScale) : pageWidthScale;\n            scale = Math.min(MAX_AUTO_SCALE, horizontalScale);\n            break;\n          default:\n            console.error('pdfViewSetScale: \\'' + value +\n              '\\' is an unknown zoom value.');\n            return;\n        }\n        this._setScaleUpdatePages(scale, value, noScroll, true);\n      }\n    },\n\n    /**\n     * Scrolls page into view.\n     * @param {number} pageNumber\n     * @param {Array} dest - (optional) original PDF destination array:\n     *   <page-ref> </XYZ|FitXXX> <args..>\n     */\n    scrollPageIntoView: function PDFViewer_scrollPageIntoView(pageNumber,\n                                                              dest) {\n      if (!this.pdfDocument) {\n        return;\n      }\n\n      var pageView = this._pages[pageNumber - 1];\n\n      if (this.isInPresentationMode) {\n        if (this._currentPageNumber !== pageView.id) {\n          // Avoid breaking getVisiblePages in presentation mode.\n          this.currentPageNumber = pageView.id;\n          return;\n        }\n        dest = null;\n        // Fixes the case when PDF has different page sizes.\n        this._setScale(this._currentScaleValue, true);\n      }\n      if (!dest) {\n        scrollIntoView(pageView.div);\n        return;\n      }\n\n      var x = 0, y = 0;\n      var width = 0, height = 0, widthScale, heightScale;\n      var changeOrientation = (pageView.rotation % 180 === 0 ? false : true);\n      var pageWidth = (changeOrientation ? pageView.height : pageView.width) /\n        pageView.scale / CSS_UNITS;\n      var pageHeight = (changeOrientation ? pageView.width : pageView.height) /\n        pageView.scale / CSS_UNITS;\n      var scale = 0;\n      switch (dest[1].name) {\n        case 'XYZ':\n          x = dest[2];\n          y = dest[3];\n          scale = dest[4];\n          // If x and/or y coordinates are not supplied, default to\n          // _top_ left of the page (not the obvious bottom left,\n          // since aligning the bottom of the intended page with the\n          // top of the window is rarely helpful).\n          x = x !== null ? x : 0;\n          y = y !== null ? y : pageHeight;\n          break;\n        case 'Fit':\n        case 'FitB':\n          scale = 'page-fit';\n          break;\n        case 'FitH':\n        case 'FitBH':\n          y = dest[2];\n          scale = 'page-width';\n          // According to the PDF spec, section 12.3.2.2, a `null` value in the\n          // parameter should maintain the position relative to the new page.\n          if (y === null && this._location) {\n            x = this._location.left;\n            y = this._location.top;\n          }\n          break;\n        case 'FitV':\n        case 'FitBV':\n          x = dest[2];\n          width = pageWidth;\n          height = pageHeight;\n          scale = 'page-height';\n          break;\n        case 'FitR':\n          x = dest[2];\n          y = dest[3];\n          width = dest[4] - x;\n          height = dest[5] - y;\n          var hPadding = this.removePageBorders ? 0 : SCROLLBAR_PADDING;\n          var vPadding = this.removePageBorders ? 0 : VERTICAL_PADDING;\n\n          widthScale = (this.container.clientWidth - hPadding) /\n            width / CSS_UNITS;\n          heightScale = (this.container.clientHeight - vPadding) /\n            height / CSS_UNITS;\n          scale = Math.min(Math.abs(widthScale), Math.abs(heightScale));\n          break;\n        default:\n          return;\n      }\n\n      if (scale && scale !== this._currentScale) {\n        this.currentScaleValue = scale;\n      } else if (this._currentScale === UNKNOWN_SCALE) {\n        this.currentScaleValue = DEFAULT_SCALE_VALUE;\n      }\n\n      if (scale === 'page-fit' && !dest[4]) {\n        scrollIntoView(pageView.div);\n        return;\n      }\n\n      var boundingRect = [\n        pageView.viewport.convertToViewportPoint(x, y),\n        pageView.viewport.convertToViewportPoint(x + width, y + height)\n      ];\n      var left = Math.min(boundingRect[0][0], boundingRect[1][0]);\n      var top = Math.min(boundingRect[0][1], boundingRect[1][1]);\n\n      scrollIntoView(pageView.div, { left: left, top: top });\n    },\n\n    _updateLocation: function (firstPage) {\n      var currentScale = this._currentScale;\n      var currentScaleValue = this._currentScaleValue;\n      var normalizedScaleValue =\n        parseFloat(currentScaleValue) === currentScale ?\n        Math.round(currentScale * 10000) / 100 : currentScaleValue;\n\n      var pageNumber = firstPage.id;\n      var pdfOpenParams = '#page=' + pageNumber;\n      pdfOpenParams += '&zoom=' + normalizedScaleValue;\n      var currentPageView = this._pages[pageNumber - 1];\n      var container = this.container;\n      var topLeft = currentPageView.getPagePoint(\n        (container.scrollLeft - firstPage.x),\n        (container.scrollTop - firstPage.y));\n      var intLeft = Math.round(topLeft[0]);\n      var intTop = Math.round(topLeft[1]);\n      pdfOpenParams += ',' + intLeft + ',' + intTop;\n\n      this._location = {\n        pageNumber: pageNumber,\n        scale: normalizedScaleValue,\n        top: intTop,\n        left: intLeft,\n        pdfOpenParams: pdfOpenParams\n      };\n    },\n\n    update: function PDFViewer_update() {\n      var visible = this._getVisiblePages();\n      var visiblePages = visible.views;\n      if (visiblePages.length === 0) {\n        return;\n      }\n\n      this.updateInProgress = true;\n\n      var suggestedCacheSize = Math.max(DEFAULT_CACHE_SIZE,\n          2 * visiblePages.length + 1);\n      this._buffer.resize(suggestedCacheSize);\n\n      this.renderingQueue.renderHighestPriority(visible);\n\n      var currentId = this._currentPageNumber;\n      var firstPage = visible.first;\n\n      for (var i = 0, ii = visiblePages.length, stillFullyVisible = false;\n           i < ii; ++i) {\n        var page = visiblePages[i];\n\n        if (page.percent < 100) {\n          break;\n        }\n        if (page.id === currentId) {\n          stillFullyVisible = true;\n          break;\n        }\n      }\n\n      if (!stillFullyVisible) {\n        currentId = visiblePages[0].id;\n      }\n\n      if (!this.isInPresentationMode) {\n        this.currentPageNumber = currentId;\n      }\n\n      this._updateLocation(firstPage);\n\n      this.updateInProgress = false;\n\n      var event = document.createEvent('UIEvents');\n      event.initUIEvent('updateviewarea', true, true, window, 0);\n      event.location = this._location;\n      this.container.dispatchEvent(event);\n    },\n\n    containsElement: function (element) {\n      return this.container.contains(element);\n    },\n\n    focus: function () {\n      this.container.focus();\n    },\n\n    get isInPresentationMode() {\n      return this.presentationModeState === PresentationModeState.FULLSCREEN;\n    },\n\n    get isChangingPresentationMode() {\n      return this.presentationModeState === PresentationModeState.CHANGING;\n    },\n\n    get isHorizontalScrollbarEnabled() {\n      return (this.isInPresentationMode ?\n        false : (this.container.scrollWidth > this.container.clientWidth));\n    },\n\n    _getVisiblePages: function () {\n      if (!this.isInPresentationMode) {\n        return getVisibleElements(this.container, this._pages, true);\n      } else {\n        // The algorithm in getVisibleElements doesn't work in all browsers and\n        // configurations when presentation mode is active.\n        var visible = [];\n        var currentPage = this._pages[this._currentPageNumber - 1];\n        visible.push({ id: currentPage.id, view: currentPage });\n        return { first: currentPage, last: currentPage, views: visible };\n      }\n    },\n\n    cleanup: function () {\n      for (var i = 0, ii = this._pages.length; i < ii; i++) {\n        if (this._pages[i] &&\n            this._pages[i].renderingState !== RenderingStates.FINISHED) {\n          this._pages[i].reset();\n        }\n      }\n    },\n\n    /**\n     * @param {PDFPageView} pageView\n     * @returns {PDFPage}\n     * @private\n     */\n    _ensurePdfPageLoaded: function (pageView) {\n      if (pageView.pdfPage) {\n        return Promise.resolve(pageView.pdfPage);\n      }\n      var pageNumber = pageView.id;\n      if (this._pagesRequests[pageNumber]) {\n        return this._pagesRequests[pageNumber];\n      }\n      var promise = this.pdfDocument.getPage(pageNumber).then(\n          function (pdfPage) {\n        pageView.setPdfPage(pdfPage);\n        this._pagesRequests[pageNumber] = null;\n        return pdfPage;\n      }.bind(this));\n      this._pagesRequests[pageNumber] = promise;\n      return promise;\n    },\n\n    forceRendering: function (currentlyVisiblePages) {\n      var visiblePages = currentlyVisiblePages || this._getVisiblePages();\n      var pageView = this.renderingQueue.getHighestPriority(visiblePages,\n                                                            this._pages,\n                                                            this.scroll.down);\n      if (pageView) {\n        this._ensurePdfPageLoaded(pageView).then(function () {\n          this.renderingQueue.renderView(pageView);\n        }.bind(this));\n        return true;\n      }\n      return false;\n    },\n\n    getPageTextContent: function (pageIndex) {\n      return this.pdfDocument.getPage(pageIndex + 1).then(function (page) {\n        return page.getTextContent({ normalizeWhitespace: true });\n      });\n    },\n\n    /**\n     * @param {HTMLDivElement} textLayerDiv\n     * @param {number} pageIndex\n     * @param {PageViewport} viewport\n     * @returns {TextLayerBuilder}\n     */\n    createTextLayerBuilder: function (textLayerDiv, pageIndex, viewport) {\n      return new TextLayerBuilder({\n        textLayerDiv: textLayerDiv,\n        pageIndex: pageIndex,\n        viewport: viewport,\n        findController: this.isInPresentationMode ? null : this.findController\n      });\n    },\n\n    /**\n     * @param {HTMLDivElement} pageDiv\n     * @param {PDFPage} pdfPage\n     * @returns {AnnotationLayerBuilder}\n     */\n    createAnnotationLayerBuilder: function (pageDiv, pdfPage) {\n      return new AnnotationLayerBuilder({\n        pageDiv: pageDiv,\n        pdfPage: pdfPage,\n        linkService: this.linkService\n      });\n    },\n\n    setFindController: function (findController) {\n      this.findController = findController;\n    },\n  };\n\n  return PDFViewer;\n})();\n\nvar SimpleLinkService = (function SimpleLinkServiceClosure() {\n  function SimpleLinkService() {}\n\n  SimpleLinkService.prototype = {\n    /**\n     * @returns {number}\n     */\n    get page() {\n      return 0;\n    },\n    /**\n     * @param {number} value\n     */\n    set page(value) {},\n    /**\n     * @param dest - The PDF destination object.\n     */\n    navigateTo: function (dest) {},\n    /**\n     * @param dest - The PDF destination object.\n     * @returns {string} The hyperlink to the PDF object.\n     */\n    getDestinationHash: function (dest) {\n      return '#';\n    },\n    /**\n     * @param hash - The PDF parameters/hash.\n     * @returns {string} The hyperlink to the PDF object.\n     */\n    getAnchorUrl: function (hash) {\n      return '#';\n    },\n    /**\n     * @param {string} hash\n     */\n    setHash: function (hash) {},\n    /**\n     * @param {string} action\n     */\n    executeNamedAction: function (action) {},\n    /**\n     * @param {number} pageNum - page number.\n     * @param {Object} pageRef - reference to the page.\n     */\n    cachePageRef: function (pageNum, pageRef) {}\n  };\n  return SimpleLinkService;\n})();\n\n\nvar PDFHistory = (function () {\n  function PDFHistory(options) {\n    this.linkService = options.linkService;\n\n    this.initialized = false;\n    this.initialDestination = null;\n    this.initialBookmark = null;\n  }\n\n  PDFHistory.prototype = {\n    /**\n     * @param {string} fingerprint\n     * @param {IPDFLinkService} linkService\n     */\n    initialize: function pdfHistoryInitialize(fingerprint) {\n      this.initialized = true;\n      this.reInitialized = false;\n      this.allowHashChange = true;\n      this.historyUnlocked = true;\n      this.isViewerInPresentationMode = false;\n\n      this.previousHash = window.location.hash.substring(1);\n      this.currentBookmark = '';\n      this.currentPage = 0;\n      this.updatePreviousBookmark = false;\n      this.previousBookmark = '';\n      this.previousPage = 0;\n      this.nextHashParam = '';\n\n      this.fingerprint = fingerprint;\n      this.currentUid = this.uid = 0;\n      this.current = {};\n\n      var state = window.history.state;\n      if (this._isStateObjectDefined(state)) {\n        // This corresponds to navigating back to the document\n        // from another page in the browser history.\n        if (state.target.dest) {\n          this.initialDestination = state.target.dest;\n        } else {\n          this.initialBookmark = state.target.hash;\n        }\n        this.currentUid = state.uid;\n        this.uid = state.uid + 1;\n        this.current = state.target;\n      } else {\n        // This corresponds to the loading of a new document.\n        if (state && state.fingerprint &&\n          this.fingerprint !== state.fingerprint) {\n          // Reinitialize the browsing history when a new document\n          // is opened in the web viewer.\n          this.reInitialized = true;\n        }\n        this._pushOrReplaceState({fingerprint: this.fingerprint}, true);\n      }\n\n      var self = this;\n      window.addEventListener('popstate', function pdfHistoryPopstate(evt) {\n        if (!self.historyUnlocked) {\n          return;\n        }\n        if (evt.state) {\n          // Move back/forward in the history.\n          self._goTo(evt.state);\n          return;\n        }\n\n        // If the state is not set, then the user tried to navigate to a\n        // different hash by manually editing the URL and pressing Enter, or by\n        // clicking on an in-page link (e.g. the \"current view\" link).\n        // Save the current view state to the browser history.\n\n        // Note: In Firefox, history.null could also be null after an in-page\n        // navigation to the same URL, and without dispatching the popstate\n        // event: https://bugzilla.mozilla.org/show_bug.cgi?id=1183881\n\n        if (self.uid === 0) {\n          // Replace the previous state if it was not explicitly set.\n          var previousParams = (self.previousHash && self.currentBookmark &&\n            self.previousHash !== self.currentBookmark) ?\n            {hash: self.currentBookmark, page: self.currentPage} :\n            {page: 1};\n          replacePreviousHistoryState(previousParams, function() {\n            updateHistoryWithCurrentHash();\n          });\n        } else {\n          updateHistoryWithCurrentHash();\n        }\n      }, false);\n\n\n      function updateHistoryWithCurrentHash() {\n        self.previousHash = window.location.hash.slice(1);\n        self._pushToHistory({hash: self.previousHash}, false, true);\n        self._updatePreviousBookmark();\n      }\n\n      function replacePreviousHistoryState(params, callback) {\n        // To modify the previous history entry, the following happens:\n        // 1. history.back()\n        // 2. _pushToHistory, which calls history.replaceState( ... )\n        // 3. history.forward()\n        // Because a navigation via the history API does not immediately update\n        // the history state, the popstate event is used for synchronization.\n        self.historyUnlocked = false;\n\n        // Suppress the hashchange event to avoid side effects caused by\n        // navigating back and forward.\n        self.allowHashChange = false;\n        window.addEventListener('popstate', rewriteHistoryAfterBack);\n        history.back();\n\n        function rewriteHistoryAfterBack() {\n          window.removeEventListener('popstate', rewriteHistoryAfterBack);\n          window.addEventListener('popstate', rewriteHistoryAfterForward);\n          self._pushToHistory(params, false, true);\n          history.forward();\n        }\n        function rewriteHistoryAfterForward() {\n          window.removeEventListener('popstate', rewriteHistoryAfterForward);\n          self.allowHashChange = true;\n          self.historyUnlocked = true;\n          callback();\n        }\n      }\n\n      function pdfHistoryBeforeUnload() {\n        var previousParams = self._getPreviousParams(null, true);\n        if (previousParams) {\n          var replacePrevious = (!self.current.dest &&\n          self.current.hash !== self.previousHash);\n          self._pushToHistory(previousParams, false, replacePrevious);\n          self._updatePreviousBookmark();\n        }\n        // Remove the event listener when navigating away from the document,\n        // since 'beforeunload' prevents Firefox from caching the document.\n        window.removeEventListener('beforeunload', pdfHistoryBeforeUnload,\n                                   false);\n      }\n\n      window.addEventListener('beforeunload', pdfHistoryBeforeUnload, false);\n\n      window.addEventListener('pageshow', function pdfHistoryPageShow(evt) {\n        // If the entire viewer (including the PDF file) is cached in\n        // the browser, we need to reattach the 'beforeunload' event listener\n        // since the 'DOMContentLoaded' event is not fired on 'pageshow'.\n        window.addEventListener('beforeunload', pdfHistoryBeforeUnload, false);\n      }, false);\n\n      window.addEventListener('presentationmodechanged', function(e) {\n        self.isViewerInPresentationMode = !!e.detail.active;\n      });\n    },\n\n    clearHistoryState: function pdfHistory_clearHistoryState() {\n      this._pushOrReplaceState(null, true);\n    },\n\n    _isStateObjectDefined: function pdfHistory_isStateObjectDefined(state) {\n      return (state && state.uid >= 0 &&\n      state.fingerprint && this.fingerprint === state.fingerprint &&\n      state.target && state.target.hash) ? true : false;\n    },\n\n    _pushOrReplaceState: function pdfHistory_pushOrReplaceState(stateObj,\n                                                                replace) {\n      if (replace) {\n      window.history.replaceState(stateObj, '');\n      } else {\n      window.history.pushState(stateObj, '');\n      }\n    },\n\n    get isHashChangeUnlocked() {\n      if (!this.initialized) {\n        return true;\n      }\n      return this.allowHashChange;\n    },\n\n    _updatePreviousBookmark: function pdfHistory_updatePreviousBookmark() {\n      if (this.updatePreviousBookmark &&\n        this.currentBookmark && this.currentPage) {\n        this.previousBookmark = this.currentBookmark;\n        this.previousPage = this.currentPage;\n        this.updatePreviousBookmark = false;\n      }\n    },\n\n    updateCurrentBookmark: function pdfHistoryUpdateCurrentBookmark(bookmark,\n                                                                    pageNum) {\n      if (this.initialized) {\n        this.currentBookmark = bookmark.substring(1);\n        this.currentPage = pageNum | 0;\n        this._updatePreviousBookmark();\n      }\n    },\n\n    updateNextHashParam: function pdfHistoryUpdateNextHashParam(param) {\n      if (this.initialized) {\n        this.nextHashParam = param;\n      }\n    },\n\n    push: function pdfHistoryPush(params, isInitialBookmark) {\n      if (!(this.initialized && this.historyUnlocked)) {\n        return;\n      }\n      if (params.dest && !params.hash) {\n        params.hash = (this.current.hash && this.current.dest &&\n        this.current.dest === params.dest) ?\n          this.current.hash :\n          this.linkService.getDestinationHash(params.dest).split('#')[1];\n      }\n      if (params.page) {\n        params.page |= 0;\n      }\n      if (isInitialBookmark) {\n        var target = window.history.state.target;\n        if (!target) {\n          // Invoked when the user specifies an initial bookmark,\n          // thus setting initialBookmark, when the document is loaded.\n          this._pushToHistory(params, false);\n          this.previousHash = window.location.hash.substring(1);\n        }\n        this.updatePreviousBookmark = this.nextHashParam ? false : true;\n        if (target) {\n          // If the current document is reloaded,\n          // avoid creating duplicate entries in the history.\n          this._updatePreviousBookmark();\n        }\n        return;\n      }\n      if (this.nextHashParam) {\n        if (this.nextHashParam === params.hash) {\n          this.nextHashParam = null;\n          this.updatePreviousBookmark = true;\n          return;\n        } else {\n          this.nextHashParam = null;\n        }\n      }\n\n      if (params.hash) {\n        if (this.current.hash) {\n          if (this.current.hash !== params.hash) {\n            this._pushToHistory(params, true);\n          } else {\n            if (!this.current.page && params.page) {\n              this._pushToHistory(params, false, true);\n            }\n            this.updatePreviousBookmark = true;\n          }\n        } else {\n          this._pushToHistory(params, true);\n        }\n      } else if (this.current.page && params.page &&\n        this.current.page !== params.page) {\n        this._pushToHistory(params, true);\n      }\n    },\n\n    _getPreviousParams: function pdfHistory_getPreviousParams(onlyCheckPage,\n                                                              beforeUnload) {\n      if (!(this.currentBookmark && this.currentPage)) {\n        return null;\n      } else if (this.updatePreviousBookmark) {\n        this.updatePreviousBookmark = false;\n      }\n      if (this.uid > 0 && !(this.previousBookmark && this.previousPage)) {\n        // Prevent the history from getting stuck in the current state,\n        // effectively preventing the user from going back/forward in\n        // the history.\n        //\n        // This happens if the current position in the document didn't change\n        // when the history was previously updated. The reasons for this are\n        // either:\n        // 1. The current zoom value is such that the document does not need to,\n        //    or cannot, be scrolled to display the destination.\n        // 2. The previous destination is broken, and doesn't actally point to a\n        //    position within the document.\n        //    (This is either due to a bad PDF generator, or the user making a\n        //     mistake when entering a destination in the hash parameters.)\n        return null;\n      }\n      if ((!this.current.dest && !onlyCheckPage) || beforeUnload) {\n        if (this.previousBookmark === this.currentBookmark) {\n          return null;\n        }\n      } else if (this.current.page || onlyCheckPage) {\n        if (this.previousPage === this.currentPage) {\n          return null;\n        }\n      } else {\n        return null;\n      }\n      var params = {hash: this.currentBookmark, page: this.currentPage};\n      if (this.isViewerInPresentationMode) {\n        params.hash = null;\n      }\n      return params;\n    },\n\n    _stateObj: function pdfHistory_stateObj(params) {\n      return {fingerprint: this.fingerprint, uid: this.uid, target: params};\n    },\n\n    _pushToHistory: function pdfHistory_pushToHistory(params,\n                                                      addPrevious, overwrite) {\n      if (!this.initialized) {\n        return;\n      }\n      if (!params.hash && params.page) {\n        params.hash = ('page=' + params.page);\n      }\n      if (addPrevious && !overwrite) {\n        var previousParams = this._getPreviousParams();\n        if (previousParams) {\n          var replacePrevious = (!this.current.dest &&\n          this.current.hash !== this.previousHash);\n          this._pushToHistory(previousParams, false, replacePrevious);\n        }\n      }\n      this._pushOrReplaceState(this._stateObj(params),\n        (overwrite || this.uid === 0));\n      this.currentUid = this.uid++;\n      this.current = params;\n      this.updatePreviousBookmark = true;\n    },\n\n    _goTo: function pdfHistory_goTo(state) {\n      if (!(this.initialized && this.historyUnlocked &&\n        this._isStateObjectDefined(state))) {\n        return;\n      }\n      if (!this.reInitialized && state.uid < this.currentUid) {\n        var previousParams = this._getPreviousParams(true);\n        if (previousParams) {\n          this._pushToHistory(this.current, false);\n          this._pushToHistory(previousParams, false);\n          this.currentUid = state.uid;\n          window.history.back();\n          return;\n        }\n      }\n      this.historyUnlocked = false;\n\n      if (state.target.dest) {\n        this.linkService.navigateTo(state.target.dest);\n      } else {\n        this.linkService.setHash(state.target.hash);\n      }\n      this.currentUid = state.uid;\n      if (state.uid > this.uid) {\n        this.uid = state.uid;\n      }\n      this.current = state.target;\n      this.updatePreviousBookmark = true;\n\n      var currentHash = window.location.hash.substring(1);\n      if (this.previousHash !== currentHash) {\n        this.allowHashChange = false;\n      }\n      this.previousHash = currentHash;\n\n      this.historyUnlocked = true;\n    },\n\n    back: function pdfHistoryBack() {\n      this.go(-1);\n    },\n\n    forward: function pdfHistoryForward() {\n      this.go(1);\n    },\n\n    go: function pdfHistoryGo(direction) {\n      if (this.initialized && this.historyUnlocked) {\n        var state = window.history.state;\n        if (direction === -1 && state && state.uid > 0) {\n          window.history.back();\n        } else if (direction === 1 && state && state.uid < (this.uid - 1)) {\n          window.history.forward();\n        }\n      }\n    }\n  };\n\n  return PDFHistory;\n})();\n\n\n  PDFJS.PDFViewer = PDFViewer;\n  PDFJS.PDFPageView = PDFPageView;\n  PDFJS.PDFLinkService = PDFLinkService;\n  PDFJS.TextLayerBuilder = TextLayerBuilder;\n  PDFJS.DefaultTextLayerFactory = DefaultTextLayerFactory;\n  PDFJS.AnnotationLayerBuilder = AnnotationLayerBuilder;\n  PDFJS.DefaultAnnotationLayerFactory = DefaultAnnotationLayerFactory;\n  PDFJS.PDFHistory = PDFHistory;\n\n  PDFJS.getFileName = getFileName;\n  PDFJS.ProgressBar = ProgressBar;\n}).call((typeof window === 'undefined') ? this : window);\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./shared/pdf_viewer.js\n **/"],"sourceRoot":""}